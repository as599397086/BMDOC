AiSQL提供用于存储 IPv4、IPv6 和 MAC 地址的数据类型，如下表所示。

| 名字     | 存储尺寸  | 描述                   |
| -------- | --------- | ---------------------- |
| cidr     | 7或19字节 | IPv4和IPv6网络         |
| inet     | 7或19字节 | IPv4和IPv6主机以及网络 |
| macaddr  | 6字节     | MAC地址                |
| macaddr8 | 8字节     | MAC地址（EUI-64格式）  |

## **inet**

inet在一个数据域里保存一个 IPv4 或 IPv6 主机地址，以及一个可选的它的子网。 子网由主机地址中表示的网络地址位数表示（“网络掩码”）。 如果网络掩码为 32 并且地址是 IPv4 ，那么该值不表示任何子网，只是一台主机。在 IPv6 中地址长度是 128 位，因此 128 位指定一个唯一的主机地址。 请注意如果你想只接受网络地址，你应该使用cidr类型而不是inet。

该类型的输入格式是地址/y，其中地址是一个 IPv4 或者 IPv6 地址，y是网络掩码的位数。 如果/y部分省略， 则网络掩码对 IPv4 取为 32，对 IPv6 取为 128，所以该值表示只有一台主机。在显示时，如果/y部分指定一个单台主机，它将不会被显示出来。

## **cidr**

cidr类型保存一个 IPv4 或 IPv6 网络地址声明。其输入和输出遵循无类的互联网域路由（Classless Internet Domain Routing）习惯。 声明一个网络的格式是地址/y，其中address是最低位地址，表现为 IPv4 或 IPv6 网络地址而y是网络掩码的位数。 如果省略y， 那么掩码部分用旧的有类的网络编号系统进行计算，否则它将至少大到足以包括写在输入中的所有字节。 声明一个在其指定的掩码右边置了位的网络地址会导致错误。
cidr类型输入示例：

| cidr输入                             | cidr输出                             | abbrev(cidr)                         |
| ------------------------------------ | ------------------------------------ | ------------------------------------ |
| 192.168.100.128/25                   | 192.168.100.128/25                   | 192.168.100.128/25                   |
| 192.168/24                           | 192.168.0.0/24                       | 192.168.0/24                         |
| 192.168/25                           | 192.168.0.0/25                       | 192.168.0.0/25                       |
| 192.168.1                            | 192.168.1.0/24                       | 192.168.1/24                         |
| 192.168                              | 192.168.0.0/24                       | 192.168.0/24                         |
| 128.1                                | 128.1.0.0/16                         | 128.1/16                             |
| 128                                  | 128.0.0.0/16                         | 128.0/16                             |
| 128.1.2                              | 128.1.2.0/24                         | 128.1.2/24                           |
| 10.1.2                               | 10.1.2.0/24                          | 10.1.2/24                            |
| 10.1                                 | 10.1.0.0/16                          | 10.1/16                              |
| 10                                   | 10.0.0.0/8                           | 10/8                                 |
| 10.1.2.3/32                          | 10.1.2.3/32                          | 10.1.2.3/32                          |
| 2001:4f8:3:ba::/64                   | 2001:4f8:3:ba::/64                   | 2001:4f8:3:ba/64                     |
| 2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128 | 2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128 | 2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128 |
| ::ffff:1.2.3.0/120                   | ::ffff:1.2.3.0/120                   | ::ffff:1.2.3/120                     |
| ::ffff:1.2.3.0/128                   | ::ffff:1.2.3.0/128                   | ::ffff:1.2.3.0/128                   |

## **macaddr**

macaddr类型存储 MAC 地址，也就是以太网卡硬件地址 （尽管 MAC 地址还用于其它用途）。可以接受下列格式的输入：

'08:00:2b:01:02:03'
'08-00-2b-01-02-03'
'08002b:010203'
'08002b-010203'
'0800.2b01.0203'
'0800-2b01-0203'
'08002b010203'
这些示例指定的都是同一个地址。对于位a到f，大小写都可以接受。输出总是使用展示的第一种形式。

IEEE Std 802-2001 指定第二种展示的形式（带有连字符）作为MAC地址的标准形式，并且指定第一种形式（带有分号）作为位翻转的记号，因此 08-00-2b-01-02-03 = 01:00:4D:08:04:0C。这种习惯目前已经被广泛地忽略，并且它只与废弃的网络协议（如令牌环）相关。PostgreSQL 没有对位翻转做任何规定，并且所有可接受的格式都使用标准的LSB顺序。
剩下的五种输入格式不属于任何标准。

## **macaddr8**

macaddr8类型以EUI-64格式存储MAC地址，例如以太网卡的硬件地址（尽管MAC地址也被用于其他目的）。这种类型可以接受6字节和8字节长度的MAC地址，并且将它们存储为8字节长度的格式。以6字节格式给出的MAC地址被存储为8字节长度格式的方式是吧第4和第5字节分别设置为FF和FE。 注意IPv6使用一种修改过的EUI-64格式，其中从EUI-48转换过来后的第7位应该被设置为一。函数macaddr8_set7bit被用来做这种修改。 一般而言，任何由16进制数（字节边界上）对构成的输入（可以由':'、'-'或者'.'统一地分隔）都会被接受。16进制数的数量必须是16（8字节）或者12（6字节）。前导和拖尾的空格会被忽略。 下面是可以被接受的输入格式的示例：
'08:00:2b:01:02:03:04:05'
'08-00-2b-01-02-03-04-05'
'08002b:0102030405'
'08002b-0102030405'
'0800.2b01.0203.0405'
'0800-2b01-0203-0405'
'08002b01:02030405'
'08002b0102030405'

这些示例都指定相同的地址。数字a到f的大小写形式都被接受。输出总是以上面显示的第一种形式。
上述的后六种输入格式不属于任何标准。

要把EUI-48格式的传统48位MAC地址转换成修改版EUI-64格式（包括在IPv6地址中作为主机部分），可以使用下面的macaddr8_set7bit：
例如：

```
select macaddr8_set7bit('08:00:2b:01:02:03');
```

返回信息如下：

```
  0a:00:2b:ff:fe:01:02:03
```

## **函数和操作符**

### **操作符**

| 操作符       | 描述                             |
| ------------ | -------------------------------- |
| [<](#_<)     | 是否小于                         |
| [<=](#_<=)   | 是否小于或等于                   |
| [=](#_=_1)   | 是否等于                         |
| [>=](#_>=)   | 是否大于或等于                   |
| [>](#_>)     | 是否大于                         |
| [<>](#_<>)   | 是否不相等                       |
| [<<](#_<<_1) | 子网是否包含在子网中             |
| [<<=](#_<<=) | 子网是否包含或等于子网           |
| [>>](#_>>_1) | 子网是否包含子网                 |
| [>>=](#_>>=) | 子网是否包含或等于子网           |
| [&&](#_&&_1) | 是否一个子网包含或等于另一个子网 |
| [~](#_~)     | 按位取反                         |
| [&](#_&)     | 按位取与                         |
| [            | ](#_                             |
| [+](#_+_2)   | 向地址添加偏移量                 |
| [-](#_-_2)   | 从地址中减去偏移量。             |
| [-](#_-_3)   | 计算两个地址的差值。             |

#### <
目的：是否小于

例如：

```
select inet '192.168.1.5' < inet '192.168.1.6';
```

返回信息如下：

```
t
```

#### <=
目的：是否小于或等于

例如：

```
select inet '192.168.1.5' <= inet '192.168.1.5';
```

返回信息如下：

```
t
```

#### =
目的：是否等于

例如：

```
select inet '192.168.1.5' = inet '192.168.1.5';
```

返回信息如下：

```
t
```

#### >=
目的：是否大于或等于

例如：

```
select inet '192.168.1.5' >= inet '192.168.1.5';
```

返回信息如下：

```
t
```

#### >
目的：是否大于

例如：

```
select inet '192.168.1.5' > inet '192.168.1.4';
```

返回信息如下：

```
t
```

#### <>
目的：是否不相等

例如：

```
select inet '192.168.1.5' <> inet '192.168.1.4';
```

返回信息如下：

```
t
```

#### <<
目的：子网是否包含在子网中

例如：

```
select inet '192.168.1.5' << inet '192.168.1/24';
```

返回信息如下：

```
t
```

#### <<=
目的：子网是否包含或等于子网

例如：

```
select inet '192.168.1/24' <<= inet '192.168.1/24';
```

返回信息如下：

```
t
```

#### >>
目的：子网是否包含子网

例如：

```
select inet '192.168.1/24' >> inet '192.168.1.5';
```

返回信息如下：

```
t
```

#### >>=
目的：子网是否包含或等于子网

例如：

```
select inet '192.168.1/24' >>= inet '192.168.1/24';
```

返回信息如下：

```
t
#### &&
目的：是否一个子网包含或等于另一个子网
```

例如：

```
select inet '192.168.1/24' && inet '192.168.1.80/28';
```

返回信息如下：

```
t
```

#### ~
目的：按位取反 

例如：

```
select ~ inet '192.168.1.6';
```

返回信息如下：

```
63.87.254.249
```

#### &
目的：按位取与 

例如：

```
select inet '192.168.1.6' & inet '0.0.0.255';
```

返回信息如下：

```
0.0.0.6
```

#### |
目的：按位取或 

例如：

```
select inet '192.168.1.6' | inet '0.0.0.255';
```

返回信息如下：

```
192.168.1.255
```

#### +
目的：向地址添加偏移量

例如：

```
select inet '192.168.1.6' + 25;
```

返回信息如下：

```
192.168.1.31
```

#### -
目的：从地址中减去偏移量。

例如：

```
select inet '192.168.1.43' - 36;
```

返回信息如下：

```
192.168.1.7
```

#### -
目的：计算两个地址的差值。

例如：

```
select inet '192.168.1.43' - inet '192.168.1.19';
```

返回信息如下：

```
24
```

### **函数**

| 函数                                                         | 描述                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------ |
| [abbrev(inet)](#_abbrev(inet))                               | 缩写显示格式为文本                                     |
| [abbrev(cidr)](#_abbrev(cidr))                               | 缩写显示格式为文本                                     |
| [broadcast(inet)](#_broadcast(inet))                         | 网络广播地址                                           |
| [family(inet)](#_family(inet))                               | 提取地址家族；4用于IPv4，6用于IPv6                     |
| [host(inet)](#_host(inet))                                   | 将IP地址提取为文本                                     |
| [hostmask(inet)](#_hostmask(inet))                           | 构造网络的主机掩码                                     |
| [masklen(inet)](#_masklen(inet))                             | 提取网络掩码长度                                       |
| [netmask(inet)](#_netmask(inet))                             | 为网络构建网络掩码                                     |
| [network(inet)](#_network(inet))                             | 提取地址的网络部分                                     |
| [set_masklen(inet, int)](#_set_masklen(inet, int))           | 为inet值设置网络掩码长度                               |
| [set_masklen(cidr, int)](#_set_masklen(cidr, int))           | 为cidr值设置网络掩码长度                               |
| [text(inet)](#_text(inet))                                   | 将IP地址和网络掩码长度提取为文本                       |
| [inet_same_family(inet, inet)](#_inet_same_family(inet, inet)) | 这些地址是否来自同一个家族                             |
| [inet_merge(inet, inet)](#_inet_merge(inet, inet))           | 两个给定网络的最小网络                                 |
| [trunc(macaddr)](#_trunc(macaddr))                           | 返回最后3个字节设置为零的MAC地址                       |
| [trunc(macaddr8)](#_trunc(macaddr8))                         | 返回最后5个字节设置为零的MAC地址                       |
| [macaddr8_set7bit(macaddr8)](#_macaddr8_set7bit(macaddr8))   | 将第7位设置为1，也称为修改的EUI-64，以包含在IPv6地址中 |

#### abbrev(inet)
目的：缩写显示格式为文本。

语法：

输入值:    inet 
返回值:    text

例如：

```
select abbrev(inet '10.1.0.0/16');
```

返回信息如下：

```
10.1.0.0/16
```

#### abbrev(cidr)
目的：缩写显示格式为文本。

语法：

输入值:  cidr   
返回值:  text  

例如：

```
select abbrev(cidr '10.1.0.0/16');
```

返回信息如下：

```
10.1/16
```

#### broadcast(inet)
目的：网络广播地址。

语法：

输入值:  inet   
返回值:  inet  

例如：

```
select broadcast('192.168.1.5/24');
```

返回信息如下：

```
 192.168.1.255/24
```

#### family(inet)
目的：提取地址家族；4用于IPv4，6用于IPv6。

语法：

输入值:    inet 
返回值:   integer

例如：

```
select family('::1');
```

返回信息如下：

```
6
```

#### host(inet)
目的：将IP地址提取为文本。

语法：

输入值:    inet 
返回值:    text

例如：

```
select host('192.168.1.5/24');
```

返回信息如下：

```
192.168.1.5
```

#### hostmask(inet)
目的：构造网络的主机掩码。

语法：

输入值:   inet  
返回值:  inet  

例如：

```
select hostmask('192.168.23.20/30');
```

返回信息如下：

```
0.0.0.3
```

#### masklen(inet)
目的：提取网络掩码长度 。

语法：

输入值:   integer  
返回值:   inet 

例如：

```
select masklen('192.168.1.5/24');
```

返回信息如下：

```
24
```

#### netmask(inet)
目的：为网络构建网络掩码。

语法：

输入值:   inet  
返回值:  inet  

例如：

```
select netmask('192.168.1.5/24');
```

返回信息如下：

```
 255.255.255.0
```

#### network(inet)
目的：提取地址的网络部分。

语法：

输入值:   inet  
返回值:   cidr

例如：

```
select network('192.168.1.5/24');
```

返回信息如下：

```
 192.168.1.0/24
```

#### set_masklen(inet, int)
目的：为inet值设置网络掩码长度。

语法：

输入值:    inet
返回值:   inet, integer 

例如：

```
select set_masklen('192.168.1.5/24', 16);
```

返回信息如下：

```
192.168.1.5/16
```

#### set_masklen(cidr, int)
目的：为cidr值设置网络掩码长度。

语法：

输入值:   cidr  
返回值:  cidr, integer

例如：

```
select set_masklen('192.168.1.0/24'::cidr, 16);
```

返回信息如下：

```
192.168.0.0/16
```

#### text(inet)
目的：将IP地址和网络掩码长度提取为文本 。

语法：

输入值:    inet 
返回值:    text

例如：

```
select text(inet '192.168.1.5');
```

返回信息如下：

```
 192.168.1.5/32
```

#### inet_same_family(inet, inet)
目的：这些地址是否来自同一个家族 

语法：

输入值:  inet, inet   
返回值:  boolean  

例如：

```
select inet_same_family('192.168.1.5/24', '::1');
```

返回信息如下：

```
f
```

#### inet_merge(inet, inet)
目的：两个给定网络的最小网络。

语法：

输入值:   inet, inet  
返回值:  cidr  

例如：

```
select inet_merge('192.168.1.5/24', '192.168.2.5/24');
```

返回信息如下：

```
192.168.0.0/22
```

#### trunc(macaddr)
目的：返回最后3个字节设置为零的MAC地址。

语法：

输入值:   macaddr  
返回值:  macaddr

例如：

```
select trunc(macaddr '12:34:56:78:90:ab');
```

返回信息如下：

```
 12:34:56:00:00:00
```

#### trunc(macaddr8)
目的：返回最后5个字节设置为零的MAC地址。

语法：

输入值:   macaddr8
返回值:  macaddr8

例如：

```
select trunc(macaddr8 '12:34:56:78:90:ab:cd:ef');
```

返回信息如下：

```
 12:34:56:00:00:00:00:00
```

 


#### macaddr8_set7bit(macaddr8)
目的：将第7位设置为1，也称为修改的EUI-64，以包含在IPv6地址中。

语法：

输入值:   macaddr8
返回值:  macaddr8

例如：

```
select macaddr8_set7bit(macaddr8 '00:34:56:ab:cd:ef');
```

返回信息如下：

```
02:34:56:ff:fe:ab:cd:ef
```
