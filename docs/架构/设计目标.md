BMDB 的创建是为了实现许多设计目标。

## **一致性**

BMDB 支持分布式事务，同时在面对潜在故障时提供强大的一致性保证。

有关详细信息，请参阅以下内容：

* 与Raft共识实现一致性
* 容错和高可用性
* AiSQL 中的单行线性化事务
* 分布式事务的架构

**CAP定理和裂脑**
从CAP定理来看，AiSQL是一个一致性和分区容忍（CP）数据库，同时实现了非常高的可用性。 AiSQL的架构设计与另一个CP系统Google Cloud Spanner类似。 Spanner的描述也适用于AiSQL。 关键要点是没有一个系统可以提供 100% 的可用性，因此务实的问题是系统是否提供足够高的可用性，使大多数用户不再需要担心中断。 例如，考虑到应用程序的中断来源有很多，如果 AiSQL 对其停机时间的影响微不足道，那么用户不必担心它是正确的。

裂脑是一种当分布式系统发生网络分区时会出现数据和可用性不一致的计算场景。 对于 AiSQL，当发生网络分区时，其余（大多数用于写入确认目的）RAFT 组对等体会选举新的Tile领导者。 AiSQL 实现了领导者租约，这确保了整个分布式系统中（包括发生网络分区时）存在单个 Tile 领导者。 领导者租约的默认值为两秒，并且可以配置为使用不同的值。 这种架构确保了 AiSQL 的分布式数据库不易受到裂脑情况的影响。

**单行线性化**
AiSQL 支持单行线性化写入。 线性化是最强的单行一致性模型之一，意味着每个操作似乎都是原子地发生的，并且以与这些操作的实时顺序一致的某种总线性顺序发生。 换句话说，对于单行操作，预计会出现以下情况：

* 操作可以并发执行，但任何时间点的数据库状态都必须表现为某些完全有序、顺序执行的操作的结果。
* 如果操作 A 在操作 B 开始之前完成，则逻辑上 B 应在 A 之后生效。

**多行 ACID 事务**
AiSQL 支持具有三种隔离级别的多行事务：可串行化、快照（也称为可重复读）和读提交隔离。

BSQL API 分别使用 PostgreSQL 隔离级别语法 SERIALIZABLE、REPEATABLE READ 和 READ COMMITTED 支持可串行化、快照（默认）和读提交隔离。 有关更多详细信息，请参阅 BSQL 与 PostgreSQL 隔离级别。
BCQL API 仅支持使用 BEGIN TRANSACTION 语法的快照隔离（默认）。

**BSQL 与 PostgreSQL 隔离级别**
READ COMMITTED 是 PostgreSQL 和 BSQL 中的默认隔离级别。 如果 bm_enable_read_commissed_isolation=true，则 READ COMMITTED 将映射到 AiSQL 事务层的 Read Commissed（即，语句会看到在开始之前已提交的所有行）。 但是，默认情况下 bm_enable_read_commissed_isolation=false，在这种情况下，AiSQL 事务层的读已提交映射到快照隔离，从而使快照隔离在 BSQL 中默认。

请注意，AiSQL 中的读提交支持当前处于技术预览版中。

请参阅隔离级别表，了解 BSQL 隔离级别如何映射到 PostgreSQL 定义的级别。

## **查询API**

AiSQL 支持的两个 API 是 BSQL 和 BCQL。 它们与现有 API 兼容并扩展其功能。

**BSQL**
BSQL 是一个完全关系型 SQL API，与 PostgreSQL 中的 SQL 语言兼容。 它最适合需要水平写入可扩展性和全局数据分布的 RDBMS 工作负载，同时还使用关系建模功能，例如联接、分布式事务和引用完整性（例如外键）。 请注意，BSQL 重用了 PostgreSQL 开源项目的本机查询层。

此外：

* BSQL 的新更改不会破坏现有的 PostgreSQL 功能。
* BSQL 的设计目标是随着时间的推移迁移到较新的 PostgreSQL 版本。 这意味着新功能在 AiSQL 代码库中以模块化方式实现，以实现与新 PostgreSQL 功能的快速集成作为一个持续的过程。
* BSQL 支持广泛的 SQL 功能，例如：
  所有数据类型
  内置函数和表达式
  连接（内连接、外连接、完全外连接、交叉连接、自然连接）
  约束（主键、外键、唯一、不为空、检查）
  二级索引（包括多列、覆盖）
  分布式事务（可串行化、快照和读提交隔离）
  视图
  存储过程
  触发器


**BCQL**
BCQL 是一种半关系 SQL API，最适合需要大规模写入可扩展性和快速查询的互联网规模 OLTP 和 HTAP 应用程序。 BCQL支持分布式事务、强一致性二级索引和原生JSON列类型。 BCQL 源于 Cassandra 查询语言。

有关更多信息，请参阅查询层概述。

## **性能**

AiSQL 采用 C++ 编写，以确保高性能和使用大内存堆 (RAM) 作为内部数据库缓存的能力，主要针对在 SSD 和非易失性内存 Express (NVMe) 驱动器上运行进行了优化。 AiSQL 的设计考虑了以下工作负载特征：

* 高写入吞吐量
* 高客户端并发
* 高数据密度（每个节点的总数据集大小）
* 能够处理不断增长的事件数据用例

有关更多信息，请参阅 AiSQL 中的高性能。

## **地理分布式部署**

AiSQL 适用于universe节点跨越以下方面的部署：

* 单可用区
* 多可用区
* 地理上重复的多个区域
* 多个云（公共云和私有云）

为了提供功能，必须满足许多要求。 例如，跨多种语言的客户端驱动程序满足以下条件：
集群感知，能够无缝处理节点故障。
拓扑感知，能够无缝路由流量。


## **云原生架构**

AiSQL 是一个云原生数据库，在设计时考虑了许多云原生原则。

**在商用硬件上运行**

* 能够在任何公共云或本地数据中心上运行。 这包括裸机、虚拟机和容器上的商用硬件。
* 没有硬的外部依赖性。 例如，AiSQL 不依赖于原子钟，但可以使用原子钟（如果可用）。

**Kubernetes-ready**
AiSQL 作为有状态应用程序在 Kubernetes 和其他容器化环境中本地运行。


也可以看看：
AiSQL 架构层概述
文档数据库架构
CoreDB 中的事务
查询层设计
核心功能
