
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="贝格迈思数据库使用手册">
      
      
      
      
        <link rel="prev" href="%E9%AB%98%E6%89%A9%E5%B1%95%E6%80%A7.html">
      
      
        <link rel="next" href="%E5%8D%87%E7%BA%A7%E9%83%A8%E7%BD%B2.html">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>多区域部署 - 手册</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mo" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#3" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="页眉"
  >

    <!-- Link to home -->
    <a
      href="../index.html"
      title="手册"
      class="md-header__button md-logo"
      aria-label="手册"
      data-md-component="logo"
    >
      
  <img src="../assets/new-logo.png" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            手册
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              多区域部署
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    
      
    

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="手册" class="md-nav__button md-logo" aria-label="手册" data-md-component="logo">
      
  <img src="../assets/new-logo.png" alt="logo">

    </a>
    手册
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AiSQL简介
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    快速上手
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/JAVA.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    应用开发
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E9%83%A8%E7%BD%B2%E9%9B%86%E7%BE%A4/%E8%BD%AF%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83%E9%9C%80%E6%B1%82.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    部署集群
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据迁移
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    管理数据库
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            管理数据库
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    集群管理与监控
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%9B%B4%E6%94%B9%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    更改集群配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E8%AF%8A%E6%96%AD%E6%8A%A5%E5%91%8A.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    诊断报告
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="%E5%AE%89%E5%85%A8%E6%9D%83%E9%99%90/%E5%AE%89%E5%85%A8%E6%A3%80%E6%9F%A5%E6%B8%85%E5%8D%95.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    安全权限
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%98%E5%8E%9F.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    备份修复
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    监控指标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    问题排查
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/%E5%BC%95%E8%A8%80.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    性能调优
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E9%AB%98%E5%8F%AF%E7%94%A8.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高可用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E9%AB%98%E6%89%A9%E5%B1%95%E6%80%A7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高扩展性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    多区域部署
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="%E5%A4%9A%E5%8C%BA%E5%9F%9F%E9%83%A8%E7%BD%B2.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    多区域部署
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3区域部署（节点之间数据同步复制）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    行级数据地理分布
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xdcr-2" class="md-nav__link">
    xDCR (2个区域异步复制)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    读副本
  </a>
  
    <nav class="md-nav" aria-label="读副本">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bsql" class="md-nav__link">
    BSQL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../管理数据库/变更数据获取.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    变更数据获取
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E5%8D%87%E7%BA%A7%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    升级部署
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E5%90%91%E9%87%8F%E7%89%B9%E6%80%A7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    向量特性
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../AI%E7%89%B9%E6%80%A7/%E6%A6%82%E8%BF%B0.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    AI特性
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    参考
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3区域部署（节点之间数据同步复制）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    行级数据地理分布
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xdcr-2" class="md-nav__link">
    xDCR (2个区域异步复制)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    读副本
  </a>
  
    <nav class="md-nav" aria-label="读副本">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bsql" class="md-nav__link">
    BSQL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/as599397086/BMDOC/edit/master/docs/管理数据库/多区域部署.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/as599397086/BMDOC/raw/master/docs/管理数据库/多区域部署.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>多区域部署</h1>

<p>BMDB 支持一组丰富的多区域部署拓扑。 本节介绍其中一些部署。 主要部署包括：</p>
<ul>
<li>跨区域同步复制：默认</li>
<li>地理分区：根据策略将数据固定到不同的地理位置</li>
<li>xDCR：用于单向和双向异步复制</li>
<li>读副本：使用异步复制为不同区域提供读取服务</li>
</ul>
<p>下表总结了 BMDB 中的这些不同的多区域部署及其一些关键特征。</p>
<table>
<thead>
<tr>
<th></th>
<th>默认</th>
<th>地理分区</th>
<th>xDCR</th>
<th>读取副本</th>
</tr>
</thead>
<tbody>
<tr>
<td>复制方式</td>
<td>同步</td>
<td>同步</td>
<td>异步（单向/双向）</td>
<td>异步（单向）</td>
</tr>
<tr>
<td>数据驻留</td>
<td>所有数据跨区域复制</td>
<td>数据跨区域分区。分区在区域内复制。</td>
<td>所有数据都在区域内复制，配置每表跨区域复制。</td>
<td>所有数据都复制在主区域中。集群范围内的异步复制到只读副本</td>
</tr>
<tr>
<td>一致性</td>
<td>事务一致性</td>
<td>事务一致性</td>
<td>时间线一致性</td>
<td>时间线一致性</td>
</tr>
<tr>
<td>写延迟</td>
<td>高延迟</td>
<td>低延迟</td>
<td>低延迟</td>
<td>N/A</td>
</tr>
<tr>
<td>读延迟</td>
<td>高延迟</td>
<td>低延迟（当从附近的地理位置查询时）</td>
<td>低延迟</td>
<td>低延迟</td>
</tr>
<tr>
<td>Schema changes</td>
<td>透明管理</td>
<td>透明管理</td>
<td>手动操作</td>
<td>透明管理</td>
</tr>
<tr>
<td>RPO</td>
<td>无数据丢失</td>
<td>无数据丢失（可能部分不可用）</td>
<td>部分数据丢失</td>
<td>无数据丢失</td>
</tr>
</tbody>
</table>
<h2 id="3"><strong>3区域部署（节点之间数据同步复制）</strong><a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>为了在整个云区域发生故障时提供保护，您可以通过同步复制的多区域universe跨多个区域部署 BMDB。 在同步的多区域 Universe 中，跨三个区域至少复制三个节点，复制因子 (RF) 为 3。如果某个区域发生故障，Universe 会继续为来自其余区域的数据请求提供服务。 BMDB 自动执行到其他两个区域中的节点的故障转移，并且被故障转移的Tile均匀分布在其余两个区域中。</p>
<p>这种部署具有以下优点：</p>
<ul>
<li>弹性 - 将universe节点放在不同的区域可以提供更高程度的故障独立性。</li>
<li>一致性 - 所有写入都会同步复制。 事务是全球一致的。</li>
</ul>
<h2 id="_1"><strong>行级数据地理分布</strong><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>将数据固定到区域以实现合规性并降低延迟</p>
<p>行级地理分区允许对用户表中的数据（每行级）固定到地理位置进行细粒度控制，从而允许在表行级管理数据驻留。 需要低延迟多区域部署、事务一致性语义和跨区域透明模式更改传播的用例将受益于此功能。</p>
<p>地理分区允许您将数据移至更靠近用户的位置：</p>
<ul>
<li>实现更低的延迟和更高的性能</li>
<li>满足数据驻留要求，以遵守 GDPR 等法规</li>
</ul>
<p>数据的地理分区可以对表数据在不同地理位置的放置进行细粒度的行级控制。 这是通过两个步骤完成的：</p>
<ul>
<li>将表划分为用户定义的表分区。</li>
<li>通过为每个分区配置元数据，将这些分区固定到所需的地理位置。</li>
</ul>
<p>要创建用户定义的表分区，请将表的一列指定为将用于对数据进行地理分区的分区列。 给定行的该列的值用于确定该行所属的表分区。</p>
<p>**第二步**涉及使用表空间在各个地理位置创建分区。 请注意，每个分区中的数据可以配置为跨云提供商区域中的多个可用区（zone）、跨多个附近区域（region）或数据中心进行复制。</p>
<p>通过添加新的表分区并将其配置为将数据驻留在所需的地理位置，可以动态引入全新的地理分区。 通过删除必要的分区，可以有效地清除一个或多个现有地理位置中的数据。 传统 RDBMS 的用户会认为这种方案接近用户定义的基于列表的表分区，并且能够控制每个分区的地理位置。</p>
<p>在此部署中，用户可以低延迟地访问其数据，因为数据驻留在地理位置较近的服务器上，并且查询不需要访问遥远地理位置的数据。</p>
<p>本教程在下一节中描述的示例场景的上下文中解释了此功能。</p>
<p>示例场景
假设一家虚构的大型银行 Bigmath Bank 想要为许多国家的用户提供在线银行服务，处理他们的存款、取款和转账。</p>
<p>构建这样的服务需要以下属性：</p>
<ul>
<li>具有高可用性的事务语义：数据的一致性在银行应用程序中至关重要，因此数据库应该符合 ACID。 此外，用户希望服务始终可用，这使得高可用性和故障恢复能力成为关键要求。</li>
<li>高性能：在线交易需要低延迟处理，以确保良好的最终用户体验。 这要求特定用户的数据位于附近的地理区域。 将所有数据放在 RDBMS 中的单个位置意味着远离该位置的用户的请求将具有非常高的延迟，从而导致糟糕的用户体验。</li>
<li>合规性的数据驻留要求：许多国家/地区都有关于可以存储其居民个人数据的地理区域的规定，并且作为个人数据的银行交易必须遵守这些要求。 例如，GDPR 有一项数据驻留规定，实际上要求欧盟境内个人的个人数据存储在欧盟。 同样，印度储备银行（简称 RBI）发布了一项要求，强制要求所有银行、中介机构和其他第三方在印度存储与支付数据有关的所有信息 - 尽管在国际交易中， 交易国外部分的数据可以存储在国外位置。</li>
</ul>
<p>注：虽然此场景具有法规遵从性要求，即数据需要驻留在某些地理位置，但完全相同的技术也适用于将数据移近用户以实现低延迟和高性能的目标。 因此，上面列出了高性能作为要求。</p>
<p><strong>1.创建表空间</strong>
首先，为您希望将数据分区到的每个地理区域创建表空间：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>CREATE TABLESPACE eu_central_1_tablespace WITH (
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>  replica_placement=&#39;{&quot;num_replicas&quot;: 3, &quot;placement_blocks&quot;:
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>  [{&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;eu-central-1&quot;,&quot;zone&quot;:&quot;eu-central-1a&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;eu-central-1&quot;,&quot;zone&quot;:&quot;eu-central-1b&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;eu-central-1&quot;,&quot;zone&quot;:&quot;eu-central-1c&quot;,&quot;min_num_replicas&quot;:1}]}&#39;
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a>);
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a>CREATE TABLESPACE us_west_2_tablespace WITH (
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a>  replica_placement=&#39;{&quot;num_replicas&quot;: 3, &quot;placement_blocks&quot;:
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a>  [{&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;us-west-2&quot;,&quot;zone&quot;:&quot;us-west-2a&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;us-west-2&quot;,&quot;zone&quot;:&quot;us-west-2b&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;us-west-2&quot;,&quot;zone&quot;:&quot;us-west-2c&quot;,&quot;min_num_replicas&quot;:1}]}&#39;
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a>);
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a>CREATE TABLESPACE ap_south_1_tablespace WITH (
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a>  replica_placement=&#39;{&quot;num_replicas&quot;: 3, &quot;placement_blocks&quot;:
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a>  [{&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;ap-south-1&quot;,&quot;zone&quot;:&quot;ap-south-1a&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;ap-south-1&quot;,&quot;zone&quot;:&quot;ap-south-1b&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;ap-south-1&quot;,&quot;zone&quot;:&quot;ap-south-1c&quot;,&quot;min_num_replicas&quot;:1}]}&#39;
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a>);
</span></code></pre></div></td></tr></table></div>
<p>要查看您的表空间，您可以输入以下命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a>SELECT * FROM pg_tablespace;
</span></code></pre></div></td></tr></table></div>
<p><strong>2.创建带分区的表</strong>
接下来，创建包含 geo_partition 列的父表，该列用于为要将数据分区到的每个地理区域创建基于列表的分区，如下图所示：</p>
<p><img alt="" src="../assets/chapter6/78.png" /></p>
<p>（1）创建父表</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span>
<span class="normal"><a href="#__codelineno-2-6">6</a></span>
<span class="normal"><a href="#__codelineno-2-7">7</a></span>
<span class="normal"><a href="#__codelineno-2-8">8</a></span>
<span class="normal"><a href="#__codelineno-2-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>CREATE TABLE bank_transactions (
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>    user_id   INTEGER NOT NULL,
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>    account_id INTEGER NOT NULL,
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>    geo_partition VARCHAR,
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>    account_type VARCHAR NOT NULL,
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>    amount NUMERIC NOT NULL,
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a>    txn_type VARCHAR NOT NULL,
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>    created_at TIMESTAMP DEFAULT NOW()
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>) PARTITION BY LIST (geo_partition);
</span></code></pre></div></td></tr></table></div>
<p>注：您可以将 geo_partition 设置为 DEFAULT bm_server_region() 以基于区域进行分区。 这样，对本地分区表的插入不必指定 geo_partition 列值。</p>
<p>（2）接下来，在父表下为每个所需的地理位置创建一个分区，并将每个分区分配给适用的表空间。 在这里，您创建三个表分区：一个用于欧盟区域，称为bank_transactions_eu，另一个用于印度区域，称为bank_transactions_india，第三个分区用于美国区域，称为bank_transactions_us。 为每个分区创建任何所需的索引，确保将每个索引与分区表的表空间关联。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>CREATE TABLE bank_transactions_eu
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>    PARTITION OF bank_transactions
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a>      (user_id, account_id, geo_partition, account_type,
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a>      amount, txn_type, created_at,
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a>      PRIMARY KEY (user_id HASH, account_id, geo_partition))
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a>    FOR VALUES IN (&#39;EU&#39;) TABLESPACE eu_central_1_tablespace;
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a>CREATE INDEX ON bank_transactions_eu(account_id) TABLESPACE eu_central_1_tablespace;
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a>CREATE TABLE bank_transactions_india
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a>    PARTITION OF bank_transactions
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a>      (user_id, account_id, geo_partition, account_type,
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a>      amount, txn_type, created_at,
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a>      PRIMARY KEY (user_id HASH, account_id, geo_partition))
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a>    FOR VALUES IN (&#39;India&#39;) TABLESPACE ap_south_1_tablespace;
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a>CREATE INDEX ON bank_transactions_india(account_id) TABLESPACE ap_south_1_tablespace;
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19"></a>CREATE TABLE bank_transactions_us
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20"></a>    PARTITION OF bank_transactions
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21"></a>      (user_id, account_id, geo_partition, account_type,
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22"></a>      amount, txn_type, created_at,
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23"></a>      PRIMARY KEY (user_id HASH, account_id, geo_partition))
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24"></a>    FOR VALUES IN (&#39;US&#39;) TABLESPACE us_west_2_tablespace;
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25"></a>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26"></a>CREATE INDEX ON bank_transactions_us(account_id) TABLESPACE us_west_2_tablespace;
</span></code></pre></div></td></tr></table></div>
<p>（3）使用 \d 元命令查看迄今为止创建的表和分区。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span>
<span class="normal"><a href="#__codelineno-4-8">8</a></span>
<span class="normal"><a href="#__codelineno-4-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>bigmath=# \d
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>                List of relations
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a> Schema |         Name          | Type |  Owner
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>-----------+-----------------------------------+-------+----------
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a> public  | bank_transactions         | table | bigmath
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a> public  | bank_transactions_eu      | table | bigmath
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a> public  | bank_transactions_india    | table | bigmath
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a> public  | bank_transactions_us      | table | bigmath
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>(4 rows)
</span></code></pre></div></td></tr></table></div>
<p>现将数据整理如下：</p>
<p><img alt="" src="../assets/chapter6/79.png" /></p>
<p>区域-本地事务表
当您使用具有放置集的表空间创建表时，BMDB 会自动在表空间下创建一个事务表（如果尚不存在），其名称类似于 system.transactions_90141438-f42c-4a39-8a12-4072c1216d46。</p>
<p>3.固定特定于地理位置的用户分区
现在，设置应该能够根据 geo_partition 列中设置的值自动将行固定到适当的区域。 如下图所示：</p>
<p><img alt="" src="../assets/chapter6/80.png" /></p>
<p>您可以通过插入几行数据并验证它们是否写入正确的分区来测试此区域固定。</p>
<p>扩展输出显示
示例输出包括扩展的自动模式输出格式，以提高可读性。 您可以使用以下语句启用此模式：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>bigmath=# \x auto
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>Expanded display is used automatically.
</span></code></pre></div></td></tr></table></div>
<p>（1）在下面的表中插入一行，其中 geo_partition 列值设置为 EU。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a>INSERT INTO bank_transactions
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>    VALUES (100, 10001, &#39;EU&#39;, &#39;checking&#39;, 120.50, &#39;debit&#39;);
</span></code></pre></div></td></tr></table></div>
<p>（2）验证该行是否存在于bank_transactions 表中。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a>bigmath=# select * from bank_transactions;
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>user_id       | 100
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>account_id    | 10001
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>geo_partition | EU
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a>account_type  | checking
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a>amount        | 120.5
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a>txn_type      | debit
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a>created_at    | 2020-11-07 21:28:11.056236
</span></code></pre></div></td></tr></table></div>
<p>此外，该行必须仅存在于bank_transactions_eu分区中，可以通过直接针对该分区运行select语句来轻松验证这一点。 其他分区不应包含任何行。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>bigmath=# select * from bank_transactions_eu;
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>user_id       | 100
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>account_id    | 10001
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>geo_partition | EU
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>account_type  | checking
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>amount        | 120.5
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a>txn_type      | debit
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a>created_at    | 2020-11-07 21:28:11.056236
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a>bigmath=# select count(*) from bank_transactions_india;
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a> count
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a>-------
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a>     0
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a>bigmath=# select count(*) from bank_transactions_us;
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a> count
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a>-------
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a>     0
</span></code></pre></div></td></tr></table></div>
<p>将数据插入其他分区。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>INSERT INTO bank_transactions
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>    VALUES (200, 20001, &#39;India&#39;, &#39;savings&#39;, 1000, &#39;credit&#39;);
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a>INSERT INTO bank_transactions
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a>    VALUES (300, 30001, &#39;US&#39;, &#39;checking&#39;, 105.25, &#39;debit&#39;);
</span></code></pre></div></td></tr></table></div>
<p>这些可以验证如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>bigmath=# select * from bank_transactions_india;
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a>user_id       | 200
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a>account_id    | 20001
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a>geo_partition | India
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a>account_type  | savings
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a>amount        | 1000
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a>txn_type      | credit
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a>created_at    | 2020-11-07 21:45:26.011636
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a>bigmath=# select * from bank_transactions_us;
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a>user_id       | 300
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a>account_id    | 30001
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a>geo_partition | US
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a>account_type  | checking
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a>amount        | 105.25
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17"></a>txn_type      | debit
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18"></a>created_at    | 2020-11-07 21:45:26.067444
</span></code></pre></div></td></tr></table></div>
<p><strong>4.查询本地分区</strong>
可以通过在分区键上使用 WHERE 子句来完成对特定分区的查询。 例如，如果客户端位于美国，则可以通过运行以下查询来查询本地分区：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span>
<span class="normal"><a href="#__codelineno-11-7">7</a></span>
<span class="normal"><a href="#__codelineno-11-8">8</a></span>
<span class="normal"><a href="#__codelineno-11-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a>bigmath=# select * from bank_transactions where geo_partition=&#39;US&#39;;
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a>user_id       | 300
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a>account_id    | 30001
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a>geo_partition | US
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a>account_type  | checking
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7"></a>amount        | 105.25
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8"></a>txn_type      | debit
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9"></a>created_at    | 2020-11-07 21:45:26.067444
</span></code></pre></div></td></tr></table></div>
<p>但是，如果需要查询本地分区而不指定分区列，可以使用函数 bm_is_local_table。 要使用 bm_is_local_table 实现与上面相同的查询，您可以执行以下操作：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span>
<span class="normal"><a href="#__codelineno-12-7">7</a></span>
<span class="normal"><a href="#__codelineno-12-8">8</a></span>
<span class="normal"><a href="#__codelineno-12-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>bigmath=# select * from bank_transactions where bm_is_local_table(tableoid);
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a>user_id       | 300
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>account_id    | 30001
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>geo_partition | US
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a>account_type  | checking
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a>amount        | 105.25
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a>txn_type      | debit
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a>created_at    | 2020-11-07 21:45:26.067444
</span></code></pre></div></td></tr></table></div>
<p>5.跨地理位置旅行的用户
更有趣的是，用户 100 的第一笔银行交易是在欧盟地区进行的，他前往印度和美国，并进行了另外两笔银行交易。 这可以通过使用以下语句来模拟：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a>INSERT INTO bank_transactions
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>    VALUES (100, 10001, &#39;India&#39;, &#39;savings&#39;, 2000, &#39;credit&#39;);
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a>INSERT INTO bank_transactions
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a>    VALUES (100, 10001, &#39;US&#39;, &#39;checking&#39;, 105, &#39;debit&#39;);
</span></code></pre></div></td></tr></table></div>
<p>现在，每笔银行交易都将被固定到适当的地理位置。 这可以如下验证。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>bigmath=# select * from bank_transactions_india where user_id=100;
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>user_id       | 100
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>account_id    | 10001
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a>geo_partition | India
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a>account_type  | savings
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a>amount        | 2000
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a>txn_type      | credit
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>created_at    | 2020-11-07 21:56:26.760253
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>bigmath=# select * from bank_transactions_us where user_id=100;
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>user_id       | 100
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a>account_id    | 10001
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a>geo_partition | US
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a>account_type  | checking
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a>amount        | 105
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a>txn_type      | debit
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a>created_at    | 2020-11-07 21:56:26.794173
</span></code></pre></div></td></tr></table></div>
<p>可以使用以下 SQL 语句检索用户进行的所有银行交易。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span>
<span class="normal"><a href="#__codelineno-15-22">22</a></span>
<span class="normal"><a href="#__codelineno-15-23">23</a></span>
<span class="normal"><a href="#__codelineno-15-24">24</a></span>
<span class="normal"><a href="#__codelineno-15-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>bigmath=# select * from bank_transactions where user_id=100 order by created_at desc;
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>-[ RECORD 1 ]-+---------------------------
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a>user_id       | 100
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4"></a>account_id    | 10001
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5"></a>geo_partition | US
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6"></a>account_type  | checking
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7"></a>amount        | 105
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8"></a>txn_type      | debit
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9"></a>created_at    | 2020-11-07 21:56:26.794173
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10"></a>-[ RECORD 2 ]-+---------------------------
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11"></a>user_id       | 100
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12"></a>account_id    | 10001
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13"></a>geo_partition | India
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14"></a>account_type  | savings
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15"></a>amount        | 2000
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16"></a>txn_type      | credit
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17"></a>created_at    | 2020-11-07 21:56:26.760253
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18"></a>-[ RECORD 3 ]-+---------------------------
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19"></a>user_id       | 100
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20"></a>account_id    | 10001
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21"></a>geo_partition | EU
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22"></a>account_type  | checking
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23"></a>amount        | 120.5
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24"></a>txn_type      | debit
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25"></a>created_at    | 2020-11-07 21:28:11.056236
</span></code></pre></div></td></tr></table></div>
<p><strong>6.添加新的地理位置</strong>
假设一段时间后，Bigmath Bank 在全球范围内获得了大量客户，并希望向也有数据居住法的巴西居民提供服务。 使用行级地理分区，您可以通过添加新分区并将其固定到 AWS 南美洲（圣保罗）区域 sa-east-1 来实现此目的。</p>
<p>首先，创建表空间：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span>
<span class="normal"><a href="#__codelineno-16-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>CREATE TABLESPACE sa_east_1_tablespace WITH (
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>    replica_placement=&#39;{&quot;num_replicas&quot;: 3, &quot;placement_blocks&quot;:
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a>      [{&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;sa-east-1&quot;,&quot;zone&quot;:&quot;sa-east-1a&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a>      {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;sa-east-1&quot;,&quot;zone&quot;:&quot;sa-east-1b&quot;,&quot;min_num_replicas&quot;:1},
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a>      {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;sa-east-1&quot;,&quot;zone&quot;:&quot;sa-east-1c&quot;,&quot;min_num_replicas&quot;:1}]}&#39;
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a>    );
</span></code></pre></div></td></tr></table></div>
<p>然后，为巴西创建分区：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span>
<span class="normal"><a href="#__codelineno-17-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>CREATE TABLE bank_transactions_brazil
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a>    PARTITION OF bank_transactions
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a>      (user_id, account_id, geo_partition, account_type,
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a>       amount, txn_type, created_at,
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a>       PRIMARY KEY (user_id HASH, account_id, geo_partition))
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a>    FOR VALUES IN (&#39;Brazil&#39;) TABLESPACE sa_east_1_tablespace;
</span></code></pre></div></td></tr></table></div>
<p>至此，新区域已准备好存储巴西居民的银行交易。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a>INSERT INTO bank_transactions
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a>    VALUES (400, 40001, &#39;Brazil&#39;, &#39;savings&#39;, 1000, &#39;credit&#39;);
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a>select * from bank_transactions_brazil;
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a>-[ RECORD 1 ]-+-------------------------
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a>user_id       | 400
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a>account_id    | 40001
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7"></a>geo_partition | Brazil
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8"></a>account_type  | savings
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9"></a>amount        | 1000
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10"></a>txn_type      | credit
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11"></a>created_at    | 2020-11-07 22:09:04.8537
</span></code></pre></div></td></tr></table></div>
<p><strong>7.区域中断期间的容错</strong>
到目前为止，您已经设置了 3 个数据副本的复制，这有助于容忍单个节点或区域的丢失。 但是，区域中断会导致不可用，因为所有节点都在一个区域内。 将每个副本放置在不同的区域有助于解决此问题。</p>
<p>重新创建之前的 us_west_2_表空间，并在 us-west2、us-west1 和 us-east1 中各放置一个副本。 然后使用leader_preference继续将所有领导者放置在us-west-2中，以便他们保持靠近客户端并提供最佳性能。 （您可以在领导者偏好中找到更多信息）</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span>
<span class="normal"><a href="#__codelineno-19-5">5</a></span>
<span class="normal"><a href="#__codelineno-19-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a>CREATE TABLESPACE us_west_2_tablespace WITH (
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>  replica_placement=&#39;{&quot;num_replicas&quot;: 3, &quot;placement_blocks&quot;:
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a>  [{&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;us-west-2&quot;,&quot;zone&quot;:&quot;us-west-2a&quot;,&quot;min_num_replicas&quot;:1,&quot;leader_preference&quot;:1},
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;us-west-1&quot;,&quot;zone&quot;:&quot;us-west-1a&quot;,&quot;min_num_replicas&quot;:1,&quot;leader_preference&quot;:2},
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>  {&quot;cloud&quot;:&quot;aws&quot;,&quot;region&quot;:&quot;us-east-1&quot;,&quot;zone&quot;:&quot;us-east-1a&quot;,&quot;min_num_replicas&quot;:1}]}&#39;
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a>);
</span></code></pre></div></td></tr></table></div>
<h2 id="xdcr-2"><strong>xDCR (2个区域异步复制)</strong><a class="headerlink" href="#xdcr-2" title="Permanent link">&para;</a></h2>
<p>单向（主从）和双向（多主）复制
默认情况下，BMDB 提供跨地理分布式数据中心的同步复制和强一致性。 然而，许多用例不需要同步复制，也不需要证明与管理三个或更多数据中心相关的额外复杂性和运营成本是合理的。 跨集群 (xDCR) 部署提供跨两个数据中心或云区域的异步复制。</p>
<p>本练习使用两个本地 BMDB 集群模拟地理分布式双数据中心 (2DC) 部署，一个代表“Data Center - East”，另一个代表“Data Center - West”。</p>
<p>有关详细信息，请参阅以下内容：
xDCR复制架构
xDCR 复制命令
变更数据捕获 (CDC)</p>
<p><strong>1.创建两个数据中心</strong>
创建两个数据中心如下：
（1）通过从 BMDB 主目录运行以下命令来创建并启动模拟“Data Center - East”的本地集群：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a>./bin/bm-ctl start \
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a>                --advertise_address=127.0.0.1 \
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a>                --base_dir=/tmp/bmd1
</span></code></pre></div></td></tr></table></div>
<p>这将使用 IP 地址 127.0.0.1 启动单节点本地集群，并创建 /tmp/bmd1 作为基目录。</p>
<p>（2）如果您在 macOS 上运行并且尚未创建任何loopback地址，请按如下方式配置一个：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a>sudo ifconfig lo0 alias 127.0.0.2
</span></code></pre></div></td></tr></table></div>
<p>（3）通过运行以下命令创建并启动模拟“Data Center - West”的第二个本地集群：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a>./bin/bm-ctl start \
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a>                --advertise_address=127.0.0.2 \
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a>                --base_dir=/tmp/bmd2
</span></code></pre></div></td></tr></table></div>
<p>这将使用 IP 地址 127.0.0.2 启动单节点集群，并创建 /tmp/bmd2 作为基目录。</p>
<p><strong>2.创建表</strong>
在默认的 bigmath 数据库中，您可以在“Data Center - East”集群上创建表 users：
（1）通过指定主机IP地址127.0.0.1打开sqlsh，如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a>./bin/sqlsh -h 127.0.0.1
</span></code></pre></div></td></tr></table></div>
<p>（2）创建表users，如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a>CREATE TABLE users (
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a>    email varchar PRIMARY KEY,
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a>    username varchar
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a>    );
</span></code></pre></div></td></tr></table></div>
<p>在第二个集群上创建一个相同的表：
（1）打开“Data Center - West”的sqlsh，指定主机IP地址127.0.0.2，如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a>./bin/sqlsh -h 127.0.0.2
</span></code></pre></div></td></tr></table></div>
<p>（2）创建表users，如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a>CREATE TABLE users (
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a>    email varchar PRIMARY KEY,
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>    username varchar
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a>    );
</span></code></pre></div></td></tr></table></div>
<p>集群上有两个相同的表允许您跨两个数据中心设置 xDCR 复制。</p>
<p><strong>3.配置单向复制</strong>
要将“Data Center - West”配置为“Data Center - East”集群中数据更改的目标，您需要使用 bm-admin 实用程序 setup_universe_replication 命令。 语法如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>bm-admin -master_addresses &lt;target-master-addresses&gt; \
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a>    setup_universe_replication &lt;source-universe_uuid&gt; \
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a>    &lt;source_master_addresses&gt; &lt;source-table-ids&gt;
</span></code></pre></div></td></tr></table></div>
<ul>
<li>target-master-addresses：目标 MServer 服务器的逗号分隔列表。 对于此模拟，您有一台用于目标的 MServer 服务器，127.0.0.2:11000。</li>
<li>source-universe-uuid：源集群的唯一标识符。 在源MServer UI（<a href="http://127.0.0.1:10000">http://127.0.0.1:10000</a>）中查找UUID。</li>
<li>source-master-addresses：以逗号分隔的源 MServer 服务器列表。 对于此模拟，您有一台 MServer 服务器作为源，127.0.0.1:11000。</li>
<li>source-table-ids：以逗号分隔的表 UUID 列表。 对于此模拟，用户表； 在MServer UI（<a href="http://127.0.0.1:10000/tables">http://127.0.0.1:10000/tables</a>）中查找UUID。</li>
</ul>
<p>根据从 MServer UI 获取的实际值，从 BMDB 主目录运行 bm-admin setup_universe_replication 命令，类似于以下示例中所示的命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a>./bin/bm-admin -master_addresses 127.0.0.2:11000 \
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>    setup_universe_replication 7acd6399-657d-42dc-a90a-646869898c2d \
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a>    127.0.0.1:11000 000033e8000030008000000000004000
</span></code></pre></div></td></tr></table></div>
<p>target-master-addresses: 127.0.0.2:11000
source-universe-uuid: 7acd6399-657d-42dc-a90a-646869898c2d
source-master-addresses: 127.0.0.1:11000
source-table-ids: 000033e8000030008000000000004000</p>
<p>您应该看到以下消息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a>Replication setup successfully
</span></code></pre></div></td></tr></table></div>
<p><strong>4.验证单向复制</strong>
要检查复制，您可以将数据添加到一个集群上的用户表中，并查看数据出现在第二个集群上的用户表中。</p>
<p>（1）使用以下命令将数据添加到“Data Center - East”集群，确保您指向新的源主机：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a>./bin/sqlsh -h 127.0.0.1
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a>INSERT INTO users(email, username) VALUES (&#39;hector@example.com&#39;, &#39;hector&#39;), (&#39;steve@example.com&#39;, &#39;steve&#39;);
</span></code></pre></div></td></tr></table></div>
<p>（2）在目标“Data Center - West”集群上，执行以下命令，可以看到集群间数据已复制：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a>./bin/sqlsh -h 127.0.0.2
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a>SELECT * FROM users;
</span></code></pre></div></td></tr></table></div>
<p>输出如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a>        email         | username
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a>---------------------+----------
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a>  hector@example.com  | hector
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a>  steve@example.com   | steve
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a>(2 rows)
</span></code></pre></div></td></tr></table></div>
<p><strong>5.配置双向复制</strong>
双向 xDCR 复制允许您将数据插入任一集群上的同一个表中，并将数据更改添加到另一个集群中。</p>
<p>要为同一表配置双向复制，请运行 bm-admin setup_universe_replication 命令以使“Data Center - East”集群成为“Data Center - West”集群的目标。 这次，目标是127.0.0.1:11000，源是127.0.0.2:11000。</p>
<p>在源 MServer UI (<a href="http://127.0.0.2:10000">http://127.0.0.2:10000</a>) 中查找源 UUID，在 <a href="http://127.0.0.2:10000/tables">http://127.0.0.2:10000/tables</a> 中查找源表 UUID。</p>
<p>根据从 MServer UI 获取的实际值，运行 bm-admin setup_universe_replication 命令，类似于以下示例中所示的命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a>./bin/bm-admin -master_addresses 127.0.0.1:11000 \
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a>    setup_universe_replication 0a315687-e9bd-430f-b6f4-ac831193a394 \
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a>    127.0.0.2:11000 000030a9000030008000000000004000
</span></code></pre></div></td></tr></table></div>
<ul>
<li>target-master-addresses: 127.0.0.1:11000</li>
<li>source-universe-uuid: 0a315687-e9bd-430f-b6f4-ac831193a394</li>
<li>source-master-addresses: 127.0.0.2:11000</li>
<li>source-table-ids: 000030a9000030008000000000004000</li>
</ul>
<p>您应该看到以下消息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a>Replication setup successfully
</span></code></pre></div></td></tr></table></div>
<p><strong>6.验证双向复制</strong>
配置双向复制后，您可以将数据添加到“Data Center - West”集群上的用户表中，并看到数据出现在“Data Center - East”集群上的用户表中。</p>
<p>（1）使用以下命令将数据添加到“Data Center - West”集群，确保您指向新的源主机：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a>./bin/sqlsh -h 127.0.0.2
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a>INSERT INTO users(email, username) VALUES (&#39;neha@example.com&#39;, &#39;neha&#39;), (&#39;mikhail@example.com&#39;, &#39;mikhail&#39;);
</span></code></pre></div></td></tr></table></div>
<p>（2）在新的目标集群上，运行以下命令可以看到集群之间的数据已复制：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a>./bin/sqlsh -h 127.0.0.1
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a>SELECT * FROM users;
</span></code></pre></div></td></tr></table></div>
<p>您应该看到以下输出：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span>
<span class="normal"><a href="#__codelineno-37-6">6</a></span>
<span class="normal"><a href="#__codelineno-37-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a>        email         | username
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a>---------------------+----------
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a>  hector@example.com  | hector
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a>  steve@example.com   | steve
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5"></a>  neha@example.com    | neha
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6"></a>  mikhail@example.com | mikhail
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7"></a>(4 rows)
</span></code></pre></div></td></tr></table></div>
<p><strong>7.添加表</strong>
您可以使用 bm-admin 命令 alter_universe_replication add_table 将更多表添加到现有复制：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a>bm-admin -master_addresses &lt;target-master-addresses&gt; \
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a>        alter_universe_replication &lt;source-universe_uuid&gt; \
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a>        add_table &lt;source-table-ids&gt;
</span></code></pre></div></td></tr></table></div>
<p>以下是一个示例命令：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span>
<span class="normal"><a href="#__codelineno-39-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a>./bin/bm-admin -master_addresses 127.0.0.2:11000 \
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a>    alter_universe_replication 7acd6399-657d-42dc-a90a-646869898c2d \
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a>    add_table 000030a9000030008000000000004000
</span></code></pre></div></td></tr></table></div>
<p>有关详细信息，请参阅 alter_universe_replication。</p>
<h2 id="_2"><strong>读副本</strong><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>将数据异步复制到一个或多个只读副本集群。</p>
<h3 id="bsql"><strong>BSQL</strong><a class="headerlink" href="#bsql" title="Permanent link">&para;</a></h3>
<p>在其他区域运行的应用程序会因读取领导者的最新数据而产生跨区域延迟。 如果对于在其他区域中运行的应用程序来说，读取的一点陈旧性是可以接受的，那么只读副本就是要采用的模式。</p>
<p>只读副本集群是连接到主集群的一组从属节点。 这些纯粹是观察者节点，这意味着它们不参与 Raft 共识和选举。 因此，只读副本可以具有与主集群不同的复制因子 (RF)，并且您可以拥有偶数个副本。</p>
<p>让我们看看这对您的应用程序有何好处。</p>
<p><strong>1.设置</strong>
假设您在 us-east-1 和 us-east-2 中设置了一个 RF 3 集群，并将领导者首选项设置为 us-east-1。 假设您想在美国中部和美国西部运行其他应用程序。 读取延迟类似于下图。</p>
<p><img alt="" src="../assets/chapter6/81.png" /></p>
<p><strong>2.改善读取延迟</strong>
为了改善读取延迟，请在您要运行应用程序且可以接受一点陈旧情况的每个区域中设置单独的只读副本集群。</p>
<p>这使得应用程序能够从最近的副本读取数据，而不是跨区域到Tile领导者。</p>
<p><img alt="" src="../assets/chapter6/82.png" /></p>
<p>请注意，us-west 中应用程序的读取延迟已从最初的 60 毫秒大幅降至 2 毫秒，us-central 中应用程序的读取延迟也已降至 2 毫秒。</p>
<p>由于副本可能并非所有更新都是最新的，根据设计，这可能会返回稍微陈旧的数据（默认值为 30 秒，但可以配置）。</p>
<p>这仅用于读取。 所有写入仍然发送给领导者。</p>
<p><strong>3.故障转移</strong>
当某个区域中的只读副本发生故障时，应用程序会将其读取重定向到下一个最近的只读副本或领导者。</p>
<p><img alt="" src="../assets/chapter6/83.png" /></p>
<p>请注意，当 us-west 中的只读副本失败时，us-west 中的应用程序如何从 us-central 中的follower读取数据。 在这种情况下，读取延迟为 40 ms，仍然比原来的 60 ms 小很多。</p>
<p><strong>4.了解更多</strong>
读取副本架构
追随者阅读</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="%E9%AB%98%E6%89%A9%E5%B1%95%E6%80%A7.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: 高扩展性">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                高扩展性
              </div>
            </div>
          </a>
        
        
          
          <a href="%E5%8D%87%E7%BA%A7%E9%83%A8%E7%BD%B2.html" class="md-footer__link md-footer__link--next" aria-label="下一页: 升级部署">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                升级部署
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023 - 2024 贝格迈思（深圳）技术有限公司 粤ICP备17054434号-1
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/as599397086/BMDOC" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>