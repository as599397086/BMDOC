
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="贝格迈思数据库使用手册">
      
      
      
      
        <link rel="prev" href="%E4%BD%BF%E7%94%A8DOMAIN%E5%80%BC%E6%95%B0%E7%BB%84.html">
      
      
        <link rel="next" href="Binary.html">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>数组函数和运算符 - 手册</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mo" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="页眉"
  >

    <!-- Link to home -->
    <a
      href="../../index.html"
      title="手册"
      class="md-header__button md-logo"
      aria-label="手册"
      data-md-component="logo"
    >
      
  <img src="../../assets/new-logo.png" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            手册
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              数组函数和运算符
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    
      
    

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="手册" class="md-nav__button md-logo" aria-label="手册" data-md-component="logo">
      
  <img src="../../assets/new-logo.png" alt="logo">

    </a>
    手册
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AiSQL简介
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    快速上手
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/JAVA.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    应用开发
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E9%83%A8%E7%BD%B2%E9%9B%86%E7%BE%A4/%E8%BD%AF%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83%E9%9C%80%E6%B1%82.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    部署集群
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据迁移
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93/%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    管理数据库
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../07-%E5%90%91%E9%87%8F%E7%89%B9%E6%80%A7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    向量特性
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../AI%E7%89%B9%E6%80%A7/%E6%A6%82%E8%BF%B0.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    AI特性
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    架构
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../CLIs/sqlsh/%E6%A6%82%E8%BF%B0.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    CLIs
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E9%85%8D%E7%BD%AE/bm-mserver.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    配置
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" checked>
        
          
          <label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    BSQL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            BSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_9_4_1" id="__nav_9_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    数据类型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_4_1">
            <span class="md-nav__icon md-icon"></span>
            数据类型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%95%B0%E7%BB%84.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数组
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="PLpgSQL%E4%B8%AD%E7%9A%84%E6%95%B0%E7%BB%84%E5%BE%AA%E7%8E%AF.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PL/pgSQL中的数组循环
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E4%BD%BF%E7%94%A8DOMAIN%E5%80%BC%E6%95%B0%E7%BB%84.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用DOMAIN值数组
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    数组函数和运算符
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="%E6%95%B0%E7%BB%84%E5%87%BD%E6%95%B0%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    数组函数和运算符
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    创建函数
  </a>
  
    <nav class="md-nav" aria-label="创建函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_fill" class="md-nav__link">
    array_fill()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_agg" class="md-nav__link">
    array_agg()
  </a>
  
    <nav class="md-nav" aria-label="array_agg()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_agg_1" class="md-nav__link">
    array_agg() 重载函数一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_agg_2" class="md-nav__link">
    array_agg() 重载函数二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string_to_array" class="md-nav__link">
    string_to_array()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    几何函数
  </a>
  
    <nav class="md-nav" aria-label="几何函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_ndims" class="md-nav__link">
    array_ndims()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_lower" class="md-nav__link">
    array_lower()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_upper" class="md-nav__link">
    array_upper()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_length" class="md-nav__link">
    array_length()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cardinality" class="md-nav__link">
    cardinality()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_dims" class="md-nav__link">
    array_dims()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    查找函数
  </a>
  
    <nav class="md-nav" aria-label="查找函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_position" class="md-nav__link">
    array_position()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_positions" class="md-nav__link">
    array_positions()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anyall" class="md-nav__link">
    ANY/ALL运算符
  </a>
  
    <nav class="md-nav" aria-label="ANY/ALL运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#any-all" class="md-nav__link">
    ANY 和 ALL
  </a>
  
    <nav class="md-nav" aria-label="ANY 和 ALL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    用途
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    比较运算符
  </a>
  
    <nav class="md-nav" aria-label="比较运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    切片运算符
  </a>
  
    <nav class="md-nav" aria-label="切片运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slice" class="md-nav__link">
    slice运算符
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    连接函数和运算符
  </a>
  
    <nav class="md-nav" aria-label="连接函数和运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_cat" class="md-nav__link">
    array_cat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_append" class="md-nav__link">
    array_append()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_prepend" class="md-nav__link">
    array_prepend()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    更改函数和运算符
  </a>
  
    <nav class="md-nav" aria-label="更改函数和运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_replace" class="md-nav__link">
    array_replace()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arridx_1idx_n-val" class="md-nav__link">
    arr[idx_1]...[idx_N] := val
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_remove" class="md-nav__link">
    array_remove()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    转换函数
  </a>
  
    <nav class="md-nav" aria-label="转换函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_to_string" class="md-nav__link">
    array_to_string()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    表函数
  </a>
  
    <nav class="md-nav" aria-label="表函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unnest" class="md-nav__link">
    unnest()
  </a>
  
    <nav class="md-nav" aria-label="unnest()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unnest_1" class="md-nav__link">
    unnest() 重载函数一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unnest_2" class="md-nav__link">
    unnest() 重载函数二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_subscripts" class="md-nav__link">
    generate_subscripts()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Binary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Boolean.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boolean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Character.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Character
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="date%E4%B8%8Etime.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date与time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="json.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Money.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Money
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数字类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E8%8C%83%E5%9B%B4%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    范围类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Serial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="UUID.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UUID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    枚举类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E5%87%A0%E4%BD%95%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    几何类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    网络地址类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E4%BD%8D%E4%B8%B2%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    位串类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文本搜索类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E5%9F%9F%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    域类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E4%BC%AA%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    伪类型
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../BSQL%E8%AF%AD%E8%A8%80.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSQL语言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/%E9%80%BB%E8%BE%91%E6%93%8D%E4%BD%9C%E7%AC%A6.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    内置函数和运算符
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%85%B3%E9%94%AE%E8%AF%8D.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关键词
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BF%9D%E7%95%99%E5%90%8D%E7%A7%B0.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    保留名称
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%B3%BB%E7%BB%9F%E8%A1%A8%E8%A7%86%E5%9B%BE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    系统表/视图
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../BCQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    BCQL
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    创建函数
  </a>
  
    <nav class="md-nav" aria-label="创建函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_fill" class="md-nav__link">
    array_fill()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_agg" class="md-nav__link">
    array_agg()
  </a>
  
    <nav class="md-nav" aria-label="array_agg()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_agg_1" class="md-nav__link">
    array_agg() 重载函数一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_agg_2" class="md-nav__link">
    array_agg() 重载函数二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string_to_array" class="md-nav__link">
    string_to_array()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    几何函数
  </a>
  
    <nav class="md-nav" aria-label="几何函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_ndims" class="md-nav__link">
    array_ndims()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_lower" class="md-nav__link">
    array_lower()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_upper" class="md-nav__link">
    array_upper()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_length" class="md-nav__link">
    array_length()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cardinality" class="md-nav__link">
    cardinality()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_dims" class="md-nav__link">
    array_dims()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    查找函数
  </a>
  
    <nav class="md-nav" aria-label="查找函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_position" class="md-nav__link">
    array_position()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_positions" class="md-nav__link">
    array_positions()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anyall" class="md-nav__link">
    ANY/ALL运算符
  </a>
  
    <nav class="md-nav" aria-label="ANY/ALL运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#any-all" class="md-nav__link">
    ANY 和 ALL
  </a>
  
    <nav class="md-nav" aria-label="ANY 和 ALL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    用途
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    比较运算符
  </a>
  
    <nav class="md-nav" aria-label="比较运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    切片运算符
  </a>
  
    <nav class="md-nav" aria-label="切片运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slice" class="md-nav__link">
    slice运算符
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    连接函数和运算符
  </a>
  
    <nav class="md-nav" aria-label="连接函数和运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_cat" class="md-nav__link">
    array_cat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_append" class="md-nav__link">
    array_append()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_prepend" class="md-nav__link">
    array_prepend()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    更改函数和运算符
  </a>
  
    <nav class="md-nav" aria-label="更改函数和运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_replace" class="md-nav__link">
    array_replace()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arridx_1idx_n-val" class="md-nav__link">
    arr[idx_1]...[idx_N] := val
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array_remove" class="md-nav__link">
    array_remove()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    转换函数
  </a>
  
    <nav class="md-nav" aria-label="转换函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array_to_string" class="md-nav__link">
    array_to_string()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    表函数
  </a>
  
    <nav class="md-nav" aria-label="表函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unnest" class="md-nav__link">
    unnest()
  </a>
  
    <nav class="md-nav" aria-label="unnest()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unnest_1" class="md-nav__link">
    unnest() 重载函数一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unnest_2" class="md-nav__link">
    unnest() 重载函数二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_subscripts" class="md-nav__link">
    generate_subscripts()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/as599397086/BMDOC/edit/master/docs/BSQL/数据类型/数组函数和运算符.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/as599397086/BMDOC/raw/master/docs/BSQL/数据类型/数组函数和运算符.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>数组函数和运算符</h1>

<p>这里列出的大多数函数和运算符可以使用任何维度的数组，但其中四个函数只接受或生成一维数组。当存在一维数组限制时，下表中的第二列“1-d only?”以“1-d”表示。否则为空，代表没有维度限制。</p>
<h2 id="_1"><strong>创建函数</strong><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>函数和运算符</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_array[]构造函数">array[]</a></td>
<td></td>
<td>array[]值构造函数是一个特殊的函数，它使用每个数组值的表达式从头开始创建数组。表达式本身可以使用array[]构造函数或文本文字。</td>
</tr>
<tr>
<td><a href="#_array_fill()">array_fill()</a></td>
<td></td>
<td>返回一个用指定值和维度初始化好的数组</td>
</tr>
<tr>
<td><a href="#_array_agg()">array_agg()</a></td>
<td></td>
<td>从SQL子查询返回一个数组（隐含的“row”类型）。</td>
</tr>
<tr>
<td><a href="#_string_to_array()">string_to_array()</a></td>
<td>1-d</td>
<td>通过使用指定的分隔符将输入文本值拆分为子值，返回一维text[]数组。（可选）允许将指定的文本值解释为NULL</td>
</tr>
</tbody>
</table>
<h3 id="array_fill">array_fill()<a class="headerlink" href="#array_fill" title="Permanent link">&para;</a></h3>
<p>目的：返回一个用指定值和维度初始化好的数组</p>
<p>用法：
输入值:       anyelement, int[] [, int[]]
返回值:      anyarray</p>
<p>第一个参数确定每个单元格的值和数据类型，从而确定整个新数组的数据类型。它可以是基本数据类型的值，也可以是“row”类型的值。出于某种目的，也可以写成行如NULL::some_type。您可能会设置NOT NULL值，例如，如果您想将数组插入到已创建约束的表列中，该约束基于PL/pgSQL函数，则该函数显式测试数组的几何属性，及其每个值的NOT NULL状态。示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>select pg_typeof(array_fill(null::text, &#39;{1}&#39;)) as &quot;type of the new array&quot;;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a> type of the new array
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>------------------------
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a> text[]
</span></code></pre></div></td></tr></table></div>
<p>第二个参数是一个int[]数组。它的每个值都是array_length(new_arr，n)返回的值，其中“n”是从主维度开始的维度编号。因此，您在这里提供的数组的基数指定了array_ndims(new_arr)返回的值。
第三个参数是可选的。提供时，它必须是一个与第二个参数具有相同基数的int[]数组。它的每个值都指定array_lower(new_arr, n)返回的值。
因此，新数组的形状完全由第二和第三参数指定。 
注意：array_fill()为什么存在？换言之，为什么不直接为每个单元格建立索引，并为其分配你想赋予的值呢？回想一下，正如大纲中所描述的，数组值是线性的。这意味着，当其维度数超过一时，其形状在创建时是无法协商的。如下这个DO块强调了这一点。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>do $body$
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>declare
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>  a int[];
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>  b int[] := array_fill(null::int, &#39;{3, 4}&#39;);
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>begin
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>  a[1][1] := 42;
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a>  begin
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>    -- Causes ERROR: array subscript out of range
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>    a[2][2] := 17;
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a>  exception
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a>    when array_subscript_error then null;
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a>  end;
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a>  raise info
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a>    &#39;cardinality(a), cardinality(b): %, %&#39;, cardinality(a), cardinality(b);
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a>end;
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下（为方便阅读，手动去除了“INFO:”提示）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>  cardinality(a), cardinality(b): 1, 12
</span></code></pre></div></td></tr></table></div>
<p>所以数组“a”被固定为一维的，一个接一个的值。</p>
<p>例如：
运行如下脚本：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>create table t(k int primary key, arr text[]);
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>insert into t(k, arr)
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>values(1, array_fill(&#39;-----&#39;::text, &#39;{3, 4}&#39;, &#39;{2, 7}&#39;)::text[]);
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>select
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a>  array_length(arr, 1)  as len_1,
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>  array_length(arr, 2)  as len_2,
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>  array_lower(arr,  1)  as lb_1,
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a>  array_lower(arr,  2)  as lb_2,
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>  array_ndims(arr)      as ndims,
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a>  cardinality(arr)      as cardinality
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a>from t
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a>where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a> len_1 | len_2 | lb_1 | lb_2 | ndims | cardinality
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>-------+-------+------+------+-------+-------------
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>   3 |     4 |   2 |   7 |    2 |      12
</span></code></pre></div></td></tr></table></div>
<p>接下来，运行如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span>
<span class="normal"><a href="#__codelineno-6-7">7</a></span>
<span class="normal"><a href="#__codelineno-6-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a>update t
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>set
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>  arr[2][ 7] = &#39;2---7&#39;,
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>  arr[2][10] = &#39;2--10&#39;,
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>  arr[4][ 7] = &#39;4---7&#39;,
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>  arr[4][10] = &#39;4--10&#39;
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a>where k = 1;
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a>select arr::text from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下（为方便阅读，手动增加了空格）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a>[2:4][7:10]=
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>  {
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a>    {2---7,-----,-----,2--10},
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>    {-----,-----,-----,-----},
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>    {4---7,-----,-----,4--10}
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>  }
</span></code></pre></div></td></tr></table></div>
<p>最后，再运行如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>\set VERBOSITY verbose
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>update t
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>set
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>  arr[1][17] = &#39;Hmm...&#39;
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>会报告如下错误信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>2202E: array subscript out of range
</span></code></pre></div></td></tr></table></div>
<h3 id="array_agg">array_agg()<a class="headerlink" href="#array_agg" title="Permanent link">&para;</a></h3>
<p>此函数有两个重载函数。</p>
<h4 id="array_agg_1"><em>array_agg() 重载函数一</em><a class="headerlink" href="#array_agg_1" title="Permanent link">&para;</a></h4>
<p>目的：从SQL子查询返回一维数组。它的行可能是标量（也就是说，SELECT列表可能是单列）。但是，一般情况下，可能是“row”类型的值。 </p>
<p>用法：
输入值:       SETOF anyelement
返回值:      anyarray</p>
<p>一般情况下，array_agg()是被应用于SELECT，从物理表或封装视图中进行查询。这在下面的示例中会被演示。但是，首先，您可以通过使用VALUES语句来演示该功能，而无需创建和填充表。示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>values
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>  (1::int, &#39;dog&#39;::text),
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a>  (2::int, &#39;cat&#39;::text),
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a>  (3::int, &#39;ant&#39;::text);
</span></code></pre></div></td></tr></table></div>
<p>生成的结果为：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a> column1 | column2
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>---------+---------
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a>       1 | dog
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a>       2 | cat
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a>       3 | ant
</span></code></pre></div></td></tr></table></div>
<p>请注意，BSQL已将SELECT列表项命名为“column1”和“column2”。其结果就是所谓的SETOF。它意味着一组行，就像使用SELECT语句产生的一样，如果用 \df 元命令描述generate_series()内置表函数，就会看到这个术语。要使用VALUES语句生成的行作为array_agg()的输入，需要使用命名类型，因此： </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span>
<span class="normal"><a href="#__codelineno-12-7">7</a></span>
<span class="normal"><a href="#__codelineno-12-8">8</a></span>
<span class="normal"><a href="#__codelineno-12-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a>with tab as (
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>  values
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>    (1::int, &#39;dog&#39;::text),
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a>    (2::int, &#39;cat&#39;::text),
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a>    (3::int, &#39;ant&#39;::text))
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a>select array_agg((column1, column2)::rt order by column1) as arr
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a>from tab;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a>               arr
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>---------------------------------
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a> {&quot;(1,dog)&quot;,&quot;(2,cat)&quot;,&quot;(3,ant)&quot;}
</span></code></pre></div></td></tr></table></div>
<p>您可以这样理解array_agg()：</p>
<ul>
<li>将每一行视为具有单个值的 “rt[]” 数组。</li>
<li>将所有行中的值按指定顺序连接到一个新的 “rt[]” 数组中。</li>
</ul>
<p>下面代码说明了这一点：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>-- Consider this SELECT:
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>with tab as (
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>  values
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>    ((1, &#39;dog&#39;)::rt),
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a>    ((2, &#39;cat&#39;)::rt),
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a>    ((3, &#39;ant&#39;)::rt))
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a>select array_agg(column1 order by column1) as arr
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a>from tab;
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>-- It can be seen as equivalent this SELECT:
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>select
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>  array[(1, &#39;dog&#39;)::rt] ||
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a>  array[(2, &#39;cat&#39;)::rt] ||
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a>  array[(3, &#39;ant&#39;)::rt]
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a>as arr;
</span></code></pre></div></td></tr></table></div>
<p>上面三个“select…as arr”查询中的每一个都会产生相同的结果，证明了它们在语义上的等价性。</p>
<p>要准备unnest()的演示，请使用 \gset 元命令将三个查询中最近一个查询的单值结果（其中任何一个都可以）保存到bsqlsh变量中。这需要一个单独的参数，通常会加下划线（例如，“result_”），并重新运行SELECT语句，该语句作为最后提交的bsqlsh命令，仍在命令缓冲区中。如果SELECT不是返回单行，则会得到一个明显的错误。通常，当SELECT列表有N个成员，称为“c1”到“cN”，这些值中的每一个都存储在自动创建的变量中，称为”result_c1“到”result_cN“。 </p>
<p>在运行上面的“with…select array_agg（…）as arr…”查询后，立即执行以下操作：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>\gset result_
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>\echo :result_arr
</span></code></pre></div></td></tr></table></div>
<p>\echo 元命令显示以下内容：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>{&quot;(1,dog)&quot;,&quot;(2,cat)&quot;,&quot;(3,ant)&quot;}
</span></code></pre></div></td></tr></table></div>
<h4 id="array_agg_2"><em>array_agg() 重载函数二</em><a class="headerlink" href="#array_agg_2" title="Permanent link">&para;</a></h4>
<p>目的：从行为N维数组的SQL子查询，返回一个（N+1）维数组。聚合数组必须都具有相同的维度。</p>
<p>用法：</p>
<p>输入值:      SETOF anyarray
返回值:      anyarray</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span>
<span class="normal"><a href="#__codelineno-17-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>with tab as (
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a>  values
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a>    (&#39;{a, b, c}&#39;::text[]),
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a>    (&#39;{d, e, f}&#39;::text[]))
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a>select array_agg((column1)::text[] order by column1) as arr
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a>from tab;
</span></code></pre></div></td></tr></table></div>
<p>生成如下结果：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a>        arr
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a>-------------------
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a> {{a,b,c},{d,e,f}}
</span></code></pre></div></td></tr></table></div>
<p>如下是一个不可用的示例：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span>
<span class="normal"><a href="#__codelineno-19-5">5</a></span>
<span class="normal"><a href="#__codelineno-19-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a>with tab as (
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>  values
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a>    (&#39;{a, b, c}&#39;::text[]),
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>    (&#39;{d, e   }&#39;::text[]))
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>select array_agg((column1)::text[] order by column1) as arr
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a>from tab;
</span></code></pre></div></td></tr></table></div>
<p>会报告如下错误信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a>2202E: cannot accumulate arrays of different dimensionality
</span></code></pre></div></td></tr></table></div>
<h3 id="string_to_array">string_to_array()<a class="headerlink" href="#string_to_array" title="Permanent link">&para;</a></h3>
<p>目的：通过使用指定的文本值作为“分隔符”，将输入文本值拆分为子值，返回一维text[] 数组。（可选）允许将指定的文本值解释为NULL。</p>
<p>用法：</p>
<p>输入值:      text, text [, text]
返回值:      text[]</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span>
<span class="normal"><a href="#__codelineno-21-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a>select string_to_array(
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a>  &#39;a|b|?|c&#39;, -- the to-be-split string
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a>  &#39;|&#39;,       -- the character(s) to be taken as the delimiter
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a>  &#39;?&#39;        -- the character(s) to be taken to the null indicator
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5"></a>) as &quot;string_to_array result&quot;;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a> string_to_array result
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a>------------------------
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a> {a,b,NULL,c}
</span></code></pre></div></td></tr></table></div>
<p>语法：
“分隔符”和“null指示符”，使用以下优先级规则：“分隔符”优先于“null指示符”。 
然而，只有当这两个由多个字符定义时，以及当其中一个以序列开头而另一个以顺序结尾时，此规则才重要。</p>
<p>因此，AiSQL建议，就像上面的示例一样，当选择“分隔符”和“null指示符”的文本值时，可以选择两个不同的单个字符。当然，您必须确保在要转换为text[]数组的任何文本值中都不会出现这两个值。</p>
<p>下面的DO块演示了一个不恰当的选择示例：</p>
<ul>
<li>“分隔符”为 ' !'::text</li>
<li>“null指示符”是 '~ '::text。 </li>
</ul>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span>
<span class="normal"><a href="#__codelineno-23-27">27</a></span>
<span class="normal"><a href="#__codelineno-23-28">28</a></span>
<span class="normal"><a href="#__codelineno-23-29">29</a></span>
<span class="normal"><a href="#__codelineno-23-30">30</a></span>
<span class="normal"><a href="#__codelineno-23-31">31</a></span>
<span class="normal"><a href="#__codelineno-23-32">32</a></span>
<span class="normal"><a href="#__codelineno-23-33">33</a></span>
<span class="normal"><a href="#__codelineno-23-34">34</a></span>
<span class="normal"><a href="#__codelineno-23-35">35</a></span>
<span class="normal"><a href="#__codelineno-23-36">36</a></span>
<span class="normal"><a href="#__codelineno-23-37">37</a></span>
<span class="normal"><a href="#__codelineno-23-38">38</a></span>
<span class="normal"><a href="#__codelineno-23-39">39</a></span>
<span class="normal"><a href="#__codelineno-23-40">40</a></span>
<span class="normal"><a href="#__codelineno-23-41">41</a></span>
<span class="normal"><a href="#__codelineno-23-42">42</a></span>
<span class="normal"><a href="#__codelineno-23-43">43</a></span>
<span class="normal"><a href="#__codelineno-23-44">44</a></span>
<span class="normal"><a href="#__codelineno-23-45">45</a></span>
<span class="normal"><a href="#__codelineno-23-46">46</a></span>
<span class="normal"><a href="#__codelineno-23-47">47</a></span>
<span class="normal"><a href="#__codelineno-23-48">48</a></span>
<span class="normal"><a href="#__codelineno-23-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a>do $body$
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>declare
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a>  delim_text  constant text := &#39; !&#39;;
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>  null_text   constant text := &#39;~ &#39;;
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a>  input_text  constant text := &#39;dog house !~  !x! ~ ! cat flap !  !&#39;;
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a>  result constant text[] :=
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a>    string_to_array(input_text, delim_text, null_text);
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11"></a>  good_delim_text constant text := &#39;|&#39;;
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12"></a>  good_null_text  constant text := &#39;?&#39;;
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13"></a>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14"></a>  delim_first_text constant text :=
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15"></a>    replace(replace(
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16"></a>      input_text,
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17"></a>      delim_text, good_delim_text),
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18"></a>      null_text,  good_null_text);
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19"></a>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20"></a>  null_first_text constant text :=
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21"></a>    replace(replace(
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22"></a>      input_text,
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23"></a>      null_text,  good_null_text),
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24"></a>      delim_text, good_delim_text);
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25"></a>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26"></a>  delim_first_result constant text[] :=
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27"></a>    string_to_array(delim_first_text, good_delim_text, good_null_text);
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28"></a>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29"></a>  null_first_result constant text[] :=
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30"></a>    string_to_array(null_first_text, good_delim_text, good_null_text);
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31"></a>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32"></a>  -- Notice that one of the special characters, &quot;!&quot;, remains in
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33"></a>  -- both expected_result and unexpected_result.
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34"></a>  -- If
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35"></a>  expected_result constant text[] :=
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36"></a>    &#39;{&quot;dog house&quot;,NULL,&quot;x! ~&quot;,&quot; cat flap&quot;,&quot; &quot;,&quot;&quot;}&#39;;
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37"></a>  unexpected_result constant text[] :=
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38"></a>    &#39;{&quot;dog house&quot;,NULL,&quot;x! ?! cat flap&quot;,&quot; &quot;,&quot;&quot;}&#39;;
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39"></a>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40"></a>begin
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41"></a>  assert
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42"></a>  (result             =  expected_result)    and
</span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43"></a>  (delim_first_result =  expected_result)    and
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44"></a>  (null_first_result  &lt;&gt; delim_first_result) and
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45"></a>  (null_first_result  =  unexpected_result)  and
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46"></a>    true,
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47"></a>  &#39;unexpected&#39;;
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48"></a>end;
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h2 id="_2"><strong>几何函数</strong><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>函数</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_array_ndims()">array_ndims()</a></td>
<td></td>
<td>返回数组的维度数</td>
</tr>
<tr>
<td><a href="#_array_lower()">array_lower()</a></td>
<td></td>
<td>返回指定数组沿指定维度的下界</td>
</tr>
<tr>
<td><a href="#_array_upper()">array_upper()</a></td>
<td></td>
<td>返回指定数组沿指定维度的上界</td>
</tr>
<tr>
<td><a href="#_array_length()">array_length()</a></td>
<td></td>
<td>返回指定数组沿指定维度的长度</td>
</tr>
<tr>
<td><a href="#_cardinality()">cardinality()</a></td>
<td></td>
<td>返回数组中元素的总数，如果数组为空则返回 0</td>
</tr>
<tr>
<td><a href="#_array_dims()">array_dims()</a></td>
<td></td>
<td>返回数组的维度的文本表示，对于所有维度，在单个文本值中返回与array_lower（）和array_length（）相同信息的文本表示形式。</td>
</tr>
</tbody>
</table>
<p>本节函数示例均使用如下表及其相关数据：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a>create table t(k int primary key, arr_1 text[], arr_2 text[]);
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a>insert into t(k, arr_1, arr_2) values(1,
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a>      &#39;[3:10]={ 1, 2, 3, 4,   5, 6, 7, 8}&#39;,
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a>  &#39;[2:3][4:7]={{1, 2, 3, 4}, {5, 6, 7, 8}}&#39;
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a>  );
</span></code></pre></div></td></tr></table></div>
<h3 id="array_ndims">array_ndims()<a class="headerlink" href="#array_ndims" title="Permanent link">&para;</a></h3>
<p>目的：返回指定数组的维数（即维度）。</p>
<p>用法：</p>
<p>输入值:       anyarray
返回值:      int</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a>select
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a>  array_ndims(arr_1) as ndims_1,
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a>  array_ndims(arr_2) as ndims_2
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a>  ndims_1 | ndims_2
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a>---------+---------
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>       1 |       2
</span></code></pre></div></td></tr></table></div>
<h3 id="array_lower">array_lower()<a class="headerlink" href="#array_lower" title="Permanent link">&para;</a></h3>
<p>目的：返回指定数组沿指定维度的下界。</p>
<p>用法：</p>
<p>输入值:       anyarray, int
返回值:      int</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span>
<span class="normal"><a href="#__codelineno-27-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>select
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a>  array_lower(arr_1, 1) as arr_1_lb,
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a>  array_lower(arr_2, 1) as arr_2_lb_1,
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4"></a>  array_lower(arr_2, 2) as arr_2_lb_2
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a> arr_1_lb | arr_2_lb_1 | arr_2_lb_2
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>----------+------------+--------------
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a>       3 |        2 |        4
</span></code></pre></div></td></tr></table></div>
<h3 id="array_upper">array_upper()<a class="headerlink" href="#array_upper" title="Permanent link">&para;</a></h3>
<p>目的：返回指定数组沿指定维度的上界。</p>
<p>用法：</p>
<p>输入值:       anyarray, int
返回值:      int</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span>
<span class="normal"><a href="#__codelineno-29-3">3</a></span>
<span class="normal"><a href="#__codelineno-29-4">4</a></span>
<span class="normal"><a href="#__codelineno-29-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a>select
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a>  array_upper(arr_1, 1) as arr_1_ub,
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a>  array_upper(arr_2, 1) as arr_2_ub_1,
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a>  array_upper(arr_2, 2) as arr_2_ub_2
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a> arr_1_ub | arr_2_ub_1 | arr_2_ub_2
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a>----------+------------+----------------
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a>       10 |        3 |        7
</span></code></pre></div></td></tr></table></div>
<h3 id="array_length">array_length()<a class="headerlink" href="#array_length" title="Permanent link">&para;</a></h3>
<p>目的：返回指定数组沿指定维度的长度</p>
<p>用法：</p>
<p>输入值:       anyarray, int
返回值:      int</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span>
<span class="normal"><a href="#__codelineno-31-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a>select
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a>  array_length(arr_1, 1) as arr_1_len,
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a>  array_length(arr_2, 1) as arr_2_len_1,
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4"></a>  array_length(arr_2, 2) as arr_2_len_2
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a> arr_1_len | arr_2_len_1 | arr_2_len_2
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a>-----------+-------------+----------------
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a>        8 |         2 |         4
</span></code></pre></div></td></tr></table></div>
<h3 id="cardinality">cardinality()<a class="headerlink" href="#cardinality" title="Permanent link">&para;</a></h3>
<p>目的：返回数组中元素的总数，如果数组为空则返回 0。请注意，此函数返回的值可以计算为array_length()函数的每一个维度返回的值的乘积。 </p>
<p>用法：</p>
<p>输入值:       anyarray
返回值:      int</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span>
<span class="normal"><a href="#__codelineno-33-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a>select
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a>  cardinality(arr_1) as card_1,
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a>  cardinality(arr_2) as card_2
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span>
<span class="normal"><a href="#__codelineno-34-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a> card_1 | card_2
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a>--------+--------
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a>      8 |    8
</span></code></pre></div></td></tr></table></div>
<h3 id="array_dims">array_dims()<a class="headerlink" href="#array_dims" title="Permanent link">&para;</a></h3>
<p>目的：返回数组的维度的文本表示，对于所有维度，在单个文本值中返回与array_lower（）和array_length（）相同信息的文本表示形式。</p>
<p>用法：</p>
<p>输入值:       anyarray
返回值:      text</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span>
<span class="normal"><a href="#__codelineno-35-3">3</a></span>
<span class="normal"><a href="#__codelineno-35-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a>select
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a>  array_dims(arr_1) as arr_1_dims,
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a>  array_dims(arr_2) as arr_2_dims
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a> arr_1_dims | arr_2_dims
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a>------------+------------
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3"></a> [3:10]     | [2:3][4:7]
</span></code></pre></div></td></tr></table></div>
<h2 id="_3"><strong>查找函数</strong><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>函数</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_array_position()">array_position()</a></td>
<td>1-d</td>
<td>在提供的数组中返回指定值的索引。（可选）在指定索引处开始搜索。</td>
</tr>
<tr>
<td><a href="#_array_positions()">array_positions()</a></td>
<td>1-d</td>
<td>在提供的数组中，返回所有出现指定值的索引</td>
</tr>
</tbody>
</table>
<p>这些函数要求要搜索的数组是一维的。它们返回指定要搜索数组中指定要搜索值的索引值。
本节函数示例均使用如下自定义函数：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-37-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-37-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-37-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-37-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-37-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-37-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-37-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-37-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-37-10">10</a></span>
<span class="normal"><a href="#__codelineno-37-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a>drop function if exists arr() cascade;
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a>create function arr()
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a>  returns text[]
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a>  language sql
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5"></a>as $body$
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6"></a>  select array[
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7"></a>                &#39;mon&#39;, &#39;tue&#39;, &#39;wed&#39;, &#39;thu&#39;,&#39;fri&#39;, &#39;sat&#39;, &#39;sun&#39;, 
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8"></a>                &#39;mon&#39;, &#39;tue&#39;, &#39;wed&#39;, &#39;thu&#39;,&#39;fri&#39;, &#39;sat&#39;, &#39;sun&#39;,
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9"></a>                &#39;mon&#39;, &#39;tue&#39;, &#39;wed&#39;
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10"></a>              ];
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>按索引号列出days_arr列的元素，使用内置函数generate_subscripts（）。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span>
<span class="normal"><a href="#__codelineno-38-4">4</a></span>
<span class="normal"><a href="#__codelineno-38-5">5</a></span>
<span class="normal"><a href="#__codelineno-38-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a>with c(days, pos) as (
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a>  select a, subscripts.pos
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a>  from arr() as a
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4"></a>  cross join lateral
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5"></a>  generate_subscripts(arr(), 1) as subscripts(pos))
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6"></a>select pos, days[pos] as day from c order by pos;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-39-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-39-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-39-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-39-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-39-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-39-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-39-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-39-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-39-10">10</a></span>
<span class="normal"><a href="#__codelineno-39-11">11</a></span>
<span class="normal"><a href="#__codelineno-39-12">12</a></span>
<span class="normal"><a href="#__codelineno-39-13">13</a></span>
<span class="normal"><a href="#__codelineno-39-14">14</a></span>
<span class="normal"><a href="#__codelineno-39-15">15</a></span>
<span class="normal"><a href="#__codelineno-39-16">16</a></span>
<span class="normal"><a href="#__codelineno-39-17">17</a></span>
<span class="normal"><a href="#__codelineno-39-18">18</a></span>
<span class="normal"><a href="#__codelineno-39-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a> pos | day 
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a>-----+-----
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a>   1 | mon
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4"></a>   2 | tue
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5"></a>   3 | wed
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6"></a>   4 | thu
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7"></a>   5 | fri
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8"></a>   6 | sat
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9"></a>   7 | sun
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10"></a>   8 | mon
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11"></a>   9 | tue
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12"></a>  10 | wed
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13"></a>  11 | thu
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14"></a>  12 | fri
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15"></a>  13 | sat
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16"></a>  14 | sun
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17"></a>  15 | mon
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18"></a>  16 | tue
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19"></a>  17 | wed
</span></code></pre></div></td></tr></table></div>
<h3 id="array_position">array_position()<a class="headerlink" href="#array_position" title="Permanent link">&para;</a></h3>
<p>目的：在提供的数组中返回指定值的索引。（可选）在指定索引处开始搜索。</p>
<p>用法：</p>
<p>输入值:       anyarray, anyelement [, int]
返回值:      int</p>
<p>注：第三个参数是可选的，包含指定的开始搜索的索引值。</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span>
<span class="normal"><a href="#__codelineno-40-5">5</a></span>
<span class="normal"><a href="#__codelineno-40-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a>select array_position(
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2"></a>    arr(),        -- The to-be-searched array.
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3"></a>    &#39;tue&#39;::text,  -- The to-be-searched-for value.
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4"></a>    3::int        -- The (inclusive) position
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5"></a>                  --   at which to start searching. [optional]
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6"></a>  ) as position;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a> position 
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2"></a>-----------
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3"></a>      9
</span></code></pre></div></td></tr></table></div>
<h3 id="array_positions">array_positions()<a class="headerlink" href="#array_positions" title="Permanent link">&para;</a></h3>
<p>目的：在提供的数组中，返回所有出现指定值的索引</p>
<p>用法：</p>
<p>输入值:       anyarray, anyelement
返回值:      integer[]</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span>
<span class="normal"><a href="#__codelineno-42-2">2</a></span>
<span class="normal"><a href="#__codelineno-42-3">3</a></span>
<span class="normal"><a href="#__codelineno-42-4">4</a></span>
<span class="normal"><a href="#__codelineno-42-5">5</a></span>
<span class="normal"><a href="#__codelineno-42-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a>select unnest(
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a>  array_positions(
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a>      arr(),       -- The to-be-searched array.
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a>      &#39;tue&#39;::text  -- The to-be-searched-for value.
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a>    )
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a>  ) as position;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span>
<span class="normal"><a href="#__codelineno-43-3">3</a></span>
<span class="normal"><a href="#__codelineno-43-4">4</a></span>
<span class="normal"><a href="#__codelineno-43-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a> position 
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a>-----------
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3"></a>      2
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4"></a>      9
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5"></a>     16
</span></code></pre></div></td></tr></table></div>
<h2 id="anyall"><strong>ANY/ALL运算符</strong><a class="headerlink" href="#anyall" title="Permanent link">&para;</a></h2>
<p>这些运算符要求LHS是标量，RHS是该LHS数据类型的数组
注：LHS代表操作符的左边，RHS代表操作符的右边，下文中，如未做特殊说明，LHS，RHS均代表此意义。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_ANY和ALL">ANY</a></td>
<td></td>
<td>如果LHS元素和RHS数组的每个元素之间，至少有一个指定的不等式测试结果为TRUE，则返回TRUE。</td>
</tr>
<tr>
<td><a href="#_ANY和ALL">ALL</a></td>
<td></td>
<td>如果LHS元素和RHS数组的每个元素之间，每个指定不等式测试的结果均为TRUE，则返回TRUE。</td>
</tr>
</tbody>
</table>
<h3 id="any-all">ANY 和 ALL<a class="headerlink" href="#any-all" title="Permanent link">&para;</a></h3>
<p>ANY和ALL运算符中的每一个都具有相同的用法。</p>
<h4 id="_4"><em>概述</em><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>注意：SOME是ANY的同义词。</p>
<p>用法：</p>
<p>输入值:       anyelement, anyarray
返回值:      boolean</p>
<p>这些运算符中的每一个都要求LHS表达式所计算的元素值的数据类型，与RHS表达式所计算的数组值的数据类型相对应。例如，当LHS元素的数据类型为“t”时，RHS数组的数据类型必须为“t[]”。RHS数组可以具有任何维度。运算符对数组中的实际元素是敏感的。</p>
<p>目的：
根据指定的一组比较的结果，返回TRUE、FALSE或NULL。如下是调用的一般形式：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a>any_all_boolean_expression ::=
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2"></a>  lhs_element { = | &lt;&gt; | &lt; | &lt;= | &gt;= | &gt; } { ANY | ALL} rhs_array
</span></code></pre></div></td></tr></table></div>
<p>注意：!= 从等式和不等式运算符列表中省略，因为这只是 &lt;&gt; 不等式运算符的另一种拼写形式。 </p>
<p>因为“any_all_boolean_expression”只是一个布尔表达式，它可以选择性地在前面加上NOT一元运算符，并且可以以正常方式使用AND和OR与其他布尔表达式相结合使用。
“any_all_boolean_expression”依次访问数组的每个元素（如前所述，数组的维度无关紧要），并在LHS元素和当前数组元素之间，进行相等或不相等的比较。</p>
<h4 id="_5"><em>用途</em><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>ANY和ALL是互补的。
注意，元素和数组的使用（在关于ANY和AND的整个部分中）指出了一个事实，就是LHS和RHS通常都是表达式。所以元素充当LHS表达式计算值的简写，数组充当RHS表达式计算值的简写。
分为简单场景与特别需求场景解释如下：
1）简单的场景
简单的场景仅限于LHS元素为NOT NULL、RHS数组为NOT NULL，并且RHS数组的基数至少为1的情况。</p>
<p>当LHS元素与RHS数组的每个元素进行比较时，这个比较会使用在“any_all_boolean_expression”中使用的特定等式或不等式运算符的适当的数据类型重载。</p>
<ul>
<li>如果使用了ANY，则只有在连续比较中，至少有一个对比结果为TRUE时，最终结果才为TRUE。如果其他比较中有零个，或多个对比结果为NULL，也并并不会有任何的影响。如果每个比较的结果都为FALSE，则最终结果为FALSE。如果每个比较的计算结果都为NULL，则结果为NULL。</li>
<li>如果使用了ALL，则只有当每个连续比较的求值结果为TRUE时，结果才为TRUE。如果至少有一个比较结果为FALSE，而没有一个结果为NULL，则结果为FALSE；如果至少有一个比较结果为NULL，则结果为NULL。</li>
</ul>
<p>请注意，ANY与OR类似，ALL与AND 类似：</p>
<ul>
<li>如果使用ANY，则结果是连续的单个比较的OR组合。</li>
<li>如果使用ALL，则结果是连续的单个比较的AND组合。</li>
</ul>
<p>下面这个DO块演示了如何使用OR和AND：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-45-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-45-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-45-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-45-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-45-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-45-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-45-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-45-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-45-10">10</a></span>
<span class="normal"><a href="#__codelineno-45-11">11</a></span>
<span class="normal"><a href="#__codelineno-45-12">12</a></span>
<span class="normal"><a href="#__codelineno-45-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a>do $body$
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2"></a>begin
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3"></a>  -- OR
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4"></a>  assert     (true  or  false or  null),             &#39;assert failed&#39;;
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5"></a>  assert     not (false or  false or  false),          &#39;assert failed&#39;;
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6"></a>  assert     (false or  false or  null)   is null,     &#39;assert failed&#39;;
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7"></a>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8"></a>  -- AND
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9"></a>  assert     (true  and true  and true),            &#39;assert failed&#39;;
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10"></a>  assert     not (true  and true  and false),         &#39;assert failed&#39;;
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11"></a>  assert     (true  and true  and null)   is null,     &#39;assert failed&#39;;
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12"></a>end;
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>下一个DO块是对块的手动重写，它演示了OR和AND的用途，也相应地展示了ANY和ALL的语义。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-46-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-46-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-46-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-46-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-46-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-46-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-46-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-46-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-46-10">10</a></span>
<span class="normal"><a href="#__codelineno-46-11">11</a></span>
<span class="normal"><a href="#__codelineno-46-12">12</a></span>
<span class="normal"><a href="#__codelineno-46-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a>do $body$
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2"></a>begin
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3"></a>  -- ANY
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4"></a>  assert     (true = any (array[true,  false, null ]::boolean[])),         &#39;assert failed&#39;;
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5"></a>  assert not (true = any (array[false, false, false]::boolean[])),         &#39;assert failed&#39;;
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6"></a>  assert     (true = any (array[false, false, null ]::boolean[])) is null, &#39;assert failed&#39;;
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7"></a>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8"></a>  -- ALL
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9"></a>  assert     (true = all (array[true,  true,  true ]::boolean[])),         &#39;assert failed&#39;;
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10"></a>  assert not (true = all (array[true,  true,  false]::boolean[])),         &#39;assert failed&#39;;
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11"></a>  assert     (true = all (array[true,  true,  null ]::boolean[])) is null, &#39;assert failed&#39;;
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12"></a>end;
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>= ANY在功能上等同于IN（但当RHS是数组时，IN是非法语法），而 =ALL在功能上没有类似等价的。
例如如下示例：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span>
<span class="normal"><a href="#__codelineno-47-2">2</a></span>
<span class="normal"><a href="#__codelineno-47-3">3</a></span>
<span class="normal"><a href="#__codelineno-47-4">4</a></span>
<span class="normal"><a href="#__codelineno-47-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a>select (
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2"></a>    42 = any (array[17, 42, 53])
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3"></a>    and
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4"></a>    42 in (17, 42, 53)
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5"></a>  )::text as b;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1"></a>  b
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2"></a>------
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3"></a> true
</span></code></pre></div></td></tr></table></div>
<p>注意，在这里，“（17，42，53）”不是一个结构化记录，因为在它前面加了IN。相反，在下面的示例中，“（17,42,53）”是一个结构化记录：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1"></a>with v as (select (17, 42, 53) as r)
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2"></a>select pg_typeof(r)::text from v;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1"></a> pg_typeof
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2"></a>-----------
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3"></a> record
</span></code></pre></div></td></tr></table></div>
<p>由于直接使用“（17，42，53）”作为SELECT列表项。因此，如下会导致语法错误：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1"></a>with v as (select (1, 2, 3, 4) as r)
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2"></a>select 1 in r from v;
</span></code></pre></div></td></tr></table></div>
<p>2）特别需求场景
本小节解释如下：当LHS元素和RHS数组中的一个，或全部为NULL时；当LHS或RHS都不为NULL，并且RHS数组的基数为零时。</p>
<ul>
<li>如果LHS元素或RHS数组为NULL，则ANY结果为NULL，ALL结果也为NULL。</li>
<li>如果LHS元素不是NULL，RHS数组不是NULL，并且RHS数组有零个元素，那么ANY结果为FALSE。</li>
<li>如果LHS元素不是NULL，RHS数组不是NULL，并且RHS数组有零个元素，则ALL结果为TRUE。 </li>
</ul>
<h4 id="_6"><em>示例</em><a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<p>以下示例显示了单元素数组、复合元素数组和DOMAIN值元素数组的使用。
1）单元素数组</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-52-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-52-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-52-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-52-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-52-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-52-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-52-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-52-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-52-10">10</a></span>
<span class="normal"><a href="#__codelineno-52-11">11</a></span>
<span class="normal"><a href="#__codelineno-52-12">12</a></span>
<span class="normal"><a href="#__codelineno-52-13">13</a></span>
<span class="normal"><a href="#__codelineno-52-14">14</a></span>
<span class="normal"><a href="#__codelineno-52-15">15</a></span>
<span class="normal"><a href="#__codelineno-52-16">16</a></span>
<span class="normal"><a href="#__codelineno-52-17">17</a></span>
<span class="normal"><a href="#__codelineno-52-18">18</a></span>
<span class="normal"><a href="#__codelineno-52-19">19</a></span>
<span class="normal"><a href="#__codelineno-52-20">20</a></span>
<span class="normal"><a href="#__codelineno-52-21">21</a></span>
<span class="normal"><a href="#__codelineno-52-22">22</a></span>
<span class="normal"><a href="#__codelineno-52-23">23</a></span>
<span class="normal"><a href="#__codelineno-52-24">24</a></span>
<span class="normal"><a href="#__codelineno-52-25">25</a></span>
<span class="normal"><a href="#__codelineno-52-26">26</a></span>
<span class="normal"><a href="#__codelineno-52-27">27</a></span>
<span class="normal"><a href="#__codelineno-52-28">28</a></span>
<span class="normal"><a href="#__codelineno-52-29">29</a></span>
<span class="normal"><a href="#__codelineno-52-30">30</a></span>
<span class="normal"><a href="#__codelineno-52-31">31</a></span>
<span class="normal"><a href="#__codelineno-52-32">32</a></span>
<span class="normal"><a href="#__codelineno-52-33">33</a></span>
<span class="normal"><a href="#__codelineno-52-34">34</a></span>
<span class="normal"><a href="#__codelineno-52-35">35</a></span>
<span class="normal"><a href="#__codelineno-52-36">36</a></span>
<span class="normal"><a href="#__codelineno-52-37">37</a></span>
<span class="normal"><a href="#__codelineno-52-38">38</a></span>
<span class="normal"><a href="#__codelineno-52-39">39</a></span>
<span class="normal"><a href="#__codelineno-52-40">40</a></span>
<span class="normal"><a href="#__codelineno-52-41">41</a></span>
<span class="normal"><a href="#__codelineno-52-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1"></a>do $body$
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2"></a>declare
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3"></a>  v1 constant int := 1;
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4"></a>  v2 constant int := 2;
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5"></a>  v3 constant int := 3;
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6"></a>  v4 constant int := 4;
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7"></a>  v5 constant int := 5;
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8"></a>  v6 constant int := null;
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9"></a>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10"></a>  arr1 constant int[] := array[v1, v1, v1, v1];
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11"></a>  arr2 constant int[] := array[v1, v1, v1, v2];
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12"></a>  arr3 constant int[] := array[v1, v2, v3, v4];
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13"></a>  arr4 constant int[] := array[v1, v1, v1, null];
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14"></a>  arr5 constant int[] := null;
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15"></a>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16"></a>  -- Notice that an array with zero elements is nevertheless NOT NULL.
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17"></a>  arr6 constant int[] not null := &#39;{}&#39;;
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18"></a>
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19"></a>  b01 constant boolean not null :=     v1 = all (arr1);
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20"></a>  b02 constant boolean not null := not  v1 = all (arr3);
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21"></a>  b03 constant boolean not null := not  v1 = all (arr2);
</span><span id="__span-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22"></a>  b04 constant boolean not null :=     v1 = any (arr3);
</span><span id="__span-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23"></a>  b05 constant boolean not null := not  v5 = any (arr3);
</span><span id="__span-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24"></a>
</span><span id="__span-52-25"><a id="__codelineno-52-25" name="__codelineno-52-25"></a>  b06 constant boolean not null :=      v1 = any (arr4);
</span><span id="__span-52-26"><a id="__codelineno-52-26" name="__codelineno-52-26"></a>  b07 constant boolean not null :=     (v5 = any (arr4)) is null;
</span><span id="__span-52-27"><a id="__codelineno-52-27" name="__codelineno-52-27"></a>  b08 constant boolean not null :=     (v1 = all (arr4)) is null;
</span><span id="__span-52-28"><a id="__codelineno-52-28" name="__codelineno-52-28"></a>
</span><span id="__span-52-29"><a id="__codelineno-52-29" name="__codelineno-52-29"></a>  b09 constant boolean not null :=     (v1 = any (arr5)) is null;
</span><span id="__span-52-30"><a id="__codelineno-52-30" name="__codelineno-52-30"></a>  b10 constant boolean not null :=     (v6 = any (arr1)) is null;
</span><span id="__span-52-31"><a id="__codelineno-52-31" name="__codelineno-52-31"></a>  b11 constant boolean not null :=     (v1 = all (arr5)) is null;
</span><span id="__span-52-32"><a id="__codelineno-52-32" name="__codelineno-52-32"></a>  b12 constant boolean not null :=     (v6 = all (arr1)) is null;
</span><span id="__span-52-33"><a id="__codelineno-52-33" name="__codelineno-52-33"></a>
</span><span id="__span-52-34"><a id="__codelineno-52-34" name="__codelineno-52-34"></a>  b13 constant boolean not null :=  not (v1 = any (arr6));
</span><span id="__span-52-35"><a id="__codelineno-52-35" name="__codelineno-52-35"></a>  b14 constant boolean not null :=     (v1 = all (arr6));
</span><span id="__span-52-36"><a id="__codelineno-52-36" name="__codelineno-52-36"></a>begin
</span><span id="__span-52-37"><a id="__codelineno-52-37" name="__codelineno-52-37"></a>  assert
</span><span id="__span-52-38"><a id="__codelineno-52-38" name="__codelineno-52-38"></a>    (b01 and b02 and b03 and b04 and b05 and b06 and b07 and b08
</span><span id="__span-52-39"><a id="__codelineno-52-39" name="__codelineno-52-39"></a>         and b09 and b10 and b11 and b12 and b13 and b14),
</span><span id="__span-52-40"><a id="__codelineno-52-40" name="__codelineno-52-40"></a>  &#39;assert failed&#39;;
</span><span id="__span-52-41"><a id="__codelineno-52-41" name="__codelineno-52-41"></a>end;
</span><span id="__span-52-42"><a id="__codelineno-52-42" name="__codelineno-52-42"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>下面是一个从上面的代码中派生的示例，它使用二维数组代替一维数组。但为了提高可读性，删除了一些测试。其余测试的结果没有变化，因为这些结果仅取决于数组的实际元素，而不取决于其几何结构。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-53-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-53-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-53-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-53-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-53-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-53-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-53-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-53-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-53-10">10</a></span>
<span class="normal"><a href="#__codelineno-53-11">11</a></span>
<span class="normal"><a href="#__codelineno-53-12">12</a></span>
<span class="normal"><a href="#__codelineno-53-13">13</a></span>
<span class="normal"><a href="#__codelineno-53-14">14</a></span>
<span class="normal"><a href="#__codelineno-53-15">15</a></span>
<span class="normal"><a href="#__codelineno-53-16">16</a></span>
<span class="normal"><a href="#__codelineno-53-17">17</a></span>
<span class="normal"><a href="#__codelineno-53-18">18</a></span>
<span class="normal"><a href="#__codelineno-53-19">19</a></span>
<span class="normal"><a href="#__codelineno-53-20">20</a></span>
<span class="normal"><a href="#__codelineno-53-21">21</a></span>
<span class="normal"><a href="#__codelineno-53-22">22</a></span>
<span class="normal"><a href="#__codelineno-53-23">23</a></span>
<span class="normal"><a href="#__codelineno-53-24">24</a></span>
<span class="normal"><a href="#__codelineno-53-25">25</a></span>
<span class="normal"><a href="#__codelineno-53-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1"></a>do $body$
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2"></a>declare
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3"></a>  v1 constant int := 1;
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4"></a>  v2 constant int := 2;
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5"></a>  v3 constant int := 3;
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6"></a>  v4 constant int := 4;
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7"></a>  v5 constant int := 5;
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8"></a>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9"></a>  arr1 constant int[] := array[array[v1, v1], array[v1, v1]];
</span><span id="__span-53-10"><a id="__codelineno-53-10" name="__codelineno-53-10"></a>  arr2 constant int[] := array[array[v1, v2], array[v3, v4]];
</span><span id="__span-53-11"><a id="__codelineno-53-11" name="__codelineno-53-11"></a>  arr3 constant int[] := array[array[v1, v1], array[v1, null]];
</span><span id="__span-53-12"><a id="__codelineno-53-12" name="__codelineno-53-12"></a>
</span><span id="__span-53-13"><a id="__codelineno-53-13" name="__codelineno-53-13"></a>  b1 constant boolean not null :=     v1 = all (arr1);
</span><span id="__span-53-14"><a id="__codelineno-53-14" name="__codelineno-53-14"></a>  b2 constant boolean not null := not  v1 = all (arr2);
</span><span id="__span-53-15"><a id="__codelineno-53-15" name="__codelineno-53-15"></a>  b3 constant boolean not null :=     v1 = any (arr2);
</span><span id="__span-53-16"><a id="__codelineno-53-16" name="__codelineno-53-16"></a>  b4 constant boolean not null := not  v5 = any (arr2);
</span><span id="__span-53-17"><a id="__codelineno-53-17" name="__codelineno-53-17"></a>
</span><span id="__span-53-18"><a id="__codelineno-53-18" name="__codelineno-53-18"></a>  b5 constant boolean not null :=     v1 = any (arr3);
</span><span id="__span-53-19"><a id="__codelineno-53-19" name="__codelineno-53-19"></a>  b6 constant boolean not null :=     (v5 = any (arr3)) is null;
</span><span id="__span-53-20"><a id="__codelineno-53-20" name="__codelineno-53-20"></a>  b7 constant boolean not null :=     (v1 = all (arr3)) is null;
</span><span id="__span-53-21"><a id="__codelineno-53-21" name="__codelineno-53-21"></a>begin
</span><span id="__span-53-22"><a id="__codelineno-53-22" name="__codelineno-53-22"></a>  assert
</span><span id="__span-53-23"><a id="__codelineno-53-23" name="__codelineno-53-23"></a>    (b1 and b2 and b3 and b4 and b5 and b6 and b7),
</span><span id="__span-53-24"><a id="__codelineno-53-24" name="__codelineno-53-24"></a>  &#39;assert failed&#39;;
</span><span id="__span-53-25"><a id="__codelineno-53-25" name="__codelineno-53-25"></a>end;
</span><span id="__span-53-26"><a id="__codelineno-53-26" name="__codelineno-53-26"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>2）复合元素数组（row类型）
该代码是通过将int替换为“rt”，并相应地更改了给“v1”到“v5”的值分配。同样，为了提高可读性，删除了一些测试。其余代码的其余部分与第一个示例中的对应代码相同。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-54-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-54-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-54-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-54-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-54-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-54-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-54-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-54-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-54-10">10</a></span>
<span class="normal"><a href="#__codelineno-54-11">11</a></span>
<span class="normal"><a href="#__codelineno-54-12">12</a></span>
<span class="normal"><a href="#__codelineno-54-13">13</a></span>
<span class="normal"><a href="#__codelineno-54-14">14</a></span>
<span class="normal"><a href="#__codelineno-54-15">15</a></span>
<span class="normal"><a href="#__codelineno-54-16">16</a></span>
<span class="normal"><a href="#__codelineno-54-17">17</a></span>
<span class="normal"><a href="#__codelineno-54-18">18</a></span>
<span class="normal"><a href="#__codelineno-54-19">19</a></span>
<span class="normal"><a href="#__codelineno-54-20">20</a></span>
<span class="normal"><a href="#__codelineno-54-21">21</a></span>
<span class="normal"><a href="#__codelineno-54-22">22</a></span>
<span class="normal"><a href="#__codelineno-54-23">23</a></span>
<span class="normal"><a href="#__codelineno-54-24">24</a></span>
<span class="normal"><a href="#__codelineno-54-25">25</a></span>
<span class="normal"><a href="#__codelineno-54-26">26</a></span>
<span class="normal"><a href="#__codelineno-54-27">27</a></span>
<span class="normal"><a href="#__codelineno-54-28">28</a></span>
<span class="normal"><a href="#__codelineno-54-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1"></a>drop type if exists rt;
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2"></a>create type rt as (a int, b text);
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3"></a>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4"></a>do $body$
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5"></a>declare
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6"></a>  v1 constant rt := (0, 1);
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7"></a>  v2 constant rt := (2, 3);
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8"></a>  v3 constant rt := (4, 5);
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9"></a>  v4 constant rt := (6, 7);
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10"></a>  v5 constant rt := (8, 9);
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11"></a>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12"></a>  arr1 constant rt[] := array[v1, v1, v1, v1];
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13"></a>  arr2 constant rt[] := array[v1, v2, v3, v4];
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14"></a>  arr3 constant rt[] := array[v1, v1, v1, null::rt];
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15"></a>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16"></a>  b1 constant boolean not null :=     v1 = all (arr1);
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17"></a>  b2 constant boolean not null := not v1 = all (arr2);
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18"></a>  b3 constant boolean not null :=     v1 = any (arr2);
</span><span id="__span-54-19"><a id="__codelineno-54-19" name="__codelineno-54-19"></a>  b4 constant boolean not null := not v5 = any (arr2);
</span><span id="__span-54-20"><a id="__codelineno-54-20" name="__codelineno-54-20"></a>
</span><span id="__span-54-21"><a id="__codelineno-54-21" name="__codelineno-54-21"></a>  b5 constant boolean not null :=     v1 = any (arr3);
</span><span id="__span-54-22"><a id="__codelineno-54-22" name="__codelineno-54-22"></a>  b6 constant boolean not null :=    (v5 = any (arr3)) is null;
</span><span id="__span-54-23"><a id="__codelineno-54-23" name="__codelineno-54-23"></a>  b7 constant boolean not null :=    (v1 = all (arr3)) is null;
</span><span id="__span-54-24"><a id="__codelineno-54-24" name="__codelineno-54-24"></a>begin
</span><span id="__span-54-25"><a id="__codelineno-54-25" name="__codelineno-54-25"></a>  assert
</span><span id="__span-54-26"><a id="__codelineno-54-26" name="__codelineno-54-26"></a>    (b1 and b2 and b3 and b4 and b5 and b6 and b7),
</span><span id="__span-54-27"><a id="__codelineno-54-27" name="__codelineno-54-27"></a>  &#39;assert failed&#39;;
</span><span id="__span-54-28"><a id="__codelineno-54-28" name="__codelineno-54-28"></a>end;
</span><span id="__span-54-29"><a id="__codelineno-54-29" name="__codelineno-54-29"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>3）DOMAIN值元素数组
首先，考虑以下两个示例：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1">1</a></span>
<span class="normal"><a href="#__codelineno-55-2">2</a></span>
<span class="normal"><a href="#__codelineno-55-3">3</a></span>
<span class="normal"><a href="#__codelineno-55-4">4</a></span>
<span class="normal"><a href="#__codelineno-55-5">5</a></span>
<span class="normal"><a href="#__codelineno-55-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1"></a>drop domain if exists d1_t;
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2"></a>create domain d1_t as int
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3"></a>default 42 constraint d1_t_chk check(value &gt;= 17);
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4"></a>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5"></a>drop domain if exists d2_t;
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6"></a>create domain d2_t as int[];
</span></code></pre></div></td></tr></table></div>
<p>很明显，“d1_t”的值，是int的一种特殊类型。但是“d2_t”的值呢？是一种特殊的数组？最重要的是，“d2_t”不符合任意数组的条件，相反，它符合任何元素的条件。此代码示例强调了这一点：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-56-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-56-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-56-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-56-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-56-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-56-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-56-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-56-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-56-10">10</a></span>
<span class="normal"><a href="#__codelineno-56-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1"></a>create or replace procedure p(i in anyelement)
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2"></a>  language plpgsql
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3"></a>as $body$
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4"></a>begin
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5"></a>  raise info &#39;%&#39;, pg_typeof(i);
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6"></a>end;
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7"></a>$body$;
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8"></a>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9"></a>call p(53::d1_t);
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10"></a>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11"></a>call p(&#39;{1, 2}&#39;::d2_t);
</span></code></pre></div></td></tr></table></div>
<p>第一个call，返回如下信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a>INFO:  d1_t
</span></code></pre></div></td></tr></table></div>
<p>第二个call，返回如下信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1"></a>INFO:  d2_t
</span></code></pre></div></td></tr></table></div>
<p>再次修改代码，用“int_arr_t”替换，相应地更改了“v1”到“v5”的值分配。同样，为了提高可读性，删除了一些测试。其余代码的其余部分与第一个示例中的对应代码相同。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-59-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-59-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-59-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-59-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-59-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-59-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-59-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-59-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-59-10">10</a></span>
<span class="normal"><a href="#__codelineno-59-11">11</a></span>
<span class="normal"><a href="#__codelineno-59-12">12</a></span>
<span class="normal"><a href="#__codelineno-59-13">13</a></span>
<span class="normal"><a href="#__codelineno-59-14">14</a></span>
<span class="normal"><a href="#__codelineno-59-15">15</a></span>
<span class="normal"><a href="#__codelineno-59-16">16</a></span>
<span class="normal"><a href="#__codelineno-59-17">17</a></span>
<span class="normal"><a href="#__codelineno-59-18">18</a></span>
<span class="normal"><a href="#__codelineno-59-19">19</a></span>
<span class="normal"><a href="#__codelineno-59-20">20</a></span>
<span class="normal"><a href="#__codelineno-59-21">21</a></span>
<span class="normal"><a href="#__codelineno-59-22">22</a></span>
<span class="normal"><a href="#__codelineno-59-23">23</a></span>
<span class="normal"><a href="#__codelineno-59-24">24</a></span>
<span class="normal"><a href="#__codelineno-59-25">25</a></span>
<span class="normal"><a href="#__codelineno-59-26">26</a></span>
<span class="normal"><a href="#__codelineno-59-27">27</a></span>
<span class="normal"><a href="#__codelineno-59-28">28</a></span>
<span class="normal"><a href="#__codelineno-59-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1"></a>drop domain if exists int_arr_t;
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2"></a>create domain int_arr_t as int[];
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3"></a>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4"></a>do $body$
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5"></a>declare
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6"></a>  v1 constant int_arr_t := array[1, 1];
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7"></a>  v2 constant int_arr_t := array[2, 3];
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8"></a>  v3 constant int_arr_t := array[4, 5];
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9"></a>  v4 constant int_arr_t := array[5, 7];
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10"></a>  v5 constant int_arr_t := array[8, 9];
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11"></a>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12"></a>  arr1 constant int_arr_t[] := array[v1, v1, v1, v1];
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13"></a>  arr2 constant int_arr_t[] := array[v1, v2, v3, v4];
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14"></a>  arr3 constant int_arr_t[] := array[v1, v1, v1, null::int_arr_t];
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15"></a>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16"></a>  b1 constant boolean not null :=     v1 = all (arr1);
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17"></a>  b2 constant boolean not null := not v1 = all (arr2);
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18"></a>  b3 constant boolean not null :=     v1 = any (arr2);
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19"></a>  b4 constant boolean not null := not v5 = any (arr2);
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20"></a>
</span><span id="__span-59-21"><a id="__codelineno-59-21" name="__codelineno-59-21"></a>  b5 constant boolean not null :=     v1 = any (arr3);
</span><span id="__span-59-22"><a id="__codelineno-59-22" name="__codelineno-59-22"></a>  b6 constant boolean not null :=    (v5 = any (arr3)) is null;
</span><span id="__span-59-23"><a id="__codelineno-59-23" name="__codelineno-59-23"></a>  b7 constant boolean not null :=    (v1 = all (arr3)) is null;
</span><span id="__span-59-24"><a id="__codelineno-59-24" name="__codelineno-59-24"></a>begin
</span><span id="__span-59-25"><a id="__codelineno-59-25" name="__codelineno-59-25"></a>  assert
</span><span id="__span-59-26"><a id="__codelineno-59-26" name="__codelineno-59-26"></a>    (b1 and b2 and b3 and b4 and b5 and b6 and b7),
</span><span id="__span-59-27"><a id="__codelineno-59-27" name="__codelineno-59-27"></a>  &#39;assert failed&#39;;
</span><span id="__span-59-28"><a id="__codelineno-59-28" name="__codelineno-59-28"></a>end;
</span><span id="__span-59-29"><a id="__codelineno-59-29" name="__codelineno-59-29"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>4）数组的元素彼此相同的测试
这个示例，展示了数组的元素是否彼此相同的测试，而不需要知道它们的值或数组维度的任何信息。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span>
<span class="normal"><a href="#__codelineno-60-15">15</a></span>
<span class="normal"><a href="#__codelineno-60-16">16</a></span>
<span class="normal"><a href="#__codelineno-60-17">17</a></span>
<span class="normal"><a href="#__codelineno-60-18">18</a></span>
<span class="normal"><a href="#__codelineno-60-19">19</a></span>
<span class="normal"><a href="#__codelineno-60-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a>do $body$
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2"></a>declare
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3"></a>  arr constant int[] not null := &#39;
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4"></a>    [2:3][4:6][7:10]={
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5"></a>      {
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6"></a>        {42,42,42,42},{42,42,42,42},{42,42,42,42}
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7"></a>      },
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8"></a>      {
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9"></a>        {42,42,42,42},{42,42,42,42},{42,42,42,42}
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10"></a>      }
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11"></a>    }&#39;::int[];
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12"></a>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13"></a>   val constant int not null := (
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14"></a>    select unnest(arr) limit 1);
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15"></a>
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16"></a>  b99 boolean not null := val = all (arr);
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17"></a>begin
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18"></a>  assert b99, &#39;assert failed&#39;;
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19"></a>end;
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>5）使用不等式的比较</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-61-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-61-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-61-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-61-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-61-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-61-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-61-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-61-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-61-10">10</a></span>
<span class="normal"><a href="#__codelineno-61-11">11</a></span>
<span class="normal"><a href="#__codelineno-61-12">12</a></span>
<span class="normal"><a href="#__codelineno-61-13">13</a></span>
<span class="normal"><a href="#__codelineno-61-14">14</a></span>
<span class="normal"><a href="#__codelineno-61-15">15</a></span>
<span class="normal"><a href="#__codelineno-61-16">16</a></span>
<span class="normal"><a href="#__codelineno-61-17">17</a></span>
<span class="normal"><a href="#__codelineno-61-18">18</a></span>
<span class="normal"><a href="#__codelineno-61-19">19</a></span>
<span class="normal"><a href="#__codelineno-61-20">20</a></span>
<span class="normal"><a href="#__codelineno-61-21">21</a></span>
<span class="normal"><a href="#__codelineno-61-22">22</a></span>
<span class="normal"><a href="#__codelineno-61-23">23</a></span>
<span class="normal"><a href="#__codelineno-61-24">24</a></span>
<span class="normal"><a href="#__codelineno-61-25">25</a></span>
<span class="normal"><a href="#__codelineno-61-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1"></a>do $body$
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2"></a>declare
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3"></a>  v1 constant int := 1;
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4"></a>  v2 constant int := 2;
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5"></a>  v3 constant int := 3;
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6"></a>  v4 constant int := 4;
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7"></a>  v5 constant int := 5;
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8"></a>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9"></a>  arr1 constant int[] := array[v1, v2, v3, v4];
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10"></a>
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11"></a>  b01 constant boolean not null := not (v5  = any (arr1));
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12"></a>  b02 constant boolean not null :=    v5 &lt;&gt; all (arr1);
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13"></a>  b03 constant boolean not null :=    v2  &gt; any (arr1);
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14"></a>  b04 constant boolean not null := not (v2  &gt; all (arr1));
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15"></a>  b05 constant boolean not null := not (v4  &lt; any (arr1));
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16"></a>  b06 constant boolean not null :=    v2  &lt; any (arr1);
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17"></a>  b07 constant boolean not null := not (v5 &lt;= any (arr1));
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18"></a>  b08 constant boolean not null :=    v4 &gt;= all (arr1);
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19"></a>  b09 constant boolean not null :=    v5  &gt; all (arr1);
</span><span id="__span-61-20"><a id="__codelineno-61-20" name="__codelineno-61-20"></a>
</span><span id="__span-61-21"><a id="__codelineno-61-21" name="__codelineno-61-21"></a>begin
</span><span id="__span-61-22"><a id="__codelineno-61-22" name="__codelineno-61-22"></a>  assert
</span><span id="__span-61-23"><a id="__codelineno-61-23" name="__codelineno-61-23"></a>    (b01 and b02 and b03 and b04 and b05 and b06 and b07 and b08 and b09),
</span><span id="__span-61-24"><a id="__codelineno-61-24" name="__codelineno-61-24"></a>  &#39;assert failed&#39;;
</span><span id="__span-61-25"><a id="__codelineno-61-25" name="__codelineno-61-25"></a>end;
</span><span id="__span-61-26"><a id="__codelineno-61-26" name="__codelineno-61-26"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h2 id="_7"><strong>比较运算符</strong><a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>运算符</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td></td>
<td>如果LHS和RHS数组相等，则返回TRUE。</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td></td>
<td>如果LHS和RHS数组不相等，则返回TRUE。</td>
</tr>
<tr>
<td>&gt;</td>
<td></td>
<td>如果LHS数组大于RHS数组，则返回TRUE。</td>
</tr>
<tr>
<td>&gt;=</td>
<td></td>
<td>如果LHS数组大于或等于RHS数组，则返回TRUE。</td>
</tr>
<tr>
<td>&lt;=</td>
<td></td>
<td>如果LHS数组小于或等于RHS数组，则返回TRUE。</td>
</tr>
<tr>
<td>&lt;</td>
<td></td>
<td>如果LHS数组小于RHS数组，则返回TRUE。</td>
</tr>
<tr>
<td>@&gt;</td>
<td></td>
<td>如果LHS数组包含RHS数组，也就是说，如果在LHS数组的不同值中找到RHS数组中的每个不同值，则返回TRUE。</td>
</tr>
<tr>
<td>&lt;@</td>
<td></td>
<td>如果RHS数组包含LHS数组，也就是说，如果在RHS数组的不同值中找到LHS数组中的每个不同值，则返回TRUE。</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td></td>
<td>如果LHS和RHS数组重叠，即如果它们至少有一个共同值，则返回TRUE</td>
</tr>
</tbody>
</table>
<h3 id="_8">概述<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>目的：每个比较运算符，根据LHS和RHS数组之间的特定比较测试的结果，返回TRUE或FALSE。</p>
<p>用法：这些操作符具有相同的用法</p>
<p>输入值:       anyarray, anyarray
返回值:      boolean</p>
<p>注意：这些运算符要求LHS和RHS数组具有相同的数据类型。这是标量比较的相同规则。然而，它们并不要求数组具有相同的几何属性。规则定义，属性中的一个，或多个之间的差异，并不意味着不允许进行比较。相反，LHS数组可能被认为小于，或大于RHS数组。因此，理解比较算法是至关重要的。</p>
<p>比较标准
这些是比较两个数组值的算法的独特特征：</p>
<ul>
<li>实际值，按行主顺序成对比较</li>
<li>基数</li>
<li>维度的数量</li>
<li>每个维度上的下界。</li>
</ul>
<p>在这些比较中有一个明确的优先次序。简单地说，首先进行值比较。然后，只有在没有检测到差异的情况下，才进行几何特性的比较。</p>
<p>值的成对比较
第一个比较测试，按行主顺序扫描每个LHS和RHS数组中的值，并进行成对比较。值得注意的是，当非null数组值，与null值成对比较时，非null值被认为小于null值。</p>
<h3 id="_9">示例<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>1）= 和 &lt;&gt;  操作符</p>
<ul>
<li>如果LHS和RHS数组相等，则 = 运算符返回TRUE。</li>
<li>如果LHS和RHS数组不相等，则 &lt;&gt; 运算符返回TRUE。 </li>
</ul>
<p>= 运算符的示例：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1">1</a></span>
<span class="normal"><a href="#__codelineno-62-2">2</a></span>
<span class="normal"><a href="#__codelineno-62-3">3</a></span>
<span class="normal"><a href="#__codelineno-62-4">4</a></span>
<span class="normal"><a href="#__codelineno-62-5">5</a></span>
<span class="normal"><a href="#__codelineno-62-6">6</a></span>
<span class="normal"><a href="#__codelineno-62-7">7</a></span>
<span class="normal"><a href="#__codelineno-62-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1"></a>with
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2"></a>  v as (
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3"></a>    select
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4"></a>      (select array[&#39;a&#39;, &#39;b&#39;, null, &#39;d&#39;]::text[]) as a1,
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5"></a>      (select      &#39;{a,   b,  null,  d}&#39;::text[]) as a2
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6"></a>  )
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7"></a>select (a1 = a2)::text as &quot;EQUALITY comparison result&quot;
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8"></a>from v;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1">1</a></span>
<span class="normal"><a href="#__codelineno-63-2">2</a></span>
<span class="normal"><a href="#__codelineno-63-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1"></a> EQUALITY comparison result
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2"></a>----------------------------
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3"></a> true
</span></code></pre></div></td></tr></table></div>
<p>&lt;&gt; 运算符的示例：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1">1</a></span>
<span class="normal"><a href="#__codelineno-64-2">2</a></span>
<span class="normal"><a href="#__codelineno-64-3">3</a></span>
<span class="normal"><a href="#__codelineno-64-4">4</a></span>
<span class="normal"><a href="#__codelineno-64-5">5</a></span>
<span class="normal"><a href="#__codelineno-64-6">6</a></span>
<span class="normal"><a href="#__codelineno-64-7">7</a></span>
<span class="normal"><a href="#__codelineno-64-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1"></a>with
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2"></a>  v as (
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3"></a>    select
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4"></a>      (select array[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;,  &#39;d&#39;]::text[]) as a1,
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5"></a>      (select      &#39;{a,   b,  null,  d}&#39;::text[]) as a2
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6"></a>  )
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7"></a>select (a1 &lt;&gt; a2)::text as &quot;INEQUALITY comparison result&quot;
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8"></a>from v;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span>
<span class="normal"><a href="#__codelineno-65-2">2</a></span>
<span class="normal"><a href="#__codelineno-65-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1"></a> INEQUALITY comparison result
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2"></a>------------------------------
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3"></a> true
</span></code></pre></div></td></tr></table></div>
<p>2） &gt; 与 &gt;= 与 &lt;= 与 &lt; 操作符
这四个运算符实现了常见的不等式比较 </p>
<ul>
<li>如果LHS数组大于RHS数组，则 &gt; 运算符返回TRUE。</li>
<li>如果LHS数组大于或等于RHS数组，则 &gt;= 运算符返回TRUE。</li>
<li>如果LHS数组小于或等于RHS数组，则 &lt;= 运算符返回TRUE。</li>
<li>如果LHS数组小于RHS数组，则 &lt; 运算符返回TRUE。
  下面仅仅给出 &lt; 运算符的示例：</li>
</ul>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-66-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-66-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-66-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-66-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-66-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-66-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-66-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-66-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-66-10">10</a></span>
<span class="normal"><a href="#__codelineno-66-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1"></a>with
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2"></a>  v as (
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3"></a>    select
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4"></a>      (select array[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;,  &#39;d&#39;]::text[]) as a1,
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5"></a>      (select array[&#39;a&#39;, &#39;b&#39;, &#39;e&#39;,  &#39;d&#39;]::text[]) as a2,
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6"></a>      (select      &#39;{a,   b,  null,  d}&#39;::text[]) as a3
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7"></a>  )
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8"></a>select
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9"></a>  (a1 &lt; a2)::text as &quot;&#39;LESS THAN&#39; comparison result 1&quot;,
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10"></a>  (a1 &lt; a3)::text as &quot;&#39;LESS THAN&#39; comparison result 2&quot;
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11"></a>from v;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1">1</a></span>
<span class="normal"><a href="#__codelineno-67-2">2</a></span>
<span class="normal"><a href="#__codelineno-67-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1"></a> &#39;LESS THAN&#39; comparison result 1 | &#39;LESS THAN&#39; comparison result 2
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2"></a>------------------------------------------+---------------------------------------------
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3"></a> true                         | true
</span></code></pre></div></td></tr></table></div>
<p>3） @&gt; 与 &lt;@ 操作符
如果LHS数组包含RHS数组，也就是说，如果RHS数组中的每个不同值都是在LHS数组的不同值中找到的，则 @&gt; 运算符返回TRUE；反之，则 &lt;@ 运算符返回TRUE。 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-68-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-68-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-68-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-68-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-68-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-68-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-68-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-68-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-68-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1"></a>with
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2"></a>  v as (
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3"></a>    select
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4"></a>      (select array[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;,  &#39;d&#39;]::text[]) as a1,
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5"></a>      (select array[&#39;a&#39;,      &#39;c&#39;      ]::text[]) as a2
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6"></a>  )
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7"></a>select
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8"></a>  (a1 @&gt; a2)::text as &quot;CONTAINS comparison result&quot;,
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9"></a>  (a2 &lt;@ a1)::text as &quot;&#39;IS CONTAINED BY&#39; comparison result&quot;
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10"></a>from v;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1">1</a></span>
<span class="normal"><a href="#__codelineno-69-2">2</a></span>
<span class="normal"><a href="#__codelineno-69-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1"></a> CONTAINS comparison result | &#39;IS CONTAINED BY&#39; comparison result
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2"></a>----------------------------------------+-------------------------------------------------
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3"></a> true                       | true
</span></code></pre></div></td></tr></table></div>
<p>4）&amp;&amp; 运算符
如果LHS和RHS数组至少有一个共同值，则 &amp;&amp; 运算符返回TRUE。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-70-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-70-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-70-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-70-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-70-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-70-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-70-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-70-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-70-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1"></a>with
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2"></a>  v as (
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3"></a>    select
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4"></a>      (select array[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;,  &#39;d&#39;]::text[]) as a1,
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5"></a>      (select array[&#39;d&#39;, &#39;e&#39;, &#39;f&#39;,  &#39;g&#39;]::text[]) as a2
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6"></a>  )
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7"></a>select
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8"></a>  (a1 &amp;&amp; a2)::text as &quot;&#39;a1 OVERLAPS a2&#39; comparison result&quot;,
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9"></a>  (a2 &amp;&amp; a1)::text as &quot;&#39;a2 OVERLAPS a1&#39; comparison result&quot;
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10"></a>from v;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1">1</a></span>
<span class="normal"><a href="#__codelineno-71-2">2</a></span>
<span class="normal"><a href="#__codelineno-71-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1"></a> &#39;a1 OVERLAPS a2&#39; comparison result | &#39;a2 OVERLAPS a1&#39; comparison result
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2"></a>------------------------------------------------+----------------------------------------------
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3"></a> true                            | true
</span></code></pre></div></td></tr></table></div>
<p>5）以下是两个完整的示例</p>
<p>示例1：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1">  1</a></span>
<span class="normal"><a href="#__codelineno-72-2">  2</a></span>
<span class="normal"><a href="#__codelineno-72-3">  3</a></span>
<span class="normal"><a href="#__codelineno-72-4">  4</a></span>
<span class="normal"><a href="#__codelineno-72-5">  5</a></span>
<span class="normal"><a href="#__codelineno-72-6">  6</a></span>
<span class="normal"><a href="#__codelineno-72-7">  7</a></span>
<span class="normal"><a href="#__codelineno-72-8">  8</a></span>
<span class="normal"><a href="#__codelineno-72-9">  9</a></span>
<span class="normal"><a href="#__codelineno-72-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-72-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-72-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-72-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-72-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-72-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-72-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-72-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-72-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-72-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-72-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-72-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-72-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-72-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-72-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-72-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-72-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-72-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-72-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-72-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-72-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-72-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-72-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-72-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-72-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-72-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-72-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-72-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-72-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-72-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-72-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-72-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-72-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-72-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-72-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-72-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-72-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-72-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-72-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-72-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-72-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-72-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-72-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-72-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-72-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-72-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-72-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-72-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-72-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-72-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-72-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-72-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-72-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-72-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-72-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-72-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-72-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-72-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-72-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-72-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-72-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-72-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-72-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-72-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-72-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-72-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-72-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-72-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-72-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-72-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-72-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-72-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-72-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-72-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-72-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-72-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-72-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-72-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-72-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-72-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-72-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-72-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-72-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-72-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-72-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-72-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-72-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-72-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-72-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-72-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-72-100">100</a></span>
<span class="normal"><a href="#__codelineno-72-101">101</a></span>
<span class="normal"><a href="#__codelineno-72-102">102</a></span>
<span class="normal"><a href="#__codelineno-72-103">103</a></span>
<span class="normal"><a href="#__codelineno-72-104">104</a></span>
<span class="normal"><a href="#__codelineno-72-105">105</a></span>
<span class="normal"><a href="#__codelineno-72-106">106</a></span>
<span class="normal"><a href="#__codelineno-72-107">107</a></span>
<span class="normal"><a href="#__codelineno-72-108">108</a></span>
<span class="normal"><a href="#__codelineno-72-109">109</a></span>
<span class="normal"><a href="#__codelineno-72-110">110</a></span>
<span class="normal"><a href="#__codelineno-72-111">111</a></span>
<span class="normal"><a href="#__codelineno-72-112">112</a></span>
<span class="normal"><a href="#__codelineno-72-113">113</a></span>
<span class="normal"><a href="#__codelineno-72-114">114</a></span>
<span class="normal"><a href="#__codelineno-72-115">115</a></span>
<span class="normal"><a href="#__codelineno-72-116">116</a></span>
<span class="normal"><a href="#__codelineno-72-117">117</a></span>
<span class="normal"><a href="#__codelineno-72-118">118</a></span>
<span class="normal"><a href="#__codelineno-72-119">119</a></span>
<span class="normal"><a href="#__codelineno-72-120">120</a></span>
<span class="normal"><a href="#__codelineno-72-121">121</a></span>
<span class="normal"><a href="#__codelineno-72-122">122</a></span>
<span class="normal"><a href="#__codelineno-72-123">123</a></span>
<span class="normal"><a href="#__codelineno-72-124">124</a></span>
<span class="normal"><a href="#__codelineno-72-125">125</a></span>
<span class="normal"><a href="#__codelineno-72-126">126</a></span>
<span class="normal"><a href="#__codelineno-72-127">127</a></span>
<span class="normal"><a href="#__codelineno-72-128">128</a></span>
<span class="normal"><a href="#__codelineno-72-129">129</a></span>
<span class="normal"><a href="#__codelineno-72-130">130</a></span>
<span class="normal"><a href="#__codelineno-72-131">131</a></span>
<span class="normal"><a href="#__codelineno-72-132">132</a></span>
<span class="normal"><a href="#__codelineno-72-133">133</a></span>
<span class="normal"><a href="#__codelineno-72-134">134</a></span>
<span class="normal"><a href="#__codelineno-72-135">135</a></span>
<span class="normal"><a href="#__codelineno-72-136">136</a></span>
<span class="normal"><a href="#__codelineno-72-137">137</a></span>
<span class="normal"><a href="#__codelineno-72-138">138</a></span>
<span class="normal"><a href="#__codelineno-72-139">139</a></span>
<span class="normal"><a href="#__codelineno-72-140">140</a></span>
<span class="normal"><a href="#__codelineno-72-141">141</a></span>
<span class="normal"><a href="#__codelineno-72-142">142</a></span>
<span class="normal"><a href="#__codelineno-72-143">143</a></span>
<span class="normal"><a href="#__codelineno-72-144">144</a></span>
<span class="normal"><a href="#__codelineno-72-145">145</a></span>
<span class="normal"><a href="#__codelineno-72-146">146</a></span>
<span class="normal"><a href="#__codelineno-72-147">147</a></span>
<span class="normal"><a href="#__codelineno-72-148">148</a></span>
<span class="normal"><a href="#__codelineno-72-149">149</a></span>
<span class="normal"><a href="#__codelineno-72-150">150</a></span>
<span class="normal"><a href="#__codelineno-72-151">151</a></span>
<span class="normal"><a href="#__codelineno-72-152">152</a></span>
<span class="normal"><a href="#__codelineno-72-153">153</a></span>
<span class="normal"><a href="#__codelineno-72-154">154</a></span>
<span class="normal"><a href="#__codelineno-72-155">155</a></span>
<span class="normal"><a href="#__codelineno-72-156">156</a></span>
<span class="normal"><a href="#__codelineno-72-157">157</a></span>
<span class="normal"><a href="#__codelineno-72-158">158</a></span>
<span class="normal"><a href="#__codelineno-72-159">159</a></span>
<span class="normal"><a href="#__codelineno-72-160">160</a></span>
<span class="normal"><a href="#__codelineno-72-161">161</a></span>
<span class="normal"><a href="#__codelineno-72-162">162</a></span>
<span class="normal"><a href="#__codelineno-72-163">163</a></span>
<span class="normal"><a href="#__codelineno-72-164">164</a></span>
<span class="normal"><a href="#__codelineno-72-165">165</a></span>
<span class="normal"><a href="#__codelineno-72-166">166</a></span>
<span class="normal"><a href="#__codelineno-72-167">167</a></span>
<span class="normal"><a href="#__codelineno-72-168">168</a></span>
<span class="normal"><a href="#__codelineno-72-169">169</a></span>
<span class="normal"><a href="#__codelineno-72-170">170</a></span>
<span class="normal"><a href="#__codelineno-72-171">171</a></span>
<span class="normal"><a href="#__codelineno-72-172">172</a></span>
<span class="normal"><a href="#__codelineno-72-173">173</a></span>
<span class="normal"><a href="#__codelineno-72-174">174</a></span>
<span class="normal"><a href="#__codelineno-72-175">175</a></span>
<span class="normal"><a href="#__codelineno-72-176">176</a></span>
<span class="normal"><a href="#__codelineno-72-177">177</a></span>
<span class="normal"><a href="#__codelineno-72-178">178</a></span>
<span class="normal"><a href="#__codelineno-72-179">179</a></span>
<span class="normal"><a href="#__codelineno-72-180">180</a></span>
<span class="normal"><a href="#__codelineno-72-181">181</a></span>
<span class="normal"><a href="#__codelineno-72-182">182</a></span>
<span class="normal"><a href="#__codelineno-72-183">183</a></span>
<span class="normal"><a href="#__codelineno-72-184">184</a></span>
<span class="normal"><a href="#__codelineno-72-185">185</a></span>
<span class="normal"><a href="#__codelineno-72-186">186</a></span>
<span class="normal"><a href="#__codelineno-72-187">187</a></span>
<span class="normal"><a href="#__codelineno-72-188">188</a></span>
<span class="normal"><a href="#__codelineno-72-189">189</a></span>
<span class="normal"><a href="#__codelineno-72-190">190</a></span>
<span class="normal"><a href="#__codelineno-72-191">191</a></span>
<span class="normal"><a href="#__codelineno-72-192">192</a></span>
<span class="normal"><a href="#__codelineno-72-193">193</a></span>
<span class="normal"><a href="#__codelineno-72-194">194</a></span>
<span class="normal"><a href="#__codelineno-72-195">195</a></span>
<span class="normal"><a href="#__codelineno-72-196">196</a></span>
<span class="normal"><a href="#__codelineno-72-197">197</a></span>
<span class="normal"><a href="#__codelineno-72-198">198</a></span>
<span class="normal"><a href="#__codelineno-72-199">199</a></span>
<span class="normal"><a href="#__codelineno-72-200">200</a></span>
<span class="normal"><a href="#__codelineno-72-201">201</a></span>
<span class="normal"><a href="#__codelineno-72-202">202</a></span>
<span class="normal"><a href="#__codelineno-72-203">203</a></span>
<span class="normal"><a href="#__codelineno-72-204">204</a></span>
<span class="normal"><a href="#__codelineno-72-205">205</a></span>
<span class="normal"><a href="#__codelineno-72-206">206</a></span>
<span class="normal"><a href="#__codelineno-72-207">207</a></span>
<span class="normal"><a href="#__codelineno-72-208">208</a></span>
<span class="normal"><a href="#__codelineno-72-209">209</a></span>
<span class="normal"><a href="#__codelineno-72-210">210</a></span>
<span class="normal"><a href="#__codelineno-72-211">211</a></span>
<span class="normal"><a href="#__codelineno-72-212">212</a></span>
<span class="normal"><a href="#__codelineno-72-213">213</a></span>
<span class="normal"><a href="#__codelineno-72-214">214</a></span>
<span class="normal"><a href="#__codelineno-72-215">215</a></span>
<span class="normal"><a href="#__codelineno-72-216">216</a></span>
<span class="normal"><a href="#__codelineno-72-217">217</a></span>
<span class="normal"><a href="#__codelineno-72-218">218</a></span>
<span class="normal"><a href="#__codelineno-72-219">219</a></span>
<span class="normal"><a href="#__codelineno-72-220">220</a></span>
<span class="normal"><a href="#__codelineno-72-221">221</a></span>
<span class="normal"><a href="#__codelineno-72-222">222</a></span>
<span class="normal"><a href="#__codelineno-72-223">223</a></span>
<span class="normal"><a href="#__codelineno-72-224">224</a></span>
<span class="normal"><a href="#__codelineno-72-225">225</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1"></a>-- Any two arrays can be compared without error if they have the same data type.
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2"></a>do $body$
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3"></a>begin
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5"></a>  -- Illustrate &quot;IS NOT DISTINCT FROM&quot; semantics.
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6"></a>  declare
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7"></a>    v1 constant int := 1;
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8"></a>    v2 constant int := 1;
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9"></a>    n1 constant int := null;
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10"></a>    n2 constant int := null;
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11"></a>  begin
</span><span id="__span-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12"></a>    assert
</span><span id="__span-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13"></a>      (v1 = v2)                    and
</span><span id="__span-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14"></a>      (v1 is not distinct from v2) and
</span><span id="__span-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15"></a>
</span><span id="__span-72-16"><a id="__codelineno-72-16" name="__codelineno-72-16"></a>      ((n1 = n2) is null)          and
</span><span id="__span-72-17"><a id="__codelineno-72-17" name="__codelineno-72-17"></a>      (n1 is not distinct from n2),
</span><span id="__span-72-18"><a id="__codelineno-72-18" name="__codelineno-72-18"></a>    &#39;unexpected&#39;;
</span><span id="__span-72-19"><a id="__codelineno-72-19" name="__codelineno-72-19"></a>  end;
</span><span id="__span-72-20"><a id="__codelineno-72-20" name="__codelineno-72-20"></a>
</span><span id="__span-72-21"><a id="__codelineno-72-21" name="__codelineno-72-21"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-22"><a id="__codelineno-72-22" name="__codelineno-72-22"></a>  -- Basic demonstration of equaliy when the geom. properties of
</span><span id="__span-72-23"><a id="__codelineno-72-23" name="__codelineno-72-23"></a>  -- the two arrays are identical.
</span><span id="__span-72-24"><a id="__codelineno-72-24" name="__codelineno-72-24"></a>  -- Shows that pairwise comparison uses &quot;IS NOT DISTINCT FROM&quot; semantics and NOT
</span><span id="__span-72-25"><a id="__codelineno-72-25" name="__codelineno-72-25"></a>  -- the conventional NULL semantics used when scalars are compared.
</span><span id="__span-72-26"><a id="__codelineno-72-26" name="__codelineno-72-26"></a>  declare
</span><span id="__span-72-27"><a id="__codelineno-72-27" name="__codelineno-72-27"></a>    a constant int[] := &#39;{10, null, 30}&#39;;
</span><span id="__span-72-28"><a id="__codelineno-72-28" name="__codelineno-72-28"></a>    b constant int[] := &#39;{10, null, 30}&#39;; -- Identical to a.
</span><span id="__span-72-29"><a id="__codelineno-72-29" name="__codelineno-72-29"></a>  begin
</span><span id="__span-72-30"><a id="__codelineno-72-30" name="__codelineno-72-30"></a>    assert
</span><span id="__span-72-31"><a id="__codelineno-72-31" name="__codelineno-72-31"></a>      (a = b),
</span><span id="__span-72-32"><a id="__codelineno-72-32" name="__codelineno-72-32"></a>    &#39;&quot;a = b&quot; assert failed&#39;;
</span><span id="__span-72-33"><a id="__codelineno-72-33" name="__codelineno-72-33"></a>
</span><span id="__span-72-34"><a id="__codelineno-72-34" name="__codelineno-72-34"></a>    -- Because of this, there&#39;s no need ever to write this.
</span><span id="__span-72-35"><a id="__codelineno-72-35" name="__codelineno-72-35"></a>    assert
</span><span id="__span-72-36"><a id="__codelineno-72-36" name="__codelineno-72-36"></a>      (a is not distinct from b),
</span><span id="__span-72-37"><a id="__codelineno-72-37" name="__codelineno-72-37"></a>    &#39;&quot;a is not distinct from b&quot; assert failed&#39;;
</span><span id="__span-72-38"><a id="__codelineno-72-38" name="__codelineno-72-38"></a>  end;
</span><span id="__span-72-39"><a id="__codelineno-72-39" name="__codelineno-72-39"></a>
</span><span id="__span-72-40"><a id="__codelineno-72-40" name="__codelineno-72-40"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-41"><a id="__codelineno-72-41" name="__codelineno-72-41"></a>  -- Basic demonstration of inequality when the geometric properties of
</span><span id="__span-72-42"><a id="__codelineno-72-42" name="__codelineno-72-42"></a>  -- the two arrays are identical.
</span><span id="__span-72-43"><a id="__codelineno-72-43" name="__codelineno-72-43"></a>  -- When the first difference is encountered in row-major order, the comparison
</span><span id="__span-72-44"><a id="__codelineno-72-44" name="__codelineno-72-44"></a>  -- is made. Other differences are irrelevant.
</span><span id="__span-72-45"><a id="__codelineno-72-45" name="__codelineno-72-45"></a>  declare
</span><span id="__span-72-46"><a id="__codelineno-72-46" name="__codelineno-72-46"></a>    a constant int[] := &#39;{10, 20, 30}&#39;;
</span><span id="__span-72-47"><a id="__codelineno-72-47" name="__codelineno-72-47"></a>    b constant int[] := &#39;{10, 19, 31}&#39;;
</span><span id="__span-72-48"><a id="__codelineno-72-48" name="__codelineno-72-48"></a>  begin
</span><span id="__span-72-49"><a id="__codelineno-72-49" name="__codelineno-72-49"></a>    assert
</span><span id="__span-72-50"><a id="__codelineno-72-50" name="__codelineno-72-50"></a>      (a &lt;&gt; b) and
</span><span id="__span-72-51"><a id="__codelineno-72-51" name="__codelineno-72-51"></a>      (a &gt;  b) and
</span><span id="__span-72-52"><a id="__codelineno-72-52" name="__codelineno-72-52"></a>      (a &gt;= b) and
</span><span id="__span-72-53"><a id="__codelineno-72-53" name="__codelineno-72-53"></a>      (b &lt;= a) and
</span><span id="__span-72-54"><a id="__codelineno-72-54" name="__codelineno-72-54"></a>      (b &lt;  a) ,
</span><span id="__span-72-55"><a id="__codelineno-72-55" name="__codelineno-72-55"></a>    &#39;&quot;a &gt; b&quot; assert failed&#39;;
</span><span id="__span-72-56"><a id="__codelineno-72-56" name="__codelineno-72-56"></a>  end;
</span><span id="__span-72-57"><a id="__codelineno-72-57" name="__codelineno-72-57"></a>
</span><span id="__span-72-58"><a id="__codelineno-72-58" name="__codelineno-72-58"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-59"><a id="__codelineno-72-59" name="__codelineno-72-59"></a>  -- Demonstration of inequality when the geometric properties of
</span><span id="__span-72-60"><a id="__codelineno-72-60" name="__codelineno-72-60"></a>  -- the two arrays are identical.
</span><span id="__span-72-61"><a id="__codelineno-72-61" name="__codelineno-72-61"></a>  -- Here, the first pairwise difference is NOT NULL versus NULL.
</span><span id="__span-72-62"><a id="__codelineno-72-62" name="__codelineno-72-62"></a>  declare
</span><span id="__span-72-63"><a id="__codelineno-72-63" name="__codelineno-72-63"></a>    a constant int[] := &#39;{10, 20,   30}&#39;;
</span><span id="__span-72-64"><a id="__codelineno-72-64" name="__codelineno-72-64"></a>    b constant int[] := &#39;{10, null, 29}&#39;;
</span><span id="__span-72-65"><a id="__codelineno-72-65" name="__codelineno-72-65"></a>  begin
</span><span id="__span-72-66"><a id="__codelineno-72-66" name="__codelineno-72-66"></a>    -- Bizarrely, a NOT NULL value counts as LESS THAN a NULL value in the
</span><span id="__span-72-67"><a id="__codelineno-72-67" name="__codelineno-72-67"></a>    -- pairwise comparison.
</span><span id="__span-72-68"><a id="__codelineno-72-68" name="__codelineno-72-68"></a>    assert
</span><span id="__span-72-69"><a id="__codelineno-72-69" name="__codelineno-72-69"></a>      (a &lt;&gt; b) and
</span><span id="__span-72-70"><a id="__codelineno-72-70" name="__codelineno-72-70"></a>      (a &lt;  b),
</span><span id="__span-72-71"><a id="__codelineno-72-71" name="__codelineno-72-71"></a>    &#39;&quot;a &lt; b&quot; assert failed&#39;;
</span><span id="__span-72-72"><a id="__codelineno-72-72" name="__codelineno-72-72"></a>
</span><span id="__span-72-73"><a id="__codelineno-72-73" name="__codelineno-72-73"></a>    -- Again, because of this, there&#39;s no need ever to write this.
</span><span id="__span-72-74"><a id="__codelineno-72-74" name="__codelineno-72-74"></a>    assert
</span><span id="__span-72-75"><a id="__codelineno-72-75" name="__codelineno-72-75"></a>      (a is distinct from b) ,
</span><span id="__span-72-76"><a id="__codelineno-72-76" name="__codelineno-72-76"></a>    &#39;&quot;a is distinct from b&quot; assert failed&#39;;
</span><span id="__span-72-77"><a id="__codelineno-72-77" name="__codelineno-72-77"></a>  end;
</span><span id="__span-72-78"><a id="__codelineno-72-78" name="__codelineno-72-78"></a>
</span><span id="__span-72-79"><a id="__codelineno-72-79" name="__codelineno-72-79"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-80"><a id="__codelineno-72-80" name="__codelineno-72-80"></a>  -- Extreme demonstration of priority.
</span><span id="__span-72-81"><a id="__codelineno-72-81" name="__codelineno-72-81"></a>  -- c has just a single value and d has several.
</span><span id="__span-72-82"><a id="__codelineno-72-82" name="__codelineno-72-82"></a>  -- c has one dimension and d has two.
</span><span id="__span-72-83"><a id="__codelineno-72-83" name="__codelineno-72-83"></a>  -- c&#39;s first lower bound is less than d&#39;s first lower.
</span><span id="__span-72-84"><a id="__codelineno-72-84" name="__codelineno-72-84"></a>  -- d&#39;s second lower bound is greater than one, but is presumably irrelevant.
</span><span id="__span-72-85"><a id="__codelineno-72-85" name="__codelineno-72-85"></a>  -- But c&#39;s first value is GREATER THAN d&#39;s first value,
</span><span id="__span-72-86"><a id="__codelineno-72-86" name="__codelineno-72-86"></a>  -- scanning in row-major order.
</span><span id="__span-72-87"><a id="__codelineno-72-87" name="__codelineno-72-87"></a>  --
</span><span id="__span-72-88"><a id="__codelineno-72-88" name="__codelineno-72-88"></a>  -- Pairwise value comparison has the hoghest priority.
</span><span id="__span-72-89"><a id="__codelineno-72-89" name="__codelineno-72-89"></a>  -- therefore c is deemed to be GREATER THAN d.
</span><span id="__span-72-90"><a id="__codelineno-72-90" name="__codelineno-72-90"></a>
</span><span id="__span-72-91"><a id="__codelineno-72-91" name="__codelineno-72-91"></a>  declare
</span><span id="__span-72-92"><a id="__codelineno-72-92" name="__codelineno-72-92"></a>    c constant int[] := &#39;{2}&#39;;
</span><span id="__span-72-93"><a id="__codelineno-72-93" name="__codelineno-72-93"></a>
</span><span id="__span-72-94"><a id="__codelineno-72-94" name="__codelineno-72-94"></a>    -- Notice that d&#39;s first value is at [2][3].
</span><span id="__span-72-95"><a id="__codelineno-72-95" name="__codelineno-72-95"></a>    d constant int[] := &#39;[2:3][3:4]={{1, 2}, {3, 3}}&#39;;
</span><span id="__span-72-96"><a id="__codelineno-72-96" name="__codelineno-72-96"></a>
</span><span id="__span-72-97"><a id="__codelineno-72-97" name="__codelineno-72-97"></a>  begin
</span><span id="__span-72-98"><a id="__codelineno-72-98" name="__codelineno-72-98"></a>    assert
</span><span id="__span-72-99"><a id="__codelineno-72-99" name="__codelineno-72-99"></a>      cardinality(c) &lt; cardinality(d),
</span><span id="__span-72-100"><a id="__codelineno-72-100" name="__codelineno-72-100"></a>    &#39;&quot;cardinality(c) &lt; cardinality(d)&quot; assert failed&#39;;
</span><span id="__span-72-101"><a id="__codelineno-72-101" name="__codelineno-72-101"></a>
</span><span id="__span-72-102"><a id="__codelineno-72-102" name="__codelineno-72-102"></a>    assert
</span><span id="__span-72-103"><a id="__codelineno-72-103" name="__codelineno-72-103"></a>      array_ndims(c) &lt; array_ndims(d),
</span><span id="__span-72-104"><a id="__codelineno-72-104" name="__codelineno-72-104"></a>    &#39;&quot;ndims(c) &lt; ndims(d)&quot; assert failed&#39;;
</span><span id="__span-72-105"><a id="__codelineno-72-105" name="__codelineno-72-105"></a>    assert
</span><span id="__span-72-106"><a id="__codelineno-72-106" name="__codelineno-72-106"></a>      array_lower(c, 1) &lt; array_lower(d, 1),
</span><span id="__span-72-107"><a id="__codelineno-72-107" name="__codelineno-72-107"></a>    &#39;&quot;lower(c, 1) &lt; lower(d, 1)&quot; assert failed&#39;;
</span><span id="__span-72-108"><a id="__codelineno-72-108" name="__codelineno-72-108"></a>
</span><span id="__span-72-109"><a id="__codelineno-72-109" name="__codelineno-72-109"></a>    assert
</span><span id="__span-72-110"><a id="__codelineno-72-110" name="__codelineno-72-110"></a>      c[1] &gt; d[2][3],
</span><span id="__span-72-111"><a id="__codelineno-72-111" name="__codelineno-72-111"></a>    &#39;&quot;c[1] &gt; d[2][3]&quot; assert failed&#39;;
</span><span id="__span-72-112"><a id="__codelineno-72-112" name="__codelineno-72-112"></a>
</span><span id="__span-72-113"><a id="__codelineno-72-113" name="__codelineno-72-113"></a>   assert
</span><span id="__span-72-114"><a id="__codelineno-72-114" name="__codelineno-72-114"></a>     c &gt; d,
</span><span id="__span-72-115"><a id="__codelineno-72-115" name="__codelineno-72-115"></a>   &#39;&quot;c &gt; d&quot; assert failed&#39;;
</span><span id="__span-72-116"><a id="__codelineno-72-116" name="__codelineno-72-116"></a>  end;
</span><span id="__span-72-117"><a id="__codelineno-72-117" name="__codelineno-72-117"></a>
</span><span id="__span-72-118"><a id="__codelineno-72-118" name="__codelineno-72-118"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-119"><a id="__codelineno-72-119" name="__codelineno-72-119"></a>  -- Pairwise comparison is equal are far as it is feasible.
</span><span id="__span-72-120"><a id="__codelineno-72-120" name="__codelineno-72-120"></a>  -- e&#39;s ndims &lt; f&#39;s.
</span><span id="__span-72-121"><a id="__codelineno-72-121" name="__codelineno-72-121"></a>  -- e&#39;s lb-1 &lt; f&#39;s.
</span><span id="__span-72-122"><a id="__codelineno-72-122" name="__codelineno-72-122"></a>  -- BUT e&#39;s cardinality &gt; f&#39;s.
</span><span id="__span-72-123"><a id="__codelineno-72-123" name="__codelineno-72-123"></a>  -- Cardinality has highest priority among the geom. propoerties,
</span><span id="__span-72-124"><a id="__codelineno-72-124" name="__codelineno-72-124"></a>  -- so e is deemed to be GREATER THAN f.
</span><span id="__span-72-125"><a id="__codelineno-72-125" name="__codelineno-72-125"></a>  declare
</span><span id="__span-72-126"><a id="__codelineno-72-126" name="__codelineno-72-126"></a>    e constant int[] := &#39;{10, 20, 30, 40, 50, 60, 70}&#39;;
</span><span id="__span-72-127"><a id="__codelineno-72-127" name="__codelineno-72-127"></a>    f constant int[] := &#39;[2:3][3:5]={{10, 20, 30}, {40, 50, 60}}&#39;;
</span><span id="__span-72-128"><a id="__codelineno-72-128" name="__codelineno-72-128"></a>  begin
</span><span id="__span-72-129"><a id="__codelineno-72-129" name="__codelineno-72-129"></a>    assert
</span><span id="__span-72-130"><a id="__codelineno-72-130" name="__codelineno-72-130"></a>      e[1] = f[2][3] and
</span><span id="__span-72-131"><a id="__codelineno-72-131" name="__codelineno-72-131"></a>      e[2] = f[2][4] and
</span><span id="__span-72-132"><a id="__codelineno-72-132" name="__codelineno-72-132"></a>      e[3] = f[2][5] and
</span><span id="__span-72-133"><a id="__codelineno-72-133" name="__codelineno-72-133"></a>      e[4] = f[3][3] and
</span><span id="__span-72-134"><a id="__codelineno-72-134" name="__codelineno-72-134"></a>      e[5] = f[3][4] and
</span><span id="__span-72-135"><a id="__codelineno-72-135" name="__codelineno-72-135"></a>      e[6] = f[3][5] ,
</span><span id="__span-72-136"><a id="__codelineno-72-136" name="__codelineno-72-136"></a>    &#39;&quot;e-to-f&quot; eqality test, as far as feasible, assert failed&#39;;
</span><span id="__span-72-137"><a id="__codelineno-72-137" name="__codelineno-72-137"></a>
</span><span id="__span-72-138"><a id="__codelineno-72-138" name="__codelineno-72-138"></a>    assert
</span><span id="__span-72-139"><a id="__codelineno-72-139" name="__codelineno-72-139"></a>      array_ndims(e) &lt; array_ndims(f),
</span><span id="__span-72-140"><a id="__codelineno-72-140" name="__codelineno-72-140"></a>    &#39;&quot;ndims(e) &lt; ndims(f)&quot; assert failed&#39;;
</span><span id="__span-72-141"><a id="__codelineno-72-141" name="__codelineno-72-141"></a>
</span><span id="__span-72-142"><a id="__codelineno-72-142" name="__codelineno-72-142"></a>    assert
</span><span id="__span-72-143"><a id="__codelineno-72-143" name="__codelineno-72-143"></a>      array_lower(e, 1) &lt; array_lower(f, 1),
</span><span id="__span-72-144"><a id="__codelineno-72-144" name="__codelineno-72-144"></a>    &#39;&quot;lower(e, 1) &lt; lower(f, 1)&quot; assert failed&#39;;
</span><span id="__span-72-145"><a id="__codelineno-72-145" name="__codelineno-72-145"></a>
</span><span id="__span-72-146"><a id="__codelineno-72-146" name="__codelineno-72-146"></a>    assert
</span><span id="__span-72-147"><a id="__codelineno-72-147" name="__codelineno-72-147"></a>      cardinality(e) &gt; cardinality(f),
</span><span id="__span-72-148"><a id="__codelineno-72-148" name="__codelineno-72-148"></a>    &#39;&quot;cardinality(e) &gt; cardinality(f)&quot; assert failed&#39;;
</span><span id="__span-72-149"><a id="__codelineno-72-149" name="__codelineno-72-149"></a>
</span><span id="__span-72-150"><a id="__codelineno-72-150" name="__codelineno-72-150"></a>    assert
</span><span id="__span-72-151"><a id="__codelineno-72-151" name="__codelineno-72-151"></a>      (e &gt; f) ,
</span><span id="__span-72-152"><a id="__codelineno-72-152" name="__codelineno-72-152"></a>    &#39;e &gt; f assert failed&#39;;
</span><span id="__span-72-153"><a id="__codelineno-72-153" name="__codelineno-72-153"></a>  end;
</span><span id="__span-72-154"><a id="__codelineno-72-154" name="__codelineno-72-154"></a>
</span><span id="__span-72-155"><a id="__codelineno-72-155" name="__codelineno-72-155"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-156"><a id="__codelineno-72-156" name="__codelineno-72-156"></a>  -- g&#39;s cardinality = h&#39;s.
</span><span id="__span-72-157"><a id="__codelineno-72-157" name="__codelineno-72-157"></a>  -- So pairwise comparison is feasible for all values, and is equal.
</span><span id="__span-72-158"><a id="__codelineno-72-158" name="__codelineno-72-158"></a>  -- g&#39;s ndims &gt; h&#39;s.
</span><span id="__span-72-159"><a id="__codelineno-72-159" name="__codelineno-72-159"></a>  -- g&#39;s lb-1 &lt; h&#39;s.
</span><span id="__span-72-160"><a id="__codelineno-72-160" name="__codelineno-72-160"></a>  -- Ndims has higher priority among ndims and lower bounds,
</span><span id="__span-72-161"><a id="__codelineno-72-161" name="__codelineno-72-161"></a>  -- so g is deemed to be GREATER THAN h.
</span><span id="__span-72-162"><a id="__codelineno-72-162" name="__codelineno-72-162"></a>  declare
</span><span id="__span-72-163"><a id="__codelineno-72-163" name="__codelineno-72-163"></a>    g constant int[] := &#39;{{10, 20, 30}, {40, 50, 60}}&#39;;
</span><span id="__span-72-164"><a id="__codelineno-72-164" name="__codelineno-72-164"></a>    h constant int[] := &#39;[2:7]={10, 20, 30, 40, 50, 60}&#39;;
</span><span id="__span-72-165"><a id="__codelineno-72-165" name="__codelineno-72-165"></a>  begin
</span><span id="__span-72-166"><a id="__codelineno-72-166" name="__codelineno-72-166"></a>    assert
</span><span id="__span-72-167"><a id="__codelineno-72-167" name="__codelineno-72-167"></a>      cardinality(g) = cardinality(h),
</span><span id="__span-72-168"><a id="__codelineno-72-168" name="__codelineno-72-168"></a>    &#39;&quot;cardinality(g) = cardinality(h)&quot; assert failed&#39;;
</span><span id="__span-72-169"><a id="__codelineno-72-169" name="__codelineno-72-169"></a>
</span><span id="__span-72-170"><a id="__codelineno-72-170" name="__codelineno-72-170"></a>    assert
</span><span id="__span-72-171"><a id="__codelineno-72-171" name="__codelineno-72-171"></a>      g[1][1] = h[2] and
</span><span id="__span-72-172"><a id="__codelineno-72-172" name="__codelineno-72-172"></a>      g[1][2] = h[3] and
</span><span id="__span-72-173"><a id="__codelineno-72-173" name="__codelineno-72-173"></a>      g[1][3] = h[4] and
</span><span id="__span-72-174"><a id="__codelineno-72-174" name="__codelineno-72-174"></a>      g[2][1] = h[5] and
</span><span id="__span-72-175"><a id="__codelineno-72-175" name="__codelineno-72-175"></a>      g[2][2] = h[6] and
</span><span id="__span-72-176"><a id="__codelineno-72-176" name="__codelineno-72-176"></a>      g[2][3] = h[7] ,
</span><span id="__span-72-177"><a id="__codelineno-72-177" name="__codelineno-72-177"></a>    &#39;&quot;g-to-h&quot; eqality test assert failed&#39;;
</span><span id="__span-72-178"><a id="__codelineno-72-178" name="__codelineno-72-178"></a>
</span><span id="__span-72-179"><a id="__codelineno-72-179" name="__codelineno-72-179"></a>    assert
</span><span id="__span-72-180"><a id="__codelineno-72-180" name="__codelineno-72-180"></a>      array_ndims(g) &gt; array_ndims(h),
</span><span id="__span-72-181"><a id="__codelineno-72-181" name="__codelineno-72-181"></a>    &#39;&quot;ndims(g) &gt; ndims(h)&quot; assert failed&#39;;
</span><span id="__span-72-182"><a id="__codelineno-72-182" name="__codelineno-72-182"></a>
</span><span id="__span-72-183"><a id="__codelineno-72-183" name="__codelineno-72-183"></a>    assert
</span><span id="__span-72-184"><a id="__codelineno-72-184" name="__codelineno-72-184"></a>      array_lower(g, 1) &lt; array_lower(h, 1),
</span><span id="__span-72-185"><a id="__codelineno-72-185" name="__codelineno-72-185"></a>    &#39;&quot;lower(g, 1) &lt; lower(h, 1)&quot; assert failed&#39;;
</span><span id="__span-72-186"><a id="__codelineno-72-186" name="__codelineno-72-186"></a>
</span><span id="__span-72-187"><a id="__codelineno-72-187" name="__codelineno-72-187"></a>    assert
</span><span id="__span-72-188"><a id="__codelineno-72-188" name="__codelineno-72-188"></a>      (g &gt; h) ,
</span><span id="__span-72-189"><a id="__codelineno-72-189" name="__codelineno-72-189"></a>    &#39;&quot;g &gt; h&quot; assert failed&#39;;
</span><span id="__span-72-190"><a id="__codelineno-72-190" name="__codelineno-72-190"></a>  end;
</span><span id="__span-72-191"><a id="__codelineno-72-191" name="__codelineno-72-191"></a>
</span><span id="__span-72-192"><a id="__codelineno-72-192" name="__codelineno-72-192"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-193"><a id="__codelineno-72-193" name="__codelineno-72-193"></a>  declare
</span><span id="__span-72-194"><a id="__codelineno-72-194" name="__codelineno-72-194"></a>    i constant int[] := &#39;[5:6][4:6]={{10, 20, 30}, {40, 50, 60}}&#39;;
</span><span id="__span-72-195"><a id="__codelineno-72-195" name="__codelineno-72-195"></a>    j constant int[] := &#39;[3:4][6:8]={{10, 20, 30}, {40, 50, 60}}&#39;;
</span><span id="__span-72-196"><a id="__codelineno-72-196" name="__codelineno-72-196"></a>  begin
</span><span id="__span-72-197"><a id="__codelineno-72-197" name="__codelineno-72-197"></a>    assert
</span><span id="__span-72-198"><a id="__codelineno-72-198" name="__codelineno-72-198"></a>      cardinality(i) = cardinality(j),
</span><span id="__span-72-199"><a id="__codelineno-72-199" name="__codelineno-72-199"></a>    &#39;&quot;cardinality(i) = cardinality(j)&quot; assert failed&#39;;
</span><span id="__span-72-200"><a id="__codelineno-72-200" name="__codelineno-72-200"></a>
</span><span id="__span-72-201"><a id="__codelineno-72-201" name="__codelineno-72-201"></a>    assert
</span><span id="__span-72-202"><a id="__codelineno-72-202" name="__codelineno-72-202"></a>      i[5][4] = j[3][6] and
</span><span id="__span-72-203"><a id="__codelineno-72-203" name="__codelineno-72-203"></a>      i[5][5] = j[3][7] and
</span><span id="__span-72-204"><a id="__codelineno-72-204" name="__codelineno-72-204"></a>      i[5][6] = j[3][8] and
</span><span id="__span-72-205"><a id="__codelineno-72-205" name="__codelineno-72-205"></a>      i[6][4] = j[4][6] and
</span><span id="__span-72-206"><a id="__codelineno-72-206" name="__codelineno-72-206"></a>      i[6][5] = j[4][7] and
</span><span id="__span-72-207"><a id="__codelineno-72-207" name="__codelineno-72-207"></a>      i[6][6] = j[4][8] ,
</span><span id="__span-72-208"><a id="__codelineno-72-208" name="__codelineno-72-208"></a>    &#39;&quot;i-to-j&quot; eqality test assert failed&#39;;
</span><span id="__span-72-209"><a id="__codelineno-72-209" name="__codelineno-72-209"></a>
</span><span id="__span-72-210"><a id="__codelineno-72-210" name="__codelineno-72-210"></a>    assert
</span><span id="__span-72-211"><a id="__codelineno-72-211" name="__codelineno-72-211"></a>      array_ndims(i) = array_ndims(j),
</span><span id="__span-72-212"><a id="__codelineno-72-212" name="__codelineno-72-212"></a>    &#39;&quot;ndims(i) = ndims(j)&quot; assert failed&#39;;
</span><span id="__span-72-213"><a id="__codelineno-72-213" name="__codelineno-72-213"></a>
</span><span id="__span-72-214"><a id="__codelineno-72-214" name="__codelineno-72-214"></a>    assert
</span><span id="__span-72-215"><a id="__codelineno-72-215" name="__codelineno-72-215"></a>      array_lower(i, 1) &gt; array_lower(j, 1),
</span><span id="__span-72-216"><a id="__codelineno-72-216" name="__codelineno-72-216"></a>    &#39;&quot;lower(i, 1) &gt; lower(j, 1)&quot; assert failed&#39;;
</span><span id="__span-72-217"><a id="__codelineno-72-217" name="__codelineno-72-217"></a>
</span><span id="__span-72-218"><a id="__codelineno-72-218" name="__codelineno-72-218"></a>    assert
</span><span id="__span-72-219"><a id="__codelineno-72-219" name="__codelineno-72-219"></a>      (i &gt; j) ,
</span><span id="__span-72-220"><a id="__codelineno-72-220" name="__codelineno-72-220"></a>    &#39;&quot;i &gt; j&quot; assert failed&#39;;
</span><span id="__span-72-221"><a id="__codelineno-72-221" name="__codelineno-72-221"></a>  end;
</span><span id="__span-72-222"><a id="__codelineno-72-222" name="__codelineno-72-222"></a>
</span><span id="__span-72-223"><a id="__codelineno-72-223" name="__codelineno-72-223"></a>  ------------------------------------------------------------------------------
</span><span id="__span-72-224"><a id="__codelineno-72-224" name="__codelineno-72-224"></a>end;
</span><span id="__span-72-225"><a id="__codelineno-72-225" name="__codelineno-72-225"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>示例2：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-73-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-73-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-73-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-73-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-73-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-73-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-73-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-73-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-73-10">10</a></span>
<span class="normal"><a href="#__codelineno-73-11">11</a></span>
<span class="normal"><a href="#__codelineno-73-12">12</a></span>
<span class="normal"><a href="#__codelineno-73-13">13</a></span>
<span class="normal"><a href="#__codelineno-73-14">14</a></span>
<span class="normal"><a href="#__codelineno-73-15">15</a></span>
<span class="normal"><a href="#__codelineno-73-16">16</a></span>
<span class="normal"><a href="#__codelineno-73-17">17</a></span>
<span class="normal"><a href="#__codelineno-73-18">18</a></span>
<span class="normal"><a href="#__codelineno-73-19">19</a></span>
<span class="normal"><a href="#__codelineno-73-20">20</a></span>
<span class="normal"><a href="#__codelineno-73-21">21</a></span>
<span class="normal"><a href="#__codelineno-73-22">22</a></span>
<span class="normal"><a href="#__codelineno-73-23">23</a></span>
<span class="normal"><a href="#__codelineno-73-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1"></a>-- Any two arrays can be compared without error if they have the same data type.
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2"></a>-- Insensitive to the geometric properties.
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3"></a>do $body$
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4"></a>declare
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5"></a>  a constant int[] := &#39;[2:3][4:5]={{10, 20}, {30, 40}}&#39;;
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6"></a>  b constant int[] := &#39;[5:6]={20, 30}&#39;;
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7"></a>  c constant int[] := &#39;[6:9]={40, 50, 70, 70}&#39;;
</span><span id="__span-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8"></a>  d constant int[] := &#39;[2:4]={50, 60, 70}&#39;;
</span><span id="__span-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9"></a>begin
</span><span id="__span-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10"></a>  assert
</span><span id="__span-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11"></a>    -- Containment
</span><span id="__span-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12"></a>    (b @&gt; b) and
</span><span id="__span-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13"></a>    (b &lt;@ a) and
</span><span id="__span-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14"></a>
</span><span id="__span-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15"></a>    -- Overlap.
</span><span id="__span-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16"></a>    -- The definition of the semantics makes the LHS, RHS order immaterial.
</span><span id="__span-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17"></a>    (a &amp;&amp; c) and
</span><span id="__span-73-18"><a id="__codelineno-73-18" name="__codelineno-73-18"></a>    (c &amp;&amp; a) and
</span><span id="__span-73-19"><a id="__codelineno-73-19" name="__codelineno-73-19"></a>
</span><span id="__span-73-20"><a id="__codelineno-73-20" name="__codelineno-73-20"></a>    -- a and d have NO values in common.
</span><span id="__span-73-21"><a id="__codelineno-73-21" name="__codelineno-73-21"></a>    not (a &amp;&amp; d),
</span><span id="__span-73-22"><a id="__codelineno-73-22" name="__codelineno-73-22"></a>  &#39;unexpected&#39;;
</span><span id="__span-73-23"><a id="__codelineno-73-23" name="__codelineno-73-23"></a>end;
</span><span id="__span-73-24"><a id="__codelineno-73-24" name="__codelineno-73-24"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h2 id="_10"><strong>切片运算符</strong><a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>运算符</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_slice运算符">[lb1:ub1]...[lbN:ubN]</a></td>
<td></td>
<td>返回一个新数组，其长度是通过沿每个维度指定切片的下界和上界来定义的。这些指定的切片边界不能超过源数组的边界。新数组具有与源数组相同的维度，并且在每个轴上其下界为1。</td>
</tr>
</tbody>
</table>
<h3 id="slice">slice运算符<a class="headerlink" href="#slice" title="Permanent link">&para;</a></h3>
<p>目的：返回一个新数组，其长度是通过指定切片沿每个维度的下限和上限来定义的。 </p>
<p>语法：
输入值:       [lb_1:ub_1] ... [lb_N:ub_N]anyarray
返回值:      anyarray
注意：</p>
<ul>
<li>必须为输入数组的N个维度中的每一个指定切片的下限和上限作为int值。</li>
<li>指定的切片边界不能超过源数组的边界。</li>
<li>新数组具有与源数组相同的维度，并且其下界在每个轴上为1。 </li>
</ul>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-74-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-74-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-74-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-74-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-74-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-74-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-74-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-74-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-74-10">10</a></span>
<span class="normal"><a href="#__codelineno-74-11">11</a></span>
<span class="normal"><a href="#__codelineno-74-12">12</a></span>
<span class="normal"><a href="#__codelineno-74-13">13</a></span>
<span class="normal"><a href="#__codelineno-74-14">14</a></span>
<span class="normal"><a href="#__codelineno-74-15">15</a></span>
<span class="normal"><a href="#__codelineno-74-16">16</a></span>
<span class="normal"><a href="#__codelineno-74-17">17</a></span>
<span class="normal"><a href="#__codelineno-74-18">18</a></span>
<span class="normal"><a href="#__codelineno-74-19">19</a></span>
<span class="normal"><a href="#__codelineno-74-20">20</a></span>
<span class="normal"><a href="#__codelineno-74-21">21</a></span>
<span class="normal"><a href="#__codelineno-74-22">22</a></span>
<span class="normal"><a href="#__codelineno-74-23">23</a></span>
<span class="normal"><a href="#__codelineno-74-24">24</a></span>
<span class="normal"><a href="#__codelineno-74-25">25</a></span>
<span class="normal"><a href="#__codelineno-74-26">26</a></span>
<span class="normal"><a href="#__codelineno-74-27">27</a></span>
<span class="normal"><a href="#__codelineno-74-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1"></a>create table t(k int primary key, arr text[]);
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2"></a>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3"></a>insert into t(k, arr)
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4"></a>values (1, &#39;
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5"></a>  [2:4][3:6][4:5]=
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6"></a>  {
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7"></a>    {
</span><span id="__span-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8"></a>      {a,b}, {c,d}, {e,f}, {g,h}
</span><span id="__span-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9"></a>    },
</span><span id="__span-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10"></a>    {
</span><span id="__span-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11"></a>      {i,j}, {k,l}, {m,n}, {o,p}
</span><span id="__span-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12"></a>    },
</span><span id="__span-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13"></a>    {
</span><span id="__span-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14"></a>      {q,r}, {s,t}, {u,v}, {w,x}
</span><span id="__span-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15"></a>    }
</span><span id="__span-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16"></a>  }
</span><span id="__span-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17"></a>  &#39;::text[]);
</span><span id="__span-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18"></a>
</span><span id="__span-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19"></a>select arr as &quot;old value of arr&quot; from t where k = 1;
</span><span id="__span-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20"></a>
</span><span id="__span-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21"></a>select
</span><span id="__span-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22"></a>  array_lower(arr, 1) as &quot;lb-1&quot;,
</span><span id="__span-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23"></a>  array_upper(arr, 1) as &quot;ub-1&quot;,
</span><span id="__span-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24"></a>  array_lower(arr, 2) as &quot;lb-2&quot;,
</span><span id="__span-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25"></a>  array_upper(arr, 2) as &quot;ub-2&quot;,
</span><span id="__span-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26"></a>  array_lower(arr, 3) as &quot;lb-3&quot;,
</span><span id="__span-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27"></a>  array_upper(arr, 3) as &quot;ub-3&quot;
</span><span id="__span-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>分别返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1">1</a></span>
<span class="normal"><a href="#__codelineno-75-2">2</a></span>
<span class="normal"><a href="#__codelineno-75-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1"></a> lb-1 | ub-1 | lb-2 | ub-2 | lb-3 | ub-3
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2"></a>------+------+------+------+-----+------
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3"></a>   2 |   4 |   3 |   6 |   4 |   5
</span></code></pre></div></td></tr></table></div>
<p>与</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1">1</a></span>
<span class="normal"><a href="#__codelineno-76-2">2</a></span>
<span class="normal"><a href="#__codelineno-76-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1"></a>                     old value of arr
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2"></a>-------------------------------------------------------------------------------------------------
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3"></a> [2:4][3:6][4:5]={{{a,b},{c,d},{e,f},{g,h}},{{i,j},{k,l},{m,n},{o,p}},{{q,r},{s,t},{u,v},{w,x}}}
</span></code></pre></div></td></tr></table></div>
<p>现在进行如下切片：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-77-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-77-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-77-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-77-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-77-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-77-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-77-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-77-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-77-10">10</a></span>
<span class="normal"><a href="#__codelineno-77-11">11</a></span>
<span class="normal"><a href="#__codelineno-77-12">12</a></span>
<span class="normal"><a href="#__codelineno-77-13">13</a></span>
<span class="normal"><a href="#__codelineno-77-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1"></a>update t
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2"></a>set arr = arr[2:3][4:5][3:4]
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3"></a>where k = 1;
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4"></a>
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5"></a>select arr as &quot;new value of arr&quot; from t where k = 1;
</span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6"></a>
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7"></a>select
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8"></a>  array_lower(arr, 1) as &quot;lb-1&quot;,
</span><span id="__span-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9"></a>  array_upper(arr, 1) as &quot;ub-1&quot;,
</span><span id="__span-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10"></a>  array_lower(arr, 2) as &quot;lb-2&quot;,
</span><span id="__span-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11"></a>  array_upper(arr, 2) as &quot;ub-2&quot;,
</span><span id="__span-77-12"><a id="__codelineno-77-12" name="__codelineno-77-12"></a>  array_lower(arr, 3) as &quot;lb-3&quot;,
</span><span id="__span-77-13"><a id="__codelineno-77-13" name="__codelineno-77-13"></a>  array_upper(arr, 3) as &quot;ub-3&quot;
</span><span id="__span-77-14"><a id="__codelineno-77-14" name="__codelineno-77-14"></a>from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>分别返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1">1</a></span>
<span class="normal"><a href="#__codelineno-78-2">2</a></span>
<span class="normal"><a href="#__codelineno-78-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1"></a>   new value of arr
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2"></a>-------------------------------
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3"></a> {{{c},{e}},{{k},{m}}}
</span></code></pre></div></td></tr></table></div>
<p>与：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1">1</a></span>
<span class="normal"><a href="#__codelineno-79-2">2</a></span>
<span class="normal"><a href="#__codelineno-79-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1"></a> lb-1 | ub-1 | lb-2 | ub-2 | lb-3 | ub-3
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2"></a>------+------+------+------+-----+------
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3"></a>   1 |   2 |   1 |   2 |   1 |    1
</span></code></pre></div></td></tr></table></div>
<p>可以看到，返回的下界都是1</p>
<h2 id="_11"><strong>连接函数和运算符</strong><a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p>这些函数要求两个数组具有相同的数据类型和兼容的维度。</p>
<table>
<thead>
<tr>
<th>函数和运算符</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_array_cat()">array_cat()</a></td>
<td></td>
<td>返回两个兼容的任意数组值的串联。</td>
</tr>
<tr>
<td><a href="#_array_append()">array_append()</a></td>
<td></td>
<td>向一个数组的末端追加一个元素值。</td>
</tr>
<tr>
<td><a href="#_array_prepend()">array_prepend()</a></td>
<td></td>
<td>向一个数组的首部追加一个元素</td>
</tr>
</tbody>
</table>
<h3 id="array_cat">array_cat()<a class="headerlink" href="#array_cat" title="Permanent link">&para;</a></h3>
<p>目的：返回两个兼容的任意数组值的串联。</p>
<p>语法：</p>
<p>输入值:              anyarray, anyarray
返回值:             anyarray</p>
<p>注意：DO块表明 || 运算符能够实现array_cat()函数的全部功能。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-80-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-80-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-80-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-80-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-80-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-80-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-80-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-80-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-80-10">10</a></span>
<span class="normal"><a href="#__codelineno-80-11">11</a></span>
<span class="normal"><a href="#__codelineno-80-12">12</a></span>
<span class="normal"><a href="#__codelineno-80-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1"></a>do $body$
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2"></a>declare
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3"></a>  arr_1 constant int[] := &#39;{1, 2, 3}&#39;::int[];
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4"></a>  arr_2 constant int[] := &#39;{4, 5, 6}&#39;::int[];
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5"></a>  val constant int := 5;
</span><span id="__span-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6"></a>  workaround constant int[] := array[val];
</span><span id="__span-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7"></a>begin
</span><span id="__span-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8"></a>  assert
</span><span id="__span-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9"></a>    array_cat(arr_1, arr_2)      = arr_1||arr_2 and
</span><span id="__span-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10"></a>    array_cat(arr_1, workaround) = arr_1||val   ,
</span><span id="__span-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11"></a>  &#39;unexpected&#39;;
</span><span id="__span-80-12"><a id="__codelineno-80-12" name="__codelineno-80-12"></a>end;
</span><span id="__span-80-13"><a id="__codelineno-80-13" name="__codelineno-80-13"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h3 id="array_append">array_append()<a class="headerlink" href="#array_append" title="Permanent link">&para;</a></h3>
<p>目的：向一个数组的末端追加一个元素值。</p>
<p>语法：
输入值:              anyarray, anyelement
返回值:             anyarray</p>
<p>注意：DO块表明 || 运算符能够实现array_append()函数的全部功能，值兼容。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-81-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-81-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-81-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-81-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-81-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-81-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-81-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-81-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-81-10">10</a></span>
<span class="normal"><a href="#__codelineno-81-11">11</a></span>
<span class="normal"><a href="#__codelineno-81-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1"></a>do $body$
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2"></a>declare
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3"></a>  arr constant int[] := &#39;{1, 2, 3, 4}&#39;::int[];
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4"></a>  val constant int := 5;
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5"></a>  workaround constant int[] := array[val];
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6"></a>begin
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7"></a>  assert
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8"></a>    array_append(arr, val) = arr||val                   and
</span><span id="__span-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9"></a>    array_append(arr, val) = array_cat(arr, workaround) ,
</span><span id="__span-81-10"><a id="__codelineno-81-10" name="__codelineno-81-10"></a>  &#39;unexpected&#39;;
</span><span id="__span-81-11"><a id="__codelineno-81-11" name="__codelineno-81-11"></a>end;
</span><span id="__span-81-12"><a id="__codelineno-81-12" name="__codelineno-81-12"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h3 id="array_prepend">array_prepend()<a class="headerlink" href="#array_prepend" title="Permanent link">&para;</a></h3>
<p>目的：向一个数组的首部追加一个元素</p>
<p>语法：
输入值:              anyelement, anyarray
返回值:             anyarray</p>
<p>注意：DO块表明 || 运算符能够实现array_prepend()函数的全部功能，值兼容。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-82-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-82-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-82-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-82-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-82-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-82-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-82-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-82-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-82-10">10</a></span>
<span class="normal"><a href="#__codelineno-82-11">11</a></span>
<span class="normal"><a href="#__codelineno-82-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1"></a>do $body$
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2"></a>declare
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3"></a>  arr constant int[] := &#39;{1, 2, 3, 4}&#39;::int[];
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4"></a>  val constant int := 5;
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5"></a>  workaround constant int[] := array[val];
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6"></a>begin
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7"></a>  assert
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8"></a>    array_prepend(val, arr) = val||arr                   and
</span><span id="__span-82-9"><a id="__codelineno-82-9" name="__codelineno-82-9"></a>    array_prepend(val, arr) = array_cat(workaround, arr) ,
</span><span id="__span-82-10"><a id="__codelineno-82-10" name="__codelineno-82-10"></a>  &#39;unexpected&#39;;
</span><span id="__span-82-11"><a id="__codelineno-82-11" name="__codelineno-82-11"></a>end;
</span><span id="__span-82-12"><a id="__codelineno-82-12" name="__codelineno-82-12"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>以下两个示例展示了一维数组，与多维数组的应用：</p>
<p>示例一（一维数组）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-83-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-83-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-83-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-83-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-83-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-83-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-83-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-83-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-83-10">10</a></span>
<span class="normal"><a href="#__codelineno-83-11">11</a></span>
<span class="normal"><a href="#__codelineno-83-12">12</a></span>
<span class="normal"><a href="#__codelineno-83-13">13</a></span>
<span class="normal"><a href="#__codelineno-83-14">14</a></span>
<span class="normal"><a href="#__codelineno-83-15">15</a></span>
<span class="normal"><a href="#__codelineno-83-16">16</a></span>
<span class="normal"><a href="#__codelineno-83-17">17</a></span>
<span class="normal"><a href="#__codelineno-83-18">18</a></span>
<span class="normal"><a href="#__codelineno-83-19">19</a></span>
<span class="normal"><a href="#__codelineno-83-20">20</a></span>
<span class="normal"><a href="#__codelineno-83-21">21</a></span>
<span class="normal"><a href="#__codelineno-83-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2"></a>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3"></a>do $body$
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4"></a>declare
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5"></a>  arr constant rt[] := array[(3, &#39;c&#39;)::rt, (4, &#39;d&#39;)::rt, (5, &#39;e&#39;)::rt];
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6"></a>
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7"></a>  prepend_row  constant rt := (0, &#39;z&#39;)::rt;
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8"></a>  prepend_arr  constant rt[] := array[(1, &#39;a&#39;)::rt, (2, &#39;b&#39;)::rt];
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9"></a>  append_row   constant rt := (6, &#39;f&#39;)::rt;
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10"></a>
</span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11"></a>  cat_result   constant rt[] := prepend_row||prepend_arr||arr||append_row;
</span><span id="__span-83-12"><a id="__codelineno-83-12" name="__codelineno-83-12"></a>
</span><span id="__span-83-13"><a id="__codelineno-83-13" name="__codelineno-83-13"></a>  expected_result constant rt[] :=
</span><span id="__span-83-14"><a id="__codelineno-83-14" name="__codelineno-83-14"></a>    array[(0, &#39;z&#39;)::rt, (1, &#39;a&#39;)::rt, (2, &#39;b&#39;)::rt, (3, &#39;c&#39;)::rt,
</span><span id="__span-83-15"><a id="__codelineno-83-15" name="__codelineno-83-15"></a>         (4, &#39;d&#39;)::rt, (5, &#39;e&#39;)::rt, (6, &#39;f&#39;)::rt];
</span><span id="__span-83-16"><a id="__codelineno-83-16" name="__codelineno-83-16"></a>
</span><span id="__span-83-17"><a id="__codelineno-83-17" name="__codelineno-83-17"></a>begin
</span><span id="__span-83-18"><a id="__codelineno-83-18" name="__codelineno-83-18"></a>  assert
</span><span id="__span-83-19"><a id="__codelineno-83-19" name="__codelineno-83-19"></a>    (cat_result   = expected_result),
</span><span id="__span-83-20"><a id="__codelineno-83-20" name="__codelineno-83-20"></a>  &#39;unexpected&#39;;
</span><span id="__span-83-21"><a id="__codelineno-83-21" name="__codelineno-83-21"></a>end;
</span><span id="__span-83-22"><a id="__codelineno-83-22" name="__codelineno-83-22"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>示例二（多维数组）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-84-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-84-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-84-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-84-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-84-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-84-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-84-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-84-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-84-10">10</a></span>
<span class="normal"><a href="#__codelineno-84-11">11</a></span>
<span class="normal"><a href="#__codelineno-84-12">12</a></span>
<span class="normal"><a href="#__codelineno-84-13">13</a></span>
<span class="normal"><a href="#__codelineno-84-14">14</a></span>
<span class="normal"><a href="#__codelineno-84-15">15</a></span>
<span class="normal"><a href="#__codelineno-84-16">16</a></span>
<span class="normal"><a href="#__codelineno-84-17">17</a></span>
<span class="normal"><a href="#__codelineno-84-18">18</a></span>
<span class="normal"><a href="#__codelineno-84-19">19</a></span>
<span class="normal"><a href="#__codelineno-84-20">20</a></span>
<span class="normal"><a href="#__codelineno-84-21">21</a></span>
<span class="normal"><a href="#__codelineno-84-22">22</a></span>
<span class="normal"><a href="#__codelineno-84-23">23</a></span>
<span class="normal"><a href="#__codelineno-84-24">24</a></span>
<span class="normal"><a href="#__codelineno-84-25">25</a></span>
<span class="normal"><a href="#__codelineno-84-26">26</a></span>
<span class="normal"><a href="#__codelineno-84-27">27</a></span>
<span class="normal"><a href="#__codelineno-84-28">28</a></span>
<span class="normal"><a href="#__codelineno-84-29">29</a></span>
<span class="normal"><a href="#__codelineno-84-30">30</a></span>
<span class="normal"><a href="#__codelineno-84-31">31</a></span>
<span class="normal"><a href="#__codelineno-84-32">32</a></span>
<span class="normal"><a href="#__codelineno-84-33">33</a></span>
<span class="normal"><a href="#__codelineno-84-34">34</a></span>
<span class="normal"><a href="#__codelineno-84-35">35</a></span>
<span class="normal"><a href="#__codelineno-84-36">36</a></span>
<span class="normal"><a href="#__codelineno-84-37">37</a></span>
<span class="normal"><a href="#__codelineno-84-38">38</a></span>
<span class="normal"><a href="#__codelineno-84-39">39</a></span>
<span class="normal"><a href="#__codelineno-84-40">40</a></span>
<span class="normal"><a href="#__codelineno-84-41">41</a></span>
<span class="normal"><a href="#__codelineno-84-42">42</a></span>
<span class="normal"><a href="#__codelineno-84-43">43</a></span>
<span class="normal"><a href="#__codelineno-84-44">44</a></span>
<span class="normal"><a href="#__codelineno-84-45">45</a></span>
<span class="normal"><a href="#__codelineno-84-46">46</a></span>
<span class="normal"><a href="#__codelineno-84-47">47</a></span>
<span class="normal"><a href="#__codelineno-84-48">48</a></span>
<span class="normal"><a href="#__codelineno-84-49">49</a></span>
<span class="normal"><a href="#__codelineno-84-50">50</a></span>
<span class="normal"><a href="#__codelineno-84-51">51</a></span>
<span class="normal"><a href="#__codelineno-84-52">52</a></span>
<span class="normal"><a href="#__codelineno-84-53">53</a></span>
<span class="normal"><a href="#__codelineno-84-54">54</a></span>
<span class="normal"><a href="#__codelineno-84-55">55</a></span>
<span class="normal"><a href="#__codelineno-84-56">56</a></span>
<span class="normal"><a href="#__codelineno-84-57">57</a></span>
<span class="normal"><a href="#__codelineno-84-58">58</a></span>
<span class="normal"><a href="#__codelineno-84-59">59</a></span>
<span class="normal"><a href="#__codelineno-84-60">60</a></span>
<span class="normal"><a href="#__codelineno-84-61">61</a></span>
<span class="normal"><a href="#__codelineno-84-62">62</a></span>
<span class="normal"><a href="#__codelineno-84-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1"></a>do $body$
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2"></a>declare
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3"></a>  -- arr_1 and arr_2 are demensionally compatible.
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4"></a>  -- Its&#39;s OK for array_length(*, 1) to differ.
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5"></a>  -- But array_length(*, 1) must be the same.
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6"></a>  arr_1 constant int[] :=
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7"></a>    array[
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8"></a>       array[11, 12, 13],
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9"></a>       array[21, 22, 23]
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10"></a>    ];
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11"></a>
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12"></a>  arr_2 constant int[] :=
</span><span id="__span-84-13"><a id="__codelineno-84-13" name="__codelineno-84-13"></a>    array[
</span><span id="__span-84-14"><a id="__codelineno-84-14" name="__codelineno-84-14"></a>       array[31, 32, 33],
</span><span id="__span-84-15"><a id="__codelineno-84-15" name="__codelineno-84-15"></a>       array[41, 42, 43],
</span><span id="__span-84-16"><a id="__codelineno-84-16" name="__codelineno-84-16"></a>       array[51, 52, 53]
</span><span id="__span-84-17"><a id="__codelineno-84-17" name="__codelineno-84-17"></a>    ];
</span><span id="__span-84-18"><a id="__codelineno-84-18" name="__codelineno-84-18"></a>
</span><span id="__span-84-19"><a id="__codelineno-84-19" name="__codelineno-84-19"></a>  -- Notice that this is a 1-d array.
</span><span id="__span-84-20"><a id="__codelineno-84-20" name="__codelineno-84-20"></a>  -- Its lenth is the same as that of arr_1
</span><span id="__span-84-21"><a id="__codelineno-84-21" name="__codelineno-84-21"></a>  -- along arr_1&#39;s SECOND dimension.
</span><span id="__span-84-22"><a id="__codelineno-84-22" name="__codelineno-84-22"></a>  arr_3 constant int[] := array[31, 32, 33];
</span><span id="__span-84-23"><a id="__codelineno-84-23" name="__codelineno-84-23"></a>
</span><span id="__span-84-24"><a id="__codelineno-84-24" name="__codelineno-84-24"></a>  -- Notice that bad_arr is dimensionally INCOMPATIBLE with arr_1:
</span><span id="__span-84-25"><a id="__codelineno-84-25" name="__codelineno-84-25"></a>  -- they have different lengths along their SECOND major dimension.
</span><span id="__span-84-26"><a id="__codelineno-84-26" name="__codelineno-84-26"></a>  bad_arr constant int[] :=
</span><span id="__span-84-27"><a id="__codelineno-84-27" name="__codelineno-84-27"></a>    array[
</span><span id="__span-84-28"><a id="__codelineno-84-28" name="__codelineno-84-28"></a>       array[61, 62, 63, 64],
</span><span id="__span-84-29"><a id="__codelineno-84-29" name="__codelineno-84-29"></a>       array[71, 72, 73, 74],
</span><span id="__span-84-30"><a id="__codelineno-84-30" name="__codelineno-84-30"></a>       array[81, 82, 83, 84]
</span><span id="__span-84-31"><a id="__codelineno-84-31" name="__codelineno-84-31"></a>    ];
</span><span id="__span-84-32"><a id="__codelineno-84-32" name="__codelineno-84-32"></a>
</span><span id="__span-84-33"><a id="__codelineno-84-33" name="__codelineno-84-33"></a>  expected_cat_1 constant int[] :=
</span><span id="__span-84-34"><a id="__codelineno-84-34" name="__codelineno-84-34"></a>    array[
</span><span id="__span-84-35"><a id="__codelineno-84-35" name="__codelineno-84-35"></a>       array[11, 12, 13],
</span><span id="__span-84-36"><a id="__codelineno-84-36" name="__codelineno-84-36"></a>       array[21, 22, 23],
</span><span id="__span-84-37"><a id="__codelineno-84-37" name="__codelineno-84-37"></a>       array[31, 32, 33],
</span><span id="__span-84-38"><a id="__codelineno-84-38" name="__codelineno-84-38"></a>       array[41, 42, 43],
</span><span id="__span-84-39"><a id="__codelineno-84-39" name="__codelineno-84-39"></a>       array[51, 52, 53]
</span><span id="__span-84-40"><a id="__codelineno-84-40" name="__codelineno-84-40"></a>    ];
</span><span id="__span-84-41"><a id="__codelineno-84-41" name="__codelineno-84-41"></a>
</span><span id="__span-84-42"><a id="__codelineno-84-42" name="__codelineno-84-42"></a>  expected_cat_2 constant int[] :=
</span><span id="__span-84-43"><a id="__codelineno-84-43" name="__codelineno-84-43"></a>    array[
</span><span id="__span-84-44"><a id="__codelineno-84-44" name="__codelineno-84-44"></a>       array[11, 12, 13],
</span><span id="__span-84-45"><a id="__codelineno-84-45" name="__codelineno-84-45"></a>       array[21, 22, 23],
</span><span id="__span-84-46"><a id="__codelineno-84-46" name="__codelineno-84-46"></a>       array[31, 32, 33]
</span><span id="__span-84-47"><a id="__codelineno-84-47" name="__codelineno-84-47"></a>    ];
</span><span id="__span-84-48"><a id="__codelineno-84-48" name="__codelineno-84-48"></a>begin
</span><span id="__span-84-49"><a id="__codelineno-84-49" name="__codelineno-84-49"></a>  assert
</span><span id="__span-84-50"><a id="__codelineno-84-50" name="__codelineno-84-50"></a>    arr_1||arr_2 = expected_cat_1 and
</span><span id="__span-84-51"><a id="__codelineno-84-51" name="__codelineno-84-51"></a>    arr_1||arr_3 = expected_cat_2,
</span><span id="__span-84-52"><a id="__codelineno-84-52" name="__codelineno-84-52"></a>  &#39;unexpected&#39;;
</span><span id="__span-84-53"><a id="__codelineno-84-53" name="__codelineno-84-53"></a>
</span><span id="__span-84-54"><a id="__codelineno-84-54" name="__codelineno-84-54"></a>  declare
</span><span id="__span-84-55"><a id="__codelineno-84-55" name="__codelineno-84-55"></a>    a int[];
</span><span id="__span-84-56"><a id="__codelineno-84-56" name="__codelineno-84-56"></a>  begin
</span><span id="__span-84-57"><a id="__codelineno-84-57" name="__codelineno-84-57"></a>    -- ERROR: cannot concatenate incompatible arrays.
</span><span id="__span-84-58"><a id="__codelineno-84-58" name="__codelineno-84-58"></a>    a := arr_1||bad_arr;
</span><span id="__span-84-59"><a id="__codelineno-84-59" name="__codelineno-84-59"></a>  exception
</span><span id="__span-84-60"><a id="__codelineno-84-60" name="__codelineno-84-60"></a>    when array_subscript_error then null;
</span><span id="__span-84-61"><a id="__codelineno-84-61" name="__codelineno-84-61"></a>  end;
</span><span id="__span-84-62"><a id="__codelineno-84-62" name="__codelineno-84-62"></a>end;
</span><span id="__span-84-63"><a id="__codelineno-84-63" name="__codelineno-84-63"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h2 id="_12"><strong>更改函数和运算符</strong><a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>函数和运算符</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_array_replace()">array_replace()</a></td>
<td></td>
<td>将每一个等于给定值的数组元素替换成一个新值</td>
</tr>
<tr>
<td><a href="#_arr[idx_1]...[idx_N]:=val">arr[idx_1]...[idx_N] := val</a></td>
<td></td>
<td>更新数组值</td>
</tr>
<tr>
<td><a href="#_array_remove()">array_remove()</a></td>
<td>1-d</td>
<td>从数组中移除所有等于给定值的所有元素</td>
</tr>
</tbody>
</table>
<h3 id="array_replace">array_replace()<a class="headerlink" href="#array_replace" title="Permanent link">&para;</a></h3>
<p>本小节中描述的每一种方法，使用array_replace()函数，与显式设置数组值，都可以用于更改数组中的值。但这两种方法有如下的不同点：</p>
<ul>
<li>array_replace()将所有与指定值匹配的值更改为相同的新值，而不考虑它们在数组中的地址。</li>
<li>设置数组值，则仅对当前值进行更改。 </li>
</ul>
<p>目的：将每一个等于给定值的数组元素替换成一个新值</p>
<p>语法：</p>
<p>输入值:       anyarray, anyelement, anyelement
返回值:      anyarray</p>
<p>例如：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-85-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-85-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-85-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-85-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-85-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-85-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-85-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-85-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-85-10">10</a></span>
<span class="normal"><a href="#__codelineno-85-11">11</a></span>
<span class="normal"><a href="#__codelineno-85-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2"></a>create table t(k int primary key, arr rt[]);
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3"></a>insert into t(k, arr)
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4"></a>values (1, &#39;{&quot;(1,rabbit)&quot;,&quot;(2,hare)&quot;,&quot;(3,squirrel)&quot;,&quot;(4,horse)&quot;}&#39;::rt[]);
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5"></a>
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6"></a>select arr as &quot;old value of arr&quot; from t where k = 1;
</span><span id="__span-85-7"><a id="__codelineno-85-7" name="__codelineno-85-7"></a>
</span><span id="__span-85-8"><a id="__codelineno-85-8" name="__codelineno-85-8"></a>update t
</span><span id="__span-85-9"><a id="__codelineno-85-9" name="__codelineno-85-9"></a>set arr = array_replace(arr, &#39;(3,squirrel)&#39;, &#39;(3,bobcat)&#39;)
</span><span id="__span-85-10"><a id="__codelineno-85-10" name="__codelineno-85-10"></a>where k = 1;
</span><span id="__span-85-11"><a id="__codelineno-85-11" name="__codelineno-85-11"></a>
</span><span id="__span-85-12"><a id="__codelineno-85-12" name="__codelineno-85-12"></a>select arr as &quot;new value of arr&quot; from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回如下信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1">1</a></span>
<span class="normal"><a href="#__codelineno-86-2">2</a></span>
<span class="normal"><a href="#__codelineno-86-3">3</a></span>
<span class="normal"><a href="#__codelineno-86-4">4</a></span>
<span class="normal"><a href="#__codelineno-86-5">5</a></span>
<span class="normal"><a href="#__codelineno-86-6">6</a></span>
<span class="normal"><a href="#__codelineno-86-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1"></a>                   old value of arr
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2"></a>------------------------------------------------------
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3"></a> {&quot;(1,rabbit)&quot;,&quot;(2,hare)&quot;,&quot;(3,squirrel)&quot;,&quot;(4,horse)&quot;}
</span><span id="__span-86-4"><a id="__codelineno-86-4" name="__codelineno-86-4"></a>
</span><span id="__span-86-5"><a id="__codelineno-86-5" name="__codelineno-86-5"></a>                  new value of arr
</span><span id="__span-86-6"><a id="__codelineno-86-6" name="__codelineno-86-6"></a>----------------------------------------------------
</span><span id="__span-86-7"><a id="__codelineno-86-7" name="__codelineno-86-7"></a> {&quot;(1,rabbit)&quot;,&quot;(2,hare)&quot;,&quot;(3,bobcat)&quot;,&quot;(4,horse)&quot;}
</span></code></pre></div></td></tr></table></div>
<p>如下是更多的，针对不同情况的演示示例：</p>
<p>示例一（一维数组的基本数据类型）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-87-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-87-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-87-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-87-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-87-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-87-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-87-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-87-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-87-10">10</a></span>
<span class="normal"><a href="#__codelineno-87-11">11</a></span>
<span class="normal"><a href="#__codelineno-87-12">12</a></span>
<span class="normal"><a href="#__codelineno-87-13">13</a></span>
<span class="normal"><a href="#__codelineno-87-14">14</a></span>
<span class="normal"><a href="#__codelineno-87-15">15</a></span>
<span class="normal"><a href="#__codelineno-87-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1"></a>do $body$
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2"></a>declare
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3"></a>  old_val constant int := 42;
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4"></a>  new_val constant int := 17;
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5"></a>
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6"></a>  arr constant int[] :=
</span><span id="__span-87-7"><a id="__codelineno-87-7" name="__codelineno-87-7"></a>    array[1, old_val, 3, 4, 5, old_val, 6, 7];
</span><span id="__span-87-8"><a id="__codelineno-87-8" name="__codelineno-87-8"></a>
</span><span id="__span-87-9"><a id="__codelineno-87-9" name="__codelineno-87-9"></a>  expected_modified_arr constant int[] :=
</span><span id="__span-87-10"><a id="__codelineno-87-10" name="__codelineno-87-10"></a>    array[1, new_val, 3, 4, 5, new_val, 6, 7];
</span><span id="__span-87-11"><a id="__codelineno-87-11" name="__codelineno-87-11"></a>begin
</span><span id="__span-87-12"><a id="__codelineno-87-12" name="__codelineno-87-12"></a>  assert
</span><span id="__span-87-13"><a id="__codelineno-87-13" name="__codelineno-87-13"></a>    array_replace(arr, old_val, new_val) = expected_modified_arr,
</span><span id="__span-87-14"><a id="__codelineno-87-14" name="__codelineno-87-14"></a>  &#39;unexpected&#39;;
</span><span id="__span-87-15"><a id="__codelineno-87-15" name="__codelineno-87-15"></a>end;
</span><span id="__span-87-16"><a id="__codelineno-87-16" name="__codelineno-87-16"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>示例二（一维数组的row类型）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-88-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-88-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-88-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-88-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-88-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-88-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-88-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-88-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-88-10">10</a></span>
<span class="normal"><a href="#__codelineno-88-11">11</a></span>
<span class="normal"><a href="#__codelineno-88-12">12</a></span>
<span class="normal"><a href="#__codelineno-88-13">13</a></span>
<span class="normal"><a href="#__codelineno-88-14">14</a></span>
<span class="normal"><a href="#__codelineno-88-15">15</a></span>
<span class="normal"><a href="#__codelineno-88-16">16</a></span>
<span class="normal"><a href="#__codelineno-88-17">17</a></span>
<span class="normal"><a href="#__codelineno-88-18">18</a></span>
<span class="normal"><a href="#__codelineno-88-19">19</a></span>
<span class="normal"><a href="#__codelineno-88-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2"></a>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3"></a>do $body$
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4"></a>declare
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5"></a>  old_val constant rt := (42, &#39;x&#39;);
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6"></a>  new_val constant rt := (17, &#39;y&#39;);
</span><span id="__span-88-7"><a id="__codelineno-88-7" name="__codelineno-88-7"></a>
</span><span id="__span-88-8"><a id="__codelineno-88-8" name="__codelineno-88-8"></a>  arr constant rt[] :=
</span><span id="__span-88-9"><a id="__codelineno-88-9" name="__codelineno-88-9"></a>    array[(1, &#39;a&#39;)::rt, old_val, (1, &#39;a&#39;)::rt, (2, &#39;b&#39;)::rt, (3, &#39;c&#39;)::rt,
</span><span id="__span-88-10"><a id="__codelineno-88-10" name="__codelineno-88-10"></a>                        old_val, (4, &#39;d&#39;)::rt, (5, &#39;e&#39;)::rt];
</span><span id="__span-88-11"><a id="__codelineno-88-11" name="__codelineno-88-11"></a>
</span><span id="__span-88-12"><a id="__codelineno-88-12" name="__codelineno-88-12"></a>  expected_modified_arr constant rt[] :=
</span><span id="__span-88-13"><a id="__codelineno-88-13" name="__codelineno-88-13"></a>    array[(1, &#39;a&#39;)::rt, new_val, (1, &#39;a&#39;)::rt, (2, &#39;b&#39;)::rt, (3, &#39;c&#39;)::rt,
</span><span id="__span-88-14"><a id="__codelineno-88-14" name="__codelineno-88-14"></a>                        new_val, (4, &#39;d&#39;)::rt, (5, &#39;e&#39;)::rt];
</span><span id="__span-88-15"><a id="__codelineno-88-15" name="__codelineno-88-15"></a>begin
</span><span id="__span-88-16"><a id="__codelineno-88-16" name="__codelineno-88-16"></a>  assert
</span><span id="__span-88-17"><a id="__codelineno-88-17" name="__codelineno-88-17"></a>    array_replace(arr, old_val, new_val) = expected_modified_arr,
</span><span id="__span-88-18"><a id="__codelineno-88-18" name="__codelineno-88-18"></a>  &#39;unexpected&#39;;
</span><span id="__span-88-19"><a id="__codelineno-88-19" name="__codelineno-88-19"></a>end;
</span><span id="__span-88-20"><a id="__codelineno-88-20" name="__codelineno-88-20"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>示例三（二维数组的基本数据类型）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-89-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-89-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-89-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-89-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-89-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-89-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-89-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-89-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-89-10">10</a></span>
<span class="normal"><a href="#__codelineno-89-11">11</a></span>
<span class="normal"><a href="#__codelineno-89-12">12</a></span>
<span class="normal"><a href="#__codelineno-89-13">13</a></span>
<span class="normal"><a href="#__codelineno-89-14">14</a></span>
<span class="normal"><a href="#__codelineno-89-15">15</a></span>
<span class="normal"><a href="#__codelineno-89-16">16</a></span>
<span class="normal"><a href="#__codelineno-89-17">17</a></span>
<span class="normal"><a href="#__codelineno-89-18">18</a></span>
<span class="normal"><a href="#__codelineno-89-19">19</a></span>
<span class="normal"><a href="#__codelineno-89-20">20</a></span>
<span class="normal"><a href="#__codelineno-89-21">21</a></span>
<span class="normal"><a href="#__codelineno-89-22">22</a></span>
<span class="normal"><a href="#__codelineno-89-23">23</a></span>
<span class="normal"><a href="#__codelineno-89-24">24</a></span>
<span class="normal"><a href="#__codelineno-89-25">25</a></span>
<span class="normal"><a href="#__codelineno-89-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1"></a>do $body$
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2"></a>declare
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3"></a>  old_val constant int := 22;
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4"></a>  new_val constant int := 97;
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5"></a>
</span><span id="__span-89-6"><a id="__codelineno-89-6" name="__codelineno-89-6"></a>  arr int[] :=
</span><span id="__span-89-7"><a id="__codelineno-89-7" name="__codelineno-89-7"></a>    array[
</span><span id="__span-89-8"><a id="__codelineno-89-8" name="__codelineno-89-8"></a>       array[11, 12],
</span><span id="__span-89-9"><a id="__codelineno-89-9" name="__codelineno-89-9"></a>       array[11, old_val],
</span><span id="__span-89-10"><a id="__codelineno-89-10" name="__codelineno-89-10"></a>       array[32, 33]
</span><span id="__span-89-11"><a id="__codelineno-89-11" name="__codelineno-89-11"></a>    ];
</span><span id="__span-89-12"><a id="__codelineno-89-12" name="__codelineno-89-12"></a>
</span><span id="__span-89-13"><a id="__codelineno-89-13" name="__codelineno-89-13"></a>  expected_modified_arr constant int[] :=
</span><span id="__span-89-14"><a id="__codelineno-89-14" name="__codelineno-89-14"></a>    array[
</span><span id="__span-89-15"><a id="__codelineno-89-15" name="__codelineno-89-15"></a>       array[11, 12],
</span><span id="__span-89-16"><a id="__codelineno-89-16" name="__codelineno-89-16"></a>       array[11, new_val],
</span><span id="__span-89-17"><a id="__codelineno-89-17" name="__codelineno-89-17"></a>       array[32, 33]
</span><span id="__span-89-18"><a id="__codelineno-89-18" name="__codelineno-89-18"></a>    ];
</span><span id="__span-89-19"><a id="__codelineno-89-19" name="__codelineno-89-19"></a>begin
</span><span id="__span-89-20"><a id="__codelineno-89-20" name="__codelineno-89-20"></a>  arr := array_replace(arr, old_val, new_val);
</span><span id="__span-89-21"><a id="__codelineno-89-21" name="__codelineno-89-21"></a>
</span><span id="__span-89-22"><a id="__codelineno-89-22" name="__codelineno-89-22"></a>  assert
</span><span id="__span-89-23"><a id="__codelineno-89-23" name="__codelineno-89-23"></a>    arr = expected_modified_arr,
</span><span id="__span-89-24"><a id="__codelineno-89-24" name="__codelineno-89-24"></a>  &#39;unexpected&#39;;
</span><span id="__span-89-25"><a id="__codelineno-89-25" name="__codelineno-89-25"></a>end;
</span><span id="__span-89-26"><a id="__codelineno-89-26" name="__codelineno-89-26"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h3 id="arridx_1idx_n-val">arr[idx_1]...[idx_N] := val<a class="headerlink" href="#arridx_1idx_n-val" title="Permanent link">&para;</a></h3>
<p>目的：更新数组值</p>
<p>语法：
input/output value: anyarray, "vector of index values"</p>
<p>例如：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1">1</a></span>
<span class="normal"><a href="#__codelineno-90-2">2</a></span>
<span class="normal"><a href="#__codelineno-90-3">3</a></span>
<span class="normal"><a href="#__codelineno-90-4">4</a></span>
<span class="normal"><a href="#__codelineno-90-5">5</a></span>
<span class="normal"><a href="#__codelineno-90-6">6</a></span>
<span class="normal"><a href="#__codelineno-90-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1"></a>create table t(k int primary key, arr int[]);
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2"></a>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3"></a>insert into t(k, arr) values (1,  &#39;{1, 2, 3, 4}&#39;);
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4"></a>
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5"></a>update t set arr[2] = 42 where k = 1;
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6"></a>
</span><span id="__span-90-7"><a id="__codelineno-90-7" name="__codelineno-90-7"></a>select arr from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1">1</a></span>
<span class="normal"><a href="#__codelineno-91-2">2</a></span>
<span class="normal"><a href="#__codelineno-91-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1"></a>    arr
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2"></a>------------
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3"></a> {1,42,3,4}
</span></code></pre></div></td></tr></table></div>
<p>如下是更多的，针对不同情况的演示示例：</p>
<p>示例一（基本数据类型）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-92-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-92-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-92-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-92-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-92-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-92-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-92-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-92-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-92-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-92-10">10</a></span>
<span class="normal"><a href="#__codelineno-92-11">11</a></span>
<span class="normal"><a href="#__codelineno-92-12">12</a></span>
<span class="normal"><a href="#__codelineno-92-13">13</a></span>
<span class="normal"><a href="#__codelineno-92-14">14</a></span>
<span class="normal"><a href="#__codelineno-92-15">15</a></span>
<span class="normal"><a href="#__codelineno-92-16">16</a></span>
<span class="normal"><a href="#__codelineno-92-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1"></a>do $body$
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2"></a>declare
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3"></a>  old_val constant int := 42;
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4"></a>  new_val constant int := 17;
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5"></a>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6"></a>  arr int[] :=                            array[1, 2, old_val, 4];
</span><span id="__span-92-7"><a id="__codelineno-92-7" name="__codelineno-92-7"></a>  expected_modified_arr constant int[] := array[1, 2, new_val, 4];
</span><span id="__span-92-8"><a id="__codelineno-92-8" name="__codelineno-92-8"></a>  old_arr constant int[] := arr;
</span><span id="__span-92-9"><a id="__codelineno-92-9" name="__codelineno-92-9"></a>begin
</span><span id="__span-92-10"><a id="__codelineno-92-10" name="__codelineno-92-10"></a>  arr[3] := new_val;
</span><span id="__span-92-11"><a id="__codelineno-92-11" name="__codelineno-92-11"></a>  assert
</span><span id="__span-92-12"><a id="__codelineno-92-12" name="__codelineno-92-12"></a>    old_arr =               &#39;{1, 2, 42, 4}&#39; and
</span><span id="__span-92-13"><a id="__codelineno-92-13" name="__codelineno-92-13"></a>    expected_modified_arr = &#39;{1, 2, 17, 4}&#39; and
</span><span id="__span-92-14"><a id="__codelineno-92-14" name="__codelineno-92-14"></a>    arr = expected_modified_arr,
</span><span id="__span-92-15"><a id="__codelineno-92-15" name="__codelineno-92-15"></a>  &#39;unexpected&#39;;
</span><span id="__span-92-16"><a id="__codelineno-92-16" name="__codelineno-92-16"></a>end;
</span><span id="__span-92-17"><a id="__codelineno-92-17" name="__codelineno-92-17"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>示例二（record类型）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-93-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-93-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-93-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-93-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-93-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-93-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-93-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-93-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-93-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-93-10">10</a></span>
<span class="normal"><a href="#__codelineno-93-11">11</a></span>
<span class="normal"><a href="#__codelineno-93-12">12</a></span>
<span class="normal"><a href="#__codelineno-93-13">13</a></span>
<span class="normal"><a href="#__codelineno-93-14">14</a></span>
<span class="normal"><a href="#__codelineno-93-15">15</a></span>
<span class="normal"><a href="#__codelineno-93-16">16</a></span>
<span class="normal"><a href="#__codelineno-93-17">17</a></span>
<span class="normal"><a href="#__codelineno-93-18">18</a></span>
<span class="normal"><a href="#__codelineno-93-19">19</a></span>
<span class="normal"><a href="#__codelineno-93-20">20</a></span>
<span class="normal"><a href="#__codelineno-93-21">21</a></span>
<span class="normal"><a href="#__codelineno-93-22">22</a></span>
<span class="normal"><a href="#__codelineno-93-23">23</a></span>
<span class="normal"><a href="#__codelineno-93-24">24</a></span>
<span class="normal"><a href="#__codelineno-93-25">25</a></span>
<span class="normal"><a href="#__codelineno-93-26">26</a></span>
<span class="normal"><a href="#__codelineno-93-27">27</a></span>
<span class="normal"><a href="#__codelineno-93-28">28</a></span>
<span class="normal"><a href="#__codelineno-93-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2"></a>
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3"></a>do $body$
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4"></a>declare
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5"></a>  old_val constant rt := (42, &#39;x&#39;);
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6"></a>  new_val constant rt := (17, &#39;y&#39;);
</span><span id="__span-93-7"><a id="__codelineno-93-7" name="__codelineno-93-7"></a>
</span><span id="__span-93-8"><a id="__codelineno-93-8" name="__codelineno-93-8"></a>  arr rt[] :=
</span><span id="__span-93-9"><a id="__codelineno-93-9" name="__codelineno-93-9"></a>    array[(1, &#39;a&#39;)::rt, old_val, (1, &#39;a&#39;)::rt, (2, &#39;b&#39;)::rt, (3, &#39;c&#39;)::rt,
</span><span id="__span-93-10"><a id="__codelineno-93-10" name="__codelineno-93-10"></a>                        old_val, (4, &#39;d&#39;)::rt, (5, &#39;e&#39;)::rt];
</span><span id="__span-93-11"><a id="__codelineno-93-11" name="__codelineno-93-11"></a>
</span><span id="__span-93-12"><a id="__codelineno-93-12" name="__codelineno-93-12"></a>  expected_modified_arr constant rt[] :=
</span><span id="__span-93-13"><a id="__codelineno-93-13" name="__codelineno-93-13"></a>    array[(1, &#39;a&#39;)::rt, new_val, (1, &#39;a&#39;)::rt, (2, &#39;b&#39;)::rt, (3, &#39;c&#39;)::rt,
</span><span id="__span-93-14"><a id="__codelineno-93-14" name="__codelineno-93-14"></a>                        new_val, (4, &#39;d&#39;)::rt, (5, &#39;e&#39;)::rt];
</span><span id="__span-93-15"><a id="__codelineno-93-15" name="__codelineno-93-15"></a>
</span><span id="__span-93-16"><a id="__codelineno-93-16" name="__codelineno-93-16"></a>  old_arr constant rt[] := arr;
</span><span id="__span-93-17"><a id="__codelineno-93-17" name="__codelineno-93-17"></a>begin
</span><span id="__span-93-18"><a id="__codelineno-93-18" name="__codelineno-93-18"></a>  arr[2] := new_val;
</span><span id="__span-93-19"><a id="__codelineno-93-19" name="__codelineno-93-19"></a>  arr[6] := new_val;
</span><span id="__span-93-20"><a id="__codelineno-93-20" name="__codelineno-93-20"></a>
</span><span id="__span-93-21"><a id="__codelineno-93-21" name="__codelineno-93-21"></a>  assert
</span><span id="__span-93-22"><a id="__codelineno-93-22" name="__codelineno-93-22"></a>    old_arr =
</span><span id="__span-93-23"><a id="__codelineno-93-23" name="__codelineno-93-23"></a>      &#39;{&quot;(1,a)&quot;,&quot;(42,x)&quot;,&quot;(1,a)&quot;,&quot;(2,b)&quot;,&quot;(3,c)&quot;,&quot;(42,x)&quot;,&quot;(4,d)&quot;,&quot;(5,e)&quot;}&#39; and
</span><span id="__span-93-24"><a id="__codelineno-93-24" name="__codelineno-93-24"></a>    expected_modified_arr =
</span><span id="__span-93-25"><a id="__codelineno-93-25" name="__codelineno-93-25"></a>      &#39;{&quot;(1,a)&quot;,&quot;(17,y)&quot;,&quot;(1,a)&quot;,&quot;(2,b)&quot;,&quot;(3,c)&quot;,&quot;(17,y)&quot;,&quot;(4,d)&quot;,&quot;(5,e)&quot;}&#39; and
</span><span id="__span-93-26"><a id="__codelineno-93-26" name="__codelineno-93-26"></a>    arr = expected_modified_arr,
</span><span id="__span-93-27"><a id="__codelineno-93-27" name="__codelineno-93-27"></a>  &#39;unexpected&#39;;
</span><span id="__span-93-28"><a id="__codelineno-93-28" name="__codelineno-93-28"></a>end;
</span><span id="__span-93-29"><a id="__codelineno-93-29" name="__codelineno-93-29"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<p>示例三（二维数组的基本数据类型）：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-94-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-94-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-94-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-94-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-94-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-94-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-94-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-94-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-94-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-94-10">10</a></span>
<span class="normal"><a href="#__codelineno-94-11">11</a></span>
<span class="normal"><a href="#__codelineno-94-12">12</a></span>
<span class="normal"><a href="#__codelineno-94-13">13</a></span>
<span class="normal"><a href="#__codelineno-94-14">14</a></span>
<span class="normal"><a href="#__codelineno-94-15">15</a></span>
<span class="normal"><a href="#__codelineno-94-16">16</a></span>
<span class="normal"><a href="#__codelineno-94-17">17</a></span>
<span class="normal"><a href="#__codelineno-94-18">18</a></span>
<span class="normal"><a href="#__codelineno-94-19">19</a></span>
<span class="normal"><a href="#__codelineno-94-20">20</a></span>
<span class="normal"><a href="#__codelineno-94-21">21</a></span>
<span class="normal"><a href="#__codelineno-94-22">22</a></span>
<span class="normal"><a href="#__codelineno-94-23">23</a></span>
<span class="normal"><a href="#__codelineno-94-24">24</a></span>
<span class="normal"><a href="#__codelineno-94-25">25</a></span>
<span class="normal"><a href="#__codelineno-94-26">26</a></span>
<span class="normal"><a href="#__codelineno-94-27">27</a></span>
<span class="normal"><a href="#__codelineno-94-28">28</a></span>
<span class="normal"><a href="#__codelineno-94-29">29</a></span>
<span class="normal"><a href="#__codelineno-94-30">30</a></span>
<span class="normal"><a href="#__codelineno-94-31">31</a></span>
<span class="normal"><a href="#__codelineno-94-32">32</a></span>
<span class="normal"><a href="#__codelineno-94-33">33</a></span>
<span class="normal"><a href="#__codelineno-94-34">34</a></span>
<span class="normal"><a href="#__codelineno-94-35">35</a></span>
<span class="normal"><a href="#__codelineno-94-36">36</a></span>
<span class="normal"><a href="#__codelineno-94-37">37</a></span>
<span class="normal"><a href="#__codelineno-94-38">38</a></span>
<span class="normal"><a href="#__codelineno-94-39">39</a></span>
<span class="normal"><a href="#__codelineno-94-40">40</a></span>
<span class="normal"><a href="#__codelineno-94-41">41</a></span>
<span class="normal"><a href="#__codelineno-94-42">42</a></span>
<span class="normal"><a href="#__codelineno-94-43">43</a></span>
<span class="normal"><a href="#__codelineno-94-44">44</a></span>
<span class="normal"><a href="#__codelineno-94-45">45</a></span>
<span class="normal"><a href="#__codelineno-94-46">46</a></span>
<span class="normal"><a href="#__codelineno-94-47">47</a></span>
<span class="normal"><a href="#__codelineno-94-48">48</a></span>
<span class="normal"><a href="#__codelineno-94-49">49</a></span>
<span class="normal"><a href="#__codelineno-94-50">50</a></span>
<span class="normal"><a href="#__codelineno-94-51">51</a></span>
<span class="normal"><a href="#__codelineno-94-52">52</a></span>
<span class="normal"><a href="#__codelineno-94-53">53</a></span>
<span class="normal"><a href="#__codelineno-94-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1"></a>do $body$
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2"></a>declare
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3"></a>  old_val constant int[] := array[21, 22, 23, 24];
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4"></a>  new_val constant int[] := array[81, 82, 83, 84];
</span><span id="__span-94-5"><a id="__codelineno-94-5" name="__codelineno-94-5"></a>
</span><span id="__span-94-6"><a id="__codelineno-94-6" name="__codelineno-94-6"></a>  arr int[] :=
</span><span id="__span-94-7"><a id="__codelineno-94-7" name="__codelineno-94-7"></a>    array[
</span><span id="__span-94-8"><a id="__codelineno-94-8" name="__codelineno-94-8"></a>       array[11, 12, 13, 14],
</span><span id="__span-94-9"><a id="__codelineno-94-9" name="__codelineno-94-9"></a>       old_val,
</span><span id="__span-94-10"><a id="__codelineno-94-10" name="__codelineno-94-10"></a>       array[31, 32, 33, 34]
</span><span id="__span-94-11"><a id="__codelineno-94-11" name="__codelineno-94-11"></a>    ];
</span><span id="__span-94-12"><a id="__codelineno-94-12" name="__codelineno-94-12"></a>
</span><span id="__span-94-13"><a id="__codelineno-94-13" name="__codelineno-94-13"></a>  expected_modified_arr constant int[] :=
</span><span id="__span-94-14"><a id="__codelineno-94-14" name="__codelineno-94-14"></a>    array[
</span><span id="__span-94-15"><a id="__codelineno-94-15" name="__codelineno-94-15"></a>       array[11, 12, 13, 14],
</span><span id="__span-94-16"><a id="__codelineno-94-16" name="__codelineno-94-16"></a>       new_val,
</span><span id="__span-94-17"><a id="__codelineno-94-17" name="__codelineno-94-17"></a>       array[31, 32, 33, 34]
</span><span id="__span-94-18"><a id="__codelineno-94-18" name="__codelineno-94-18"></a>    ];
</span><span id="__span-94-19"><a id="__codelineno-94-19" name="__codelineno-94-19"></a>
</span><span id="__span-94-20"><a id="__codelineno-94-20" name="__codelineno-94-20"></a>  len_1 constant int := array_length(arr, 1);
</span><span id="__span-94-21"><a id="__codelineno-94-21" name="__codelineno-94-21"></a>  len_2 constant int := array_length(arr, 2);
</span><span id="__span-94-22"><a id="__codelineno-94-22" name="__codelineno-94-22"></a>begin
</span><span id="__span-94-23"><a id="__codelineno-94-23" name="__codelineno-94-23"></a>  assert
</span><span id="__span-94-24"><a id="__codelineno-94-24" name="__codelineno-94-24"></a>    (len_1 = 3) and (len_2 = 4),
</span><span id="__span-94-25"><a id="__codelineno-94-25" name="__codelineno-94-25"></a>  &#39;unexpected&#39;;
</span><span id="__span-94-26"><a id="__codelineno-94-26" name="__codelineno-94-26"></a>
</span><span id="__span-94-27"><a id="__codelineno-94-27" name="__codelineno-94-27"></a>  -- OK to extract a slice. But, even though it&#39;s tempting to picture this as one row,
</span><span id="__span-94-28"><a id="__codelineno-94-28" name="__codelineno-94-28"></a>  -- it is nevertheless a 2-d array with &quot;array_length(arr, 1)&quot; equal to 1.
</span><span id="__span-94-29"><a id="__codelineno-94-29" name="__codelineno-94-29"></a>  assert
</span><span id="__span-94-30"><a id="__codelineno-94-30" name="__codelineno-94-30"></a>    arr[2:2][1:4] = array[old_val],
</span><span id="__span-94-31"><a id="__codelineno-94-31" name="__codelineno-94-31"></a>  &#39;unexpected&#39;;
</span><span id="__span-94-32"><a id="__codelineno-94-32" name="__codelineno-94-32"></a>
</span><span id="__span-94-33"><a id="__codelineno-94-33" name="__codelineno-94-33"></a>  -- You cannot use the slice notation to specify the target of an assignment.
</span><span id="__span-94-34"><a id="__codelineno-94-34" name="__codelineno-94-34"></a>  -- So this
</span><span id="__span-94-35"><a id="__codelineno-94-35" name="__codelineno-94-35"></a>  --   arr[2:2][1:4] = array[new_val];
</span><span id="__span-94-36"><a id="__codelineno-94-36" name="__codelineno-94-36"></a>  -- causes a compilation error.
</span><span id="__span-94-37"><a id="__codelineno-94-37" name="__codelineno-94-37"></a>
</span><span id="__span-94-38"><a id="__codelineno-94-38" name="__codelineno-94-38"></a>  -- Similarly, this is meaningless. (But it doesn&#39;t cause a compilation error.)
</span><span id="__span-94-39"><a id="__codelineno-94-39" name="__codelineno-94-39"></a>  -- Because it&#39;s a 2-d array, its values (individual values or slices) must be
</span><span id="__span-94-40"><a id="__codelineno-94-40" name="__codelineno-94-40"></a>  -- addressed using two indexes or two slice ranges.
</span><span id="__span-94-41"><a id="__codelineno-94-41" name="__codelineno-94-41"></a>  assert
</span><span id="__span-94-42"><a id="__codelineno-94-42" name="__codelineno-94-42"></a>    arr[2] is null,
</span><span id="__span-94-43"><a id="__codelineno-94-43" name="__codelineno-94-43"></a>  &#39;unexpected&#39;;
</span><span id="__span-94-44"><a id="__codelineno-94-44" name="__codelineno-94-44"></a>
</span><span id="__span-94-45"><a id="__codelineno-94-45" name="__codelineno-94-45"></a>  -- Change the individual, addressable, values one by one.
</span><span id="__span-94-46"><a id="__codelineno-94-46" name="__codelineno-94-46"></a>  for j in array_lower(arr, 2)..array_upper(arr, 2) loop
</span><span id="__span-94-47"><a id="__codelineno-94-47" name="__codelineno-94-47"></a>    arr[2][j] := new_val[j];
</span><span id="__span-94-48"><a id="__codelineno-94-48" name="__codelineno-94-48"></a>  end loop;
</span><span id="__span-94-49"><a id="__codelineno-94-49" name="__codelineno-94-49"></a>
</span><span id="__span-94-50"><a id="__codelineno-94-50" name="__codelineno-94-50"></a>  assert
</span><span id="__span-94-51"><a id="__codelineno-94-51" name="__codelineno-94-51"></a>    arr = expected_modified_arr,
</span><span id="__span-94-52"><a id="__codelineno-94-52" name="__codelineno-94-52"></a>  &#39;unexpected&#39;;
</span><span id="__span-94-53"><a id="__codelineno-94-53" name="__codelineno-94-53"></a>end;
</span><span id="__span-94-54"><a id="__codelineno-94-54" name="__codelineno-94-54"></a>$body$;
</span></code></pre></div></td></tr></table></div>
<h3 id="array_remove">array_remove()<a class="headerlink" href="#array_remove" title="Permanent link">&para;</a></h3>
<p>目的：从数组中移除所有等于给定值的所有元素</p>
<p>语法：</p>
<p>输入值:       anyarray, anyelement
返回值:      anyarray</p>
<p>注意：此函数要求要从中删除值的数组是一维的数组。</p>
<p>例如：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-95-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-95-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-95-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-95-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-95-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-95-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-95-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-95-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-95-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-95-10">10</a></span>
<span class="normal"><a href="#__codelineno-95-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1"></a>create table t(k int primary key, arr int[]);
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2"></a>insert into t(k, arr)
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3"></a>values (1, &#39;{1, 2, 2, 2, 5, 6}&#39;::int[]);
</span><span id="__span-95-4"><a id="__codelineno-95-4" name="__codelineno-95-4"></a>
</span><span id="__span-95-5"><a id="__codelineno-95-5" name="__codelineno-95-5"></a>select arr as &quot;old value of arr&quot; from t where k = 1;
</span><span id="__span-95-6"><a id="__codelineno-95-6" name="__codelineno-95-6"></a>
</span><span id="__span-95-7"><a id="__codelineno-95-7" name="__codelineno-95-7"></a>update t
</span><span id="__span-95-8"><a id="__codelineno-95-8" name="__codelineno-95-8"></a>set arr = array_remove(arr, 2)
</span><span id="__span-95-9"><a id="__codelineno-95-9" name="__codelineno-95-9"></a>where k = 1;
</span><span id="__span-95-10"><a id="__codelineno-95-10" name="__codelineno-95-10"></a>
</span><span id="__span-95-11"><a id="__codelineno-95-11" name="__codelineno-95-11"></a>select arr as &quot;new value of arr&quot; from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>分别返回如下信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-96-1">1</a></span>
<span class="normal"><a href="#__codelineno-96-2">2</a></span>
<span class="normal"><a href="#__codelineno-96-3">3</a></span>
<span class="normal"><a href="#__codelineno-96-4">4</a></span>
<span class="normal"><a href="#__codelineno-96-5">5</a></span>
<span class="normal"><a href="#__codelineno-96-6">6</a></span>
<span class="normal"><a href="#__codelineno-96-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1"></a> old value of arr
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2"></a>------------------
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3"></a> {1,2,2,2,5,6}
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4"></a>
</span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5"></a> new value of arr
</span><span id="__span-96-6"><a id="__codelineno-96-6" name="__codelineno-96-6"></a>------------------
</span><span id="__span-96-7"><a id="__codelineno-96-7" name="__codelineno-96-7"></a> {1,5,6}
</span></code></pre></div></td></tr></table></div>
<h2 id="_13"><strong>转换函数</strong><a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>函数</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_array_to_string()">array_to_string()</a></td>
<td></td>
<td>返回一个文本值，该值是通过每个数组值来计算的，通过::text类型转换，按行主顺序遍历这些值，并在每个数组值之间使用提供的分隔符。</td>
</tr>
</tbody>
</table>
<h3 id="array_to_string">array_to_string()<a class="headerlink" href="#array_to_string" title="Permanent link">&para;</a></h3>
<p>目的：返回一个文本值，该值是通过每个数组值来计算的，通过::text类型转换，按行主顺序遍历这些值，并在每个数组值之间使用提供的分隔符。</p>
<p>语法：
输入值:       anyarray, text [, text]
返回值:      text</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-97-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-97-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-97-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-97-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-97-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-97-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-97-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-97-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-97-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-97-10">10</a></span>
<span class="normal"><a href="#__codelineno-97-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2"></a>create table t(k int primary key, arr rt[]);
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3"></a>insert into t(k, arr) values(1,
</span><span id="__span-97-4"><a id="__codelineno-97-4" name="__codelineno-97-4"></a>  array[
</span><span id="__span-97-5"><a id="__codelineno-97-5" name="__codelineno-97-5"></a>    array[
</span><span id="__span-97-6"><a id="__codelineno-97-6" name="__codelineno-97-6"></a>      array[(1, &#39;a&#39;)::rt, (2, null)::rt, null, (3, &#39;c&#39;)::rt]
</span><span id="__span-97-7"><a id="__codelineno-97-7" name="__codelineno-97-7"></a>    ]
</span><span id="__span-97-8"><a id="__codelineno-97-8" name="__codelineno-97-8"></a>  ]::rt[]
</span><span id="__span-97-9"><a id="__codelineno-97-9" name="__codelineno-97-9"></a>);
</span><span id="__span-97-10"><a id="__codelineno-97-10" name="__codelineno-97-10"></a>
</span><span id="__span-97-11"><a id="__codelineno-97-11" name="__codelineno-97-11"></a>select arr::text from t where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回如下信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-98-1">1</a></span>
<span class="normal"><a href="#__codelineno-98-2">2</a></span>
<span class="normal"><a href="#__codelineno-98-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1"></a>                arr
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2"></a>-----------------------------------
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3"></a> {{{&quot;(1,a)&quot;,&quot;(2,)&quot;,NULL,&quot;(3,c)&quot;}}}
</span></code></pre></div></td></tr></table></div>
<p>接下来，执行如下脚本：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-99-1">1</a></span>
<span class="normal"><a href="#__codelineno-99-2">2</a></span>
<span class="normal"><a href="#__codelineno-99-3">3</a></span>
<span class="normal"><a href="#__codelineno-99-4">4</a></span>
<span class="normal"><a href="#__codelineno-99-5">5</a></span>
<span class="normal"><a href="#__codelineno-99-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1"></a>select
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2"></a>  array_to_string(
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3"></a>    arr,     -- the input array
</span><span id="__span-99-4"><a id="__codelineno-99-4" name="__codelineno-99-4"></a>    &#39; | &#39;)   -- the delimiter
</span><span id="__span-99-5"><a id="__codelineno-99-5" name="__codelineno-99-5"></a>from t
</span><span id="__span-99-6"><a id="__codelineno-99-6" name="__codelineno-99-6"></a>where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-100-1">1</a></span>
<span class="normal"><a href="#__codelineno-100-2">2</a></span>
<span class="normal"><a href="#__codelineno-100-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1"></a>   array_to_string
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2"></a>----------------------
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3"></a> (1,a) | (2,) | (3,c)
</span></code></pre></div></td></tr></table></div>
<p>注意：第三个NULL数组值并没有显示。这意味着逗号和右括号分隔符之间没有任何字符。 </p>
<p>继续执行如下脚本：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-101-1">1</a></span>
<span class="normal"><a href="#__codelineno-101-2">2</a></span>
<span class="normal"><a href="#__codelineno-101-3">3</a></span>
<span class="normal"><a href="#__codelineno-101-4">4</a></span>
<span class="normal"><a href="#__codelineno-101-5">5</a></span>
<span class="normal"><a href="#__codelineno-101-6">6</a></span>
<span class="normal"><a href="#__codelineno-101-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1"></a>select
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2"></a>  array_to_string(
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3"></a>    arr,     -- the input array
</span><span id="__span-101-4"><a id="__codelineno-101-4" name="__codelineno-101-4"></a>    &#39; | &#39;,   -- the delimiter
</span><span id="__span-101-5"><a id="__codelineno-101-5" name="__codelineno-101-5"></a>    &#39;?&#39;)     -- the null indicator
</span><span id="__span-101-6"><a id="__codelineno-101-6" name="__codelineno-101-6"></a>from t
</span><span id="__span-101-7"><a id="__codelineno-101-7" name="__codelineno-101-7"></a>where k = 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-102-1">1</a></span>
<span class="normal"><a href="#__codelineno-102-2">2</a></span>
<span class="normal"><a href="#__codelineno-102-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1"></a>     array_to_string
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2"></a>--------------------------
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3"></a> (1,a) | (2,) | ? | (3,c)
</span></code></pre></div></td></tr></table></div>
<p>第三个数组值现在用 ? 显示，但是，事实上，第二个数组值中的“f2”为NULL这一点并不没有用 ? 显示。换句话说，这种可视化NULL的技术仅在顶级数组值的粒度上应用，而当这些值是复合值时，并不会在这些值内应用。 </p>
<h2 id="_14"><strong>表函数</strong><a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>函数</th>
<th>1-d only?</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#_unnest()">unnest()</a></td>
<td></td>
<td>将一个数组扩展成一组行在SELECT语句的FROM子句中使用。简单重载接受单个任意数组值，并返回一个集合。重载接受任意数组值的可变列表，并返回具有多个列的集合，其中每个列依次具有相应的简单重载的输出。</td>
</tr>
<tr>
<td><a href="#_generate_subscripts()">generate_subscripts()</a></td>
<td></td>
<td>在SELECT语句的FROM子句中使用。返回沿指定数组的指定维度的索引值。</td>
</tr>
</tbody>
</table>
<h3 id="unnest">unnest()<a class="headerlink" href="#unnest" title="Permanent link">&para;</a></h3>
<p>此函数有两个重载函数。</p>
<h4 id="unnest_1"><em>unnest() 重载函数一</em><a class="headerlink" href="#unnest_1" title="Permanent link">&para;</a></h4>
<p>目的：将单个数组中的值转换为SQL表。</p>
<p>语法：</p>
<p>输入值:       anyarray
返回值:      SETOF anyelement</p>
<p>unnest的输入是一个数组，在SQL语句中，设置bsqlsh变量“result_arr”，参见array_agg()的代码示例，必须引起来它，并将其类型转换为“rt[]”。这可以通过\set 元命令来完成，如下所示：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-103-1">1</a></span>
<span class="normal"><a href="#__codelineno-103-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1"></a>\set unnest_arg &#39;\&#39;&#39;:result_arr&#39;\&#39;::rt[]&#39;
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2"></a>\echo :unnest_arg
</span></code></pre></div></td></tr></table></div>
<p>\echo 元命令显示以下内容：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-104-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1"></a>&#39;{&quot;(1,dog)&quot;,&quot;(2,cat)&quot;,&quot;(3,ant)&quot;}&#39;::rt[]
</span></code></pre></div></td></tr></table></div>
<p>完整示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-105-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-105-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-105-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-105-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-105-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-105-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-105-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-105-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-105-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-105-10">10</a></span>
<span class="normal"><a href="#__codelineno-105-11">11</a></span>
<span class="normal"><a href="#__codelineno-105-12">12</a></span>
<span class="normal"><a href="#__codelineno-105-13">13</a></span>
<span class="normal"><a href="#__codelineno-105-14">14</a></span>
<span class="normal"><a href="#__codelineno-105-15">15</a></span>
<span class="normal"><a href="#__codelineno-105-16">16</a></span>
<span class="normal"><a href="#__codelineno-105-17">17</a></span>
<span class="normal"><a href="#__codelineno-105-18">18</a></span>
<span class="normal"><a href="#__codelineno-105-19">19</a></span>
<span class="normal"><a href="#__codelineno-105-20">20</a></span>
<span class="normal"><a href="#__codelineno-105-21">21</a></span>
<span class="normal"><a href="#__codelineno-105-22">22</a></span>
<span class="normal"><a href="#__codelineno-105-23">23</a></span>
<span class="normal"><a href="#__codelineno-105-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1"></a>create type rt as (f1 int, f2 text);
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2"></a>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3"></a>with tab as (
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4"></a>  values
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5"></a>    (1::int, &#39;dog&#39;::text),
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6"></a>    (2::int, &#39;cat&#39;::text),
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7"></a>    (3::int, &#39;ant&#39;::text))
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8"></a>select array_agg((column1, column2)::rt order by column1) as arr
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9"></a>from tab;
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10"></a>
</span><span id="__span-105-11"><a id="__codelineno-105-11" name="__codelineno-105-11"></a>\gset result_
</span><span id="__span-105-12"><a id="__codelineno-105-12" name="__codelineno-105-12"></a>\echo :result_arr
</span><span id="__span-105-13"><a id="__codelineno-105-13" name="__codelineno-105-13"></a>
</span><span id="__span-105-14"><a id="__codelineno-105-14" name="__codelineno-105-14"></a>\set unnest_arg &#39;\&#39;&#39;:result_arr&#39;\&#39;::rt[]&#39;
</span><span id="__span-105-15"><a id="__codelineno-105-15" name="__codelineno-105-15"></a>\echo :unnest_arg
</span><span id="__span-105-16"><a id="__codelineno-105-16" name="__codelineno-105-16"></a>
</span><span id="__span-105-17"><a id="__codelineno-105-17" name="__codelineno-105-17"></a>with
</span><span id="__span-105-18"><a id="__codelineno-105-18" name="__codelineno-105-18"></a>  rows as (
</span><span id="__span-105-19"><a id="__codelineno-105-19" name="__codelineno-105-19"></a>    select unnest(:unnest_arg) as rec)
</span><span id="__span-105-20"><a id="__codelineno-105-20" name="__codelineno-105-20"></a>select
</span><span id="__span-105-21"><a id="__codelineno-105-21" name="__codelineno-105-21"></a>  (rec).f1,
</span><span id="__span-105-22"><a id="__codelineno-105-22" name="__codelineno-105-22"></a>  (rec).f2
</span><span id="__span-105-23"><a id="__codelineno-105-23" name="__codelineno-105-23"></a>from rows
</span><span id="__span-105-24"><a id="__codelineno-105-24" name="__codelineno-105-24"></a>order by 1;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-106-1">1</a></span>
<span class="normal"><a href="#__codelineno-106-2">2</a></span>
<span class="normal"><a href="#__codelineno-106-3">3</a></span>
<span class="normal"><a href="#__codelineno-106-4">4</a></span>
<span class="normal"><a href="#__codelineno-106-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1"></a> f1 |  f2
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2"></a>---+-----
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3"></a> 1 | dog
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4"></a> 2 | cat
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5"></a> 3 | ant
</span></code></pre></div></td></tr></table></div>
<h4 id="unnest_2"><em>unnest() 重载函数二</em><a class="headerlink" href="#unnest_2" title="Permanent link">&para;</a></h4>
<p>目的：将数组的可变列表中的值转换为SQL表，该表的每一列都是相应输入数组值的集合。此重载只能在子查询的FROM子句中使用。每个输入数组可能具有不同的类型和不同的基数。基数最大的输入数组决定了输出行的数量。那些基数较小的输入数组的行在末尾用NULL填充。可选的WITH ORDINALITY 子句添加了一个对行进行编号的列。 </p>
<p>语法：</p>
<p>输入值:       <variadic list of> anyarray
返回值:      many coordinated columns of SETOF anyelement</p>
<p>示例如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-107-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-107-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-107-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-107-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-107-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-107-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-107-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-107-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-107-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-107-10">10</a></span>
<span class="normal"><a href="#__codelineno-107-11">11</a></span>
<span class="normal"><a href="#__codelineno-107-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1"></a>create type rt as (a int, b text);
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2"></a>
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3"></a>\pset null &#39;&lt;is null&gt;&#39;
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4"></a>select *
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5"></a>from unnest(
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6"></a>  array[1, 2],
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7"></a>  array[10, 20, 30, 45, 50],
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8"></a>  array[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;],
</span><span id="__span-107-9"><a id="__codelineno-107-9" name="__codelineno-107-9"></a>  array[(1, &#39;p&#39;)::rt, (2, &#39;q&#39;)::rt, (3, &#39;r&#39;)::rt, (4, &#39;s&#39;)::rt]
</span><span id="__span-107-10"><a id="__codelineno-107-10" name="__codelineno-107-10"></a>)
</span><span id="__span-107-11"><a id="__codelineno-107-11" name="__codelineno-107-11"></a>with ordinality
</span><span id="__span-107-12"><a id="__codelineno-107-12" name="__codelineno-107-12"></a>as result(arr1, arr2, arr3, arr4_a, arr4_n, n);
</span></code></pre></div></td></tr></table></div>
<p>返回如下信息：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-108-1">1</a></span>
<span class="normal"><a href="#__codelineno-108-2">2</a></span>
<span class="normal"><a href="#__codelineno-108-3">3</a></span>
<span class="normal"><a href="#__codelineno-108-4">4</a></span>
<span class="normal"><a href="#__codelineno-108-5">5</a></span>
<span class="normal"><a href="#__codelineno-108-6">6</a></span>
<span class="normal"><a href="#__codelineno-108-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1"></a>   arr1  | arr2  |   arr3    |  arr4_a   |  arr4_n   |  n
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2"></a>-------------+-------+--------------+--------------+--------------+-----
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3"></a>       1 |  10 | a          |         1 | p         | 1
</span><span id="__span-108-4"><a id="__codelineno-108-4" name="__codelineno-108-4"></a>       2 |  20 | b          |         2 | q         | 2
</span><span id="__span-108-5"><a id="__codelineno-108-5" name="__codelineno-108-5"></a> &lt;is null&gt; |  30 | c          |         3 | r         | 3
</span><span id="__span-108-6"><a id="__codelineno-108-6" name="__codelineno-108-6"></a> &lt;is null&gt; |  45 | d          |         4 | s         | 4
</span><span id="__span-108-7"><a id="__codelineno-108-7" name="__codelineno-108-7"></a> &lt;is null&gt; |  50 | &lt;is null&gt;    | &lt;is null&gt;   | &lt;is null&gt;  | 5
</span></code></pre></div></td></tr></table></div>
<h3 id="generate_subscripts">generate_subscripts()<a class="headerlink" href="#generate_subscripts" title="Permanent link">&para;</a></h3>
<p>目的：在SELECT语句的FROM子句中使用。返回沿指定数组的指定维度的索引值。</p>
<p>语法：</p>
<p>输入值:       anyarray, integer, boolean
返回值:      SETOF integer</p>
<p>第二个输入参数指定应该沿其生成索引值的维度。第三个可选的输入参数控制值的顺序。默认值FALSE表示从索引下界到索引上界按升序生成索引值；值TRUE意味着按照从索引上界到索引下界的降序生成索引值。</p>
<p>例如：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-109-1">1</a></span>
<span class="normal"><a href="#__codelineno-109-2">2</a></span>
<span class="normal"><a href="#__codelineno-109-3">3</a></span>
<span class="normal"><a href="#__codelineno-109-4">4</a></span>
<span class="normal"><a href="#__codelineno-109-5">5</a></span>
<span class="normal"><a href="#__codelineno-109-6">6</a></span>
<span class="normal"><a href="#__codelineno-109-7">7</a></span>
<span class="normal"><a href="#__codelineno-109-8">8</a></span>
<span class="normal"><a href="#__codelineno-109-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1"></a>drop function if exists arr() cascade;
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2"></a>create function arr()
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3"></a>  returns int[]
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4"></a>  language sql
</span><span id="__span-109-5"><a id="__codelineno-109-5" name="__codelineno-109-5"></a>as $body$
</span><span id="__span-109-6"><a id="__codelineno-109-6" name="__codelineno-109-6"></a>  select array[17, 42, 53, 67]::int[];
</span><span id="__span-109-7"><a id="__codelineno-109-7" name="__codelineno-109-7"></a>$body$;
</span><span id="__span-109-8"><a id="__codelineno-109-8" name="__codelineno-109-8"></a>
</span><span id="__span-109-9"><a id="__codelineno-109-9" name="__codelineno-109-9"></a>select generate_subscripts(arr(), 1) as subscripts;
</span></code></pre></div></td></tr></table></div>
<p>返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-110-1">1</a></span>
<span class="normal"><a href="#__codelineno-110-2">2</a></span>
<span class="normal"><a href="#__codelineno-110-3">3</a></span>
<span class="normal"><a href="#__codelineno-110-4">4</a></span>
<span class="normal"><a href="#__codelineno-110-5">5</a></span>
<span class="normal"><a href="#__codelineno-110-6">6</a></span>
<span class="normal"><a href="#__codelineno-110-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1"></a> subscripts 
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2"></a>------------
</span><span id="__span-110-3"><a id="__codelineno-110-3" name="__codelineno-110-3"></a>        1
</span><span id="__span-110-4"><a id="__codelineno-110-4" name="__codelineno-110-4"></a>        2
</span><span id="__span-110-5"><a id="__codelineno-110-5" name="__codelineno-110-5"></a>        3
</span><span id="__span-110-6"><a id="__codelineno-110-6" name="__codelineno-110-6"></a>        4
</span><span id="__span-110-7"><a id="__codelineno-110-7" name="__codelineno-110-7"></a>select generate_subscripts(arr(), 1, true) as subscripts;
</span></code></pre></div></td></tr></table></div>
<p>则返回信息如下：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-111-1">1</a></span>
<span class="normal"><a href="#__codelineno-111-2">2</a></span>
<span class="normal"><a href="#__codelineno-111-3">3</a></span>
<span class="normal"><a href="#__codelineno-111-4">4</a></span>
<span class="normal"><a href="#__codelineno-111-5">5</a></span>
<span class="normal"><a href="#__codelineno-111-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1"></a> subscripts 
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2"></a>------------
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3"></a>        4
</span><span id="__span-111-4"><a id="__codelineno-111-4" name="__codelineno-111-4"></a>        3
</span><span id="__span-111-5"><a id="__codelineno-111-5" name="__codelineno-111-5"></a>        2
</span><span id="__span-111-6"><a id="__codelineno-111-6" name="__codelineno-111-6"></a>        1
</span></code></pre></div></td></tr></table></div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="%E4%BD%BF%E7%94%A8DOMAIN%E5%80%BC%E6%95%B0%E7%BB%84.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: 使用DOMAIN值数组">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                使用DOMAIN值数组
              </div>
            </div>
          </a>
        
        
          
          <a href="Binary.html" class="md-footer__link md-footer__link--next" aria-label="下一页: Binary">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Binary
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023 - 2024 贝格迈思（深圳）技术有限公司 粤ICP备17054434号-1
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/as599397086/BMDOC" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>