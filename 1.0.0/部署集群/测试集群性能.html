
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="贝格迈思数据库使用手册">
      
      
      
      
        <link rel="prev" href="%E5%A4%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E9%83%A8%E7%BD%B2.html">
      
      
        <link rel="next" href="../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB.html">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>测试集群性能 - 手册</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mo" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tpc-c" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="页眉"
  >

    <!-- Link to home -->
    <a
      href="../index.html"
      title="手册"
      class="md-header__button md-logo"
      aria-label="手册"
      data-md-component="logo"
    >
      
  <img src="../assets/new-logo.png" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            手册
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              测试集群性能
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    
      
    

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="手册" class="md-nav__button md-logo" aria-label="手册" data-md-component="logo">
      
  <img src="../assets/new-logo.png" alt="logo">

    </a>
    手册
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/as599397086/BMDOC" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AiSQL简介
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    快速上手
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/JAVA.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    应用开发
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    部署集群
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            部署集群
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E8%BD%AF%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83%E9%9C%80%E6%B1%82.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    软硬件环境需求
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E7%8E%AF%E5%A2%83%E4%B8%8E%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE%E6%A3%80%E6%9F%A5.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    环境与系统配置检查
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E6%9C%80%E5%B0%8F%E9%83%A8%E7%BD%B2%E6%8B%93%E6%89%91%E7%BB%93%E6%9E%84.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最小部署拓扑结构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E9%80%9A%E8%BF%87%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过图形化界面部署
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过命令行部署
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="%E5%A4%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E9%83%A8%E7%BD%B2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    多数据中心部署
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    测试集群性能
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="%E6%B5%8B%E8%AF%95%E9%9B%86%E7%BE%A4%E6%80%A7%E8%83%BD.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    测试集群性能
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tpc-c" class="md-nav__link">
    TPC-C
  </a>
  
    <nav class="md-nav" aria-label="TPC-C">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    结果概览
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benchmark" class="md-nav__link">
    Benchmark安装
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tpc-c_1" class="md-nav__link">
    运行 TPC-C
  </a>
  
    <nav class="md-nav" aria-label="运行 TPC-C">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#10-warehouses" class="md-nav__link">
    10 warehouses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#100-warehouses" class="md-nav__link">
    100 warehouses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-warehouses" class="md-nav__link">
    1000 warehouses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10000-warehouses" class="md-nav__link">
    10000 warehouses
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sysbench" class="md-nav__link">
    sysbench
  </a>
  
    <nav class="md-nav" aria-label="sysbench">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sysbench_1" class="md-nav__link">
    运行sysbench
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    预期成绩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ycsb" class="md-nav__link">
    YCSB
  </a>
  
    <nav class="md-nav" aria-label="YCSB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jdbc-binding" class="md-nav__link">
    JDBC Binding
  </a>
  
    <nav class="md-nav" aria-label="JDBC Binding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    运行基准测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    预期成绩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bsql-binding" class="md-nav__link">
    BSQL Binding
  </a>
  
    <nav class="md-nav" aria-label="BSQL Binding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    运行基准测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据迁移
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93/%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    管理数据库
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E5%90%91%E9%87%8F%E7%89%B9%E6%80%A7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    向量特性
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../AI%E7%89%B9%E6%80%A7/%E6%A6%82%E8%BF%B0.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    AI特性
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../%E6%9E%B6%E6%9E%84/%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    参考
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tpc-c" class="md-nav__link">
    TPC-C
  </a>
  
    <nav class="md-nav" aria-label="TPC-C">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    结果概览
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benchmark" class="md-nav__link">
    Benchmark安装
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tpc-c_1" class="md-nav__link">
    运行 TPC-C
  </a>
  
    <nav class="md-nav" aria-label="运行 TPC-C">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#10-warehouses" class="md-nav__link">
    10 warehouses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#100-warehouses" class="md-nav__link">
    100 warehouses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-warehouses" class="md-nav__link">
    1000 warehouses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10000-warehouses" class="md-nav__link">
    10000 warehouses
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sysbench" class="md-nav__link">
    sysbench
  </a>
  
    <nav class="md-nav" aria-label="sysbench">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sysbench_1" class="md-nav__link">
    运行sysbench
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    预期成绩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ycsb" class="md-nav__link">
    YCSB
  </a>
  
    <nav class="md-nav" aria-label="YCSB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jdbc-binding" class="md-nav__link">
    JDBC Binding
  </a>
  
    <nav class="md-nav" aria-label="JDBC Binding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    运行基准测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    预期成绩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bsql-binding" class="md-nav__link">
    BSQL Binding
  </a>
  
    <nav class="md-nav" aria-label="BSQL Binding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    运行基准测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/as599397086/BMDOC/edit/master/docs/部署集群/测试集群性能.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/as599397086/BMDOC/raw/master/docs/部署集群/测试集群性能.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>测试集群性能</h1>

<p>AiSQL 旨在提供高可用性、可扩展性和容错能力，同时通过 BSQL 和 BCQL API 提供简单的接口。 然而，为了评估其真实能力并展示其处理实际工作负载的潜力，严格的基准测试至关重要。</p>
<p>基准测试是评估系统在特定工作负载下的性能和功能的过程，以深入了解其可扩展性、弹性和整体效率。 此过程涉及使用标准化工作负载模拟现实世界的使用场景，以了解系统的执行、扩展和从故障中恢复的情况。 了解 AiSQL 处理各种工作负载的能力至关重要，例如 TPC-C、YCSB 和 sysbench 基准测试，它们代表了分布式数据库性能的不同方面。</p>
<p>TPC-C（Transaction Processing Performance Council - Benchmark C）
TPC-C 是广泛认可的测试事务数据库系统性能的基准。 它模拟复杂的 OLTP（在线事务处理）工作负载，其中涉及不同事务的组合，例如订单创建、付款处理和库存水平检查。 使用 TPC-C 对 AiSQL 进行基准测试有助于评估其处理大量并发事务以及保持一致性和完整性的能力。</p>
<p>YCSB（Yahoo Cloud Serving Benchmark）
YCSB 旨在评估数据库在各种读写工作负载下的性能，范围从大部分高负荷读到高负荷写。 使用 YCSB，您可以评估 AiSQL 处理不同数据访问模式和查询负载的能力，这对于具有不同使用需求的应用程序至关重要。</p>
<p>Sysbench
sysbench 是一款多功能基准测试工具，涵盖广泛的数据库工作负载，包括 CPU、内存、磁盘 I/O 和数据库操作。 它有助于衡量系统在不同压力条件下的性能、稳定性和可扩展性，使您能够识别潜在的瓶颈和弱点。</p>
<h2 id="tpc-c"><strong>TPC-C</strong><a class="headerlink" href="#tpc-c" title="Permanent link">&para;</a></h2>
<p>使用 TPC-C 对 BSQL 性能进行基准测试</p>
<p>TPC-C 是一种流行的在线事务处理基准测试，它提供了可用于评估 AiSQL 对于不同类型和复杂性的并发事务的性能的指标，这些事务要么在线执行，要么排队等待延迟执行。</p>
<h3 id="_1"><strong>结果概览</strong><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>集群中的所有节点均位于同一区域的 AWS-west 中。 基准虚拟机与集群节点类型相同，部署在同一可用区。 每个测试在加载数据后运行 30 分钟。</p>
<p>所有基准测试均使用 AiSQL v2.18.1 运行，但 150K 仓库除外，该仓库在 v2.11 上运行。</p>
<p>1.水平缩放
下表显示了 AiSQL 如何水平扩展，当集群中的节点数量增加时，以相同的效率提供更高的吞吐量。</p>
<p><img alt="" src="../assets/chapter4/2.png" /></p>
<p>2.垂直缩放
下表显示了 AiSQL 如何垂直扩展，在机器功率增加时提供更高的吞吐量，同时保持集群中的节点数量不变。</p>
<p><img alt="" src="../assets/chapter4/3.png" /></p>
<p>3.100K warehouses</p>
<p><img alt="" src="../assets/chapter4/4.png" /></p>
<p>4.150K warehouses </p>
<p><img alt="" src="../assets/chapter4/5.png" /></p>
<h3 id="benchmark"><strong>Benchmark安装</strong><a class="headerlink" href="#benchmark" title="Permanent link">&para;</a></h3>
<p>使用以下步骤针对 AiSQL BSQL 运行 TPC-C 工作负载。</p>
<p>1.获取 TPC-C 二进制文件
要下载 TPC-C 二进制文件，请运行以下命令。
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>$ wget https://github.com/bigmath/tpcc/releases/download/2.0/tpcc.tar.gz
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>$ tar -zxvf tpcc.tar.gz
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>$ cd tpcc
</span></code></pre></div></td></tr></table></div></p>
<p>2.启动 AiSQL
按照手动部署步骤启动 AiSQL 集群。</p>
<p>提示：下一步您将需要集群中节点的 IP 地址。</p>
<p>3.配置数据库连接参数（可选）
您可以使用命令行参数配置工作负载，包括节点的 IP 地址、仓库数量和加载器线程数量。</p>
<p>如果需要，可以使用 config/workload_all.xml 中的配置文件更改其他选项，例如用户名、密码、端口等。
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a>&lt;port&gt;2521&lt;/port&gt;
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>&lt;username&gt;bigmath&lt;/username&gt;
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a>&lt;password&gt;&lt;/password&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>4.其他考虑因素
运行测试时，请务必执行以下操作：
1.运行最新的 TPCC 代码。 通过下载最新发布的版本来使用 bigmath TPCC 应用程序的最新增强功能，或者克隆存储库并从源代码构建以获得最新的更改。
2.使用 bm-admin 实用程序的compact_table 命令预压缩表。
3.当您调用 TPCC 基准测试的执行阶段时，使用 --warmup-time-secs 标志预热数据库。</p>
<h3 id="tpc-c_1"><strong>运行 TPC-C</strong><a class="headerlink" href="#tpc-c_1" title="Permanent link">&para;</a></h3>
<h4 id="10-warehouses"><strong>10 warehouses</strong><a class="headerlink" href="#10-warehouses" title="Permanent link">&para;</a></h4>
<p>1.加载数据
在开始工作负载之前，您需要加载数据。 确保将 IP 地址替换为集群中节点的 IP 地址。
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>$ ./tpccbenchmark --create=true --nodes=127.0.0.1,127.0.0.2,127.0.0.3
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>$ ./tpccbenchmark --load=true --nodes=127.0.0.1,127.0.0.2,127.0.0.3
</span></code></pre></div></td></tr></table></div></p>
<p><img alt="" src="../assets/chapter4/6.png" /></p>
<p>3 个 c5d.4xlarge 类型节点的集群上 10 个仓库的加载时间约为 3 分钟</p>
<p>2.TPC-C执行阶段
您可以按如下方式针对数据库运行工作负载：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>$ ./tpccbenchmark --execute=true \
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>  --nodes=127.0.0.1,127.0.0.2,127.0.0.3
</span></code></pre></div></td></tr></table></div></p>
<p>3.TPC-C 基准测试结果</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>Cluster: 3 nodes of type c5d.large
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>TPMC: 127
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>Efficiency: 98.75%
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a>Latencies:
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>New Order Avg: 66.286 msecs, p99: 212.47 msecs
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a>Payment Avg: 17.406 msecs, p99: 186.884 msecs
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>OrderStatus Avg: 7.308 msecs, p99: 86.974 msecs
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a>Delivery Avg: 66.986 msecs, p99: 185.919 msecs
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a>StockLevel Avg: 98.32 msecs, p99: 192.054 msecs
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a>Once the execution is completed, the TPM-C number along with the efficiency is printed, as follows:
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a>21:09:23,588 (DBWorkload.java:955) INFO  - Throughput: Results(nanoSeconds=1800000263504, measuredRequests=8554) = 4.752221526539232 requests/sec reqs/sec
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a>21:09:23,588 (DBWorkload.java:956) INFO  - Num New Order transactions : 3822, time seconds: 1800
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a>21:09:23,588 (DBWorkload.java:957) INFO  - TPM-C: 127
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a>21:09:23,588 (DBWorkload.java:958) INFO  - Efficiency : 98.75%
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a>21:09:23,593 (DBWorkload.java:983) INFO  - NewOrder, Avg Latency: 66.286 msecs, p99 Latency: 212.47 msecs
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a>21:09:23,596 (DBWorkload.java:983) INFO  - Payment, Avg Latency: 17.406 msecs, p99 Latency: 186.884 msecs
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a>21:09:23,596 (DBWorkload.java:983) INFO  - OrderStatus, Avg Latency: 7.308 msecs, p99 Latency: 86.974 msecs
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a>21:09:23,596 (DBWorkload.java:983) INFO  - Delivery, Avg Latency: 66.986 msecs, p99 Latency: 185.919 msecs
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a>21:09:23,596 (DBWorkload.java:983) INFO  - StockLevel, Avg Latency: 98.32 msecs, p99 Latency: 192.054 msecs
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a>21:09:23,597 (DBWorkload.java:792) INFO  - Output Raw data into file: results/oltpbench.csv
</span></code></pre></div></td></tr></table></div>
<h4 id="100-warehouses"><strong>100 warehouses</strong><a class="headerlink" href="#100-warehouses" title="Permanent link">&para;</a></h4>
<p>1.加载数据
在开始工作负载之前，您需要加载数据。 确保将 IP 地址替换为集群中节点的 IP 地址。 加载器线程允许您配置用于加载数据的线程数。 对于 3 节点 c5d.4xlarge 集群，加载程序线程值 48 是最佳值。
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>$ ./tpccbenchmark --create=true --nodes=127.0.0.1,127.0.0.2,127.0.0.3
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>$ ./tpccbenchmark --load=true \
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>  --nodes=127.0.0.1,127.0.0.2,127.0.0.3 \
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>  --warehouses=100 \
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>  --loaderthreads 48
</span></code></pre></div></td></tr></table></div></p>
<p><img alt="" src="../assets/chapter4/7.png" /></p>
<p>根据集群中节点的数量和类型，调整 --loaderthreads 参数以在加载期间获得更高的并行性。 指定的 48 个线程值对于 c5d.4xlarge 类型的 3 节点集群（16 个 vCPU）来说是最佳的。 对于较大的集群或具有更多 vCPU 的计算机，请相应地增加此值。 对于复制因子为 3 的集群，一个好的近似方法是使用集群中所有节点拥有的核心数。</p>
<p>2.TPC-C执行阶段
您可以按如下方式针对数据库运行工作负载：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a>$ ./tpccbenchmark --execute=true \
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>  --nodes=127.0.0.1,127.0.0.2,127.0.0.3 \
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>  --warehouses=100
</span></code></pre></div></td></tr></table></div></p>
<p>3.TPC-C 基准测试结果
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a>Cluster: 3 nodes of type c5d.4xlarge
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a>TPMC: 1271.77
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>Efficiency: 98.89%
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a>Latencies:
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a>New Order Avg: 68.265 msecs, p99: 574.339 msecs
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a>Payment Avg: 19.969 msecs, p99: 475.311 msecs
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a>OrderStatus Avg: 13.821 msecs, p99: 571.414 msecs
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a>Delivery Avg: 67.384 msecs, p99: 724.67 msecs
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a>StockLevel Avg: 114.032 msecs, p99: 263.849 msecs
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a>Once the execution is completed, the TPM-C number along with the efficiency is printed, as follows:
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16"></a>04:54:54,560 (DBWorkload.java:955) INFO  - Throughput: Results(nanoSeconds=1800000866600, measuredRequests=85196) = 47.33108832382159 requests/sec reqs/sec
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17"></a>04:54:54,560 (DBWorkload.java:956) INFO  - Num New Order transactions : 38153, time seconds: 1800
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18"></a>04:54:54,560 (DBWorkload.java:957) INFO  - TPM-C: 1,271.77
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19"></a>04:54:54,560 (DBWorkload.java:958) INFO  - Efficiency : 98.89%
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20"></a>04:54:54,596 (DBWorkload.java:983) INFO  - NewOrder, Avg Latency: 68.265 msecs, p99 Latency: 574.339 msecs
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21"></a>04:54:54,615 (DBWorkload.java:983) INFO  - Payment, Avg Latency: 19.969 msecs, p99 Latency: 475.311 msecs
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22"></a>04:54:54,616 (DBWorkload.java:983) INFO  - OrderStatus, Avg Latency: 13.821 msecs, p99 Latency: 571.414 msecs
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23"></a>04:54:54,617 (DBWorkload.java:983) INFO  - Delivery, Avg Latency: 67.384 msecs, p99 Latency: 724.67 msecs
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24"></a>04:54:54,618 (DBWorkload.java:983) INFO  - StockLevel, Avg Latency: 114.032 msecs, p99 Latency: 263.849 msecs
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25"></a>04:54:54,619 (DBWorkload.java:792) INFO  - Output Raw data into file: results/oltpbench.csv
</span></code></pre></div></td></tr></table></div></p>
<h4 id="1000-warehouses"><strong>1000 warehouses</strong><a class="headerlink" href="#1000-warehouses" title="Permanent link">&para;</a></h4>
<p>1.加载数据
在启动工作负载之前，您需要先加载数据。 确保将 IP 地址替换为集群中节点的 IP 地址。 加载器线程允许您配置用于加载数据的线程数。 对于 3 节点 c5d.4xlarge 集群，加载程序线程值 48 是最佳值。
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>$ ./tpccbenchmark --create=true --nodes=127.0.0.1,127.0.0.2,127.0.0.3
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>$ ./tpccbenchmark --load=true \
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>  --nodes=127.0.0.1,127.0.0.2,127.0.0.3 \
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>  --warehouses=1000 \
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>  --loaderthreads 48
</span></code></pre></div></td></tr></table></div></p>
<p>2.TPC-C执行阶段
您可以按如下方式针对数据库运行工作负载：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>$ ./tpccbenchmark --execute=true \
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>  --nodes=127.0.0.1,127.0.0.2,127.0.0.3 \
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a>  --warehouses=1000
</span></code></pre></div></td></tr></table></div></p>
<p>3.TPC-C 基准测试结果
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>Cluster: 3 nodes of type c5d.4xlarge
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a>TPMC: 12,563.07
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a>Efficiency: 97.69%
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a>Latencies:
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a>New Order Avg: 325.378 msecs, p99: 3758.859 msecs
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a>Payment Avg: 277.539 msecs, p99: 12667.048 msecs
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a>OrderStatus Avg: 174.173 msecs, p99: 4968.783 msecs
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a>Delivery Avg: 310.19 msecs, p99: 5259.951 msecs
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a>StockLevel Avg: 652.827 msecs, p99: 8455.325 msecs
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a>Once the execution is completed, the TPM-C number along with the efficiency is printed, as follows:
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a>17:18:58,728 (DBWorkload.java:955) INFO  - Throughput: Results(nanoSeconds=1800000716759, measuredRequests=842216) = 467.8975914612168 requests/sec reqs/sec
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17"></a>17:18:58,728 (DBWorkload.java:956) INFO  - Num New Order transactions : 376892, time seconds: 1800
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18"></a>17:18:58,728 (DBWorkload.java:957) INFO  - TPM-C: 12,563.07
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19"></a>17:18:58,728 (DBWorkload.java:958) INFO  - Efficiency : 97.69%
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20"></a>17:18:59,006 (DBWorkload.java:983) INFO  - NewOrder, Avg Latency: 325.378 msecs, p99 Latency: 3758.859 msecs
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21"></a>17:18:59,138 (DBWorkload.java:983) INFO  - Payment, Avg Latency: 277.539 msecs, p99 Latency: 12667.048 msecs
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22"></a>17:18:59,147 (DBWorkload.java:983) INFO  - OrderStatus, Avg Latency: 174.173 msecs, p99 Latency: 4968.783 msecs
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23"></a>17:18:59,166 (DBWorkload.java:983) INFO  - Delivery, Avg Latency: 310.19 msecs, p99 Latency: 5259.951 msecs
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24"></a>17:18:59,182 (DBWorkload.java:983) INFO  - StockLevel, Avg Latency: 652.827 msecs, p99 Latency: 8455.325 msecs
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25"></a>17:18:59,183 (DBWorkload.java:792) INFO  - Output Raw data into file: results/oltpbench.csv
</span></code></pre></div></td></tr></table></div></p>
<h4 id="10000-warehouses"><strong>10000 warehouses</strong><a class="headerlink" href="#10000-warehouses" title="Permanent link">&para;</a></h4>
<p>1.加载数据
在开始工作负载之前，您需要加载数据。 此外，您需要确保导出了所有涉及节点的所有 IP 地址的列表。</p>
<p>对于 10k 仓库，您需要 10 个 c5.4xlarge 类型的客户端来驱动基准测试。 对于多个客户端，您需要执行三个步骤。</p>
<p>首先，创建数据库和相应的表。 从客户端之一执行以下命令：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a>./tpccbenchmark  --nodes=$IPS  --create=true
</span></code></pre></div></td></tr></table></div></p>
<table>
<thead>
<tr>
<th>客户端</th>
<th>命令</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=1 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>2</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=1001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>3</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=2001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>4</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=3001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>5</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=4001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>6</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=5001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>7</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=6001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>8</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=7001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>9</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=8001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
<tr>
<td>10</td>
<td>./tpccbenchmark --load=true --nodes=$IPS --warehouses=1000 --start-warehouse-id=9001 --total-warehouses=10000 --loaderthreads 48</td>
</tr>
</tbody>
</table>
<p>创建数据库和表后，您可以从所有十个客户端加载数据：</p>
<p>根据集群中节点的数量和类型，调整 --loaderthreads 参数以在加载期间获得更高的并行性。 此处指定的值 48 个线程对于 c5d.4xlarge 类型的 3 节点集群（16 个 vCPU）来说是最佳的。 对于较大的集群或具有更多 vCPU 的计算机，请相应地增加此值。 对于复制因子为 3 的集群，一个好的近似方法是使用集群中所有节点拥有的核心数。</p>
<p>加载完成后，执行以下命令以启用已禁用的外键以帮助缩短加载时间：
./tpccbenchmark  --nodes=$IPS  --enable-foreign-keys=true</p>
<p><img alt="" src="../assets/chapter4/8.png" /></p>
<p>2.TPC-C执行阶段
在开始执行之前，您必须通过运行以下命令将所有tablet领导者移出包含mserver领导者的节点：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>./bm-admin --mserver_addresses &lt;mserver-ip1&gt;:11000,&lt;mserver-ip2&gt;:11000,&lt;mserver-ip3&gt;:11000 change_leader_blacklist ADD &lt;mserver-leader-ip&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>确保执行阶段使用的IP地址不包含mserver-leader-ip。 然后，您可以从每个客户端针对数据库运行工作负载：
| 客户端 | 命令 |
| --- | --- |
| 1 | ./tpccbenchmark --nodes=<span class="arithmatex">\(IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=1 --total-warehouses=10000 --warmup-time-secs=900 |
| 2 | ./tpccbenchmark --nodes=\)</span>IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=1001 --total-warehouses=10000 --warmup-time-secs=900 |
| 3 | ./tpccbenchmark --nodes=<span class="arithmatex">\(IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=2001 --total-warehouses=10000 --warmup-time-secs=900 |
| 4 | ./tpccbenchmark --nodes=\)</span>IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=3001 --total-warehouses=10000 --warmup-time-secs=900 |
| 5 | ./tpccbenchmark --nodes=<span class="arithmatex">\(IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=4001 --total-warehouses=10000 --warmup-time-secs=900 |
| 6 | ./tpccbenchmark --nodes=\)</span>IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=5001 --total-warehouses=10000 --warmup-time-secs=720 --initial-delay-secs=180 |
| 7 | ./tpccbenchmark --nodes=<span class="arithmatex">\(IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=6001 --total-warehouses=10000 --warmup-time-secs=540 --initial-delay-secs=360 |
| 8 | ./tpccbenchmark --nodes=\)</span>IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=7001 --total-warehouses=10000 --warmup-time-secs=360 --initial-delay-secs=540 |
| 9 | ./tpccbenchmark --nodes=<span class="arithmatex">\(IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=8001 --total-warehouses=10000 --warmup-time-secs=180 --initial-delay-secs=720 |
| 10 | ./tpccbenchmark --nodes=\)</span>IPS --execute=true --warehouses=1000 --num-connections=300 --start-warehouse-id=9001 --total-warehouses=10000 --warmup-time-secs=0 --initial-delay-secs=900TPC-C Benchmark R |</p>
<p>3.TPC-C 基准测试结果
执行完成后，需要将每个节点的csv文件复制到其中一个节点，并运行merge-results来显示合并结果。</p>
<p>将 csv 文件复制到诸如 results-dir 之类的目录后，您可以按如下方式合并结果：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a>./tpccbenchmark --merge-results=true --dir=results-dir --warehouses=10000
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>Cluster: 30 nodes of type c5d.4xlarge
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a>TPMC: 125193.2
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6"></a>Efficiency: 97.35%
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7"></a>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8"></a>Latencies:
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9"></a>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10"></a>New Order Avg: 114.639 msecs, p99: 852.183 msecs
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11"></a>Payment Avg: 114.639 msecs, p99 : 852.183 msecs
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12"></a>OrderStatus Avg: 20.86 msecs, p99: 49.31 msecs
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13"></a>Delivery Avg: 117.473 msecs, p99: 403.404 msecs
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14"></a>StockLevel Avg: 340.232 msecs, p99: 1022.881 msecs
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15"></a>The output after merging should look similar to the following:
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16"></a>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17"></a>15:16:07,397 (DBWorkload.java:715) INFO - Skipping benchmark workload execution
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18"></a>15:16:11,400 (DBWorkload.java:1080) INFO - Num New Order transactions : 3779016, time seconds: 1800
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19"></a>15:16:11,400 (DBWorkload.java:1081) INFO - TPM-C: 125193.2
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20"></a>15:16:11,401 (DBWorkload.java:1082) INFO - Efficiency : 97.35%
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21"></a>15:16:12,861 (DBWorkload.java:1010) INFO - NewOrder, Avg Latency: 114.639 msecs, p99 Latency: 852.183 msecs
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22"></a>15:16:13,998 (DBWorkload.java:1010) INFO - Payment, Avg Latency: 29.351 msecs, p99 Latency: 50.8 msecs
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23"></a>15:16:14,095 (DBWorkload.java:1010) INFO - OrderStatus, Avg Latency: 20.86 msecs, p99 Latency: 49.31 msecs
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24"></a>15:16:14,208 (DBWorkload.java:1010) INFO - Delivery, Avg Latency: 117.473 msecs, p99 Latency: 403.404 msecs
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25"></a>15:16:14,310 (DBWorkload.java:1010) INFO - StockLevel, Avg Latency: 340.232 msecs, p99 Latency: 1022.8
</span></code></pre></div></td></tr></table></div></p>
<h2 id="sysbench"><strong>sysbench</strong><a class="headerlink" href="#sysbench" title="Permanent link">&para;</a></h2>
<p>使用 sysbench 对 BSQL 性能进行基准测试
sysbench 是一种流行的工具，用于对 PostgreSQL 和 MySQL 等数据库以及 CPU、内存和 I/O 等系统功能进行基准测试。 AiSQL 版本的 sysbench 是从官方版本派生出来的，并进行了一些修改，以更好地反映 AiSQL 的分布式特性。</p>
<h3 id="sysbench_1"><strong>运行sysbench</strong><a class="headerlink" href="#sysbench_1" title="Permanent link">&para;</a></h3>
<p>1.先决条件
为了确保在基准测试之前满足建议的硬件要求并正确配置数据库，请查看部署清单。</p>
<p>使用以下步骤安装 sysbench：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>$ cd $HOME
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>$ git clone https://github.com/bigmath/sysbench.git
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>$ cd sysbench
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>$ ./autogen.sh &amp;&amp; ./configure --with-pgsql &amp;&amp; make -j &amp;&amp; sudo make install
</span></code></pre></div></td></tr></table></div></p>
<p>这会将 sysbench 实用程序安装在 /usr/local/bin 中。</p>
<p>确保您已将 BSQL shell sqlsh 导出到 PATH 变量。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>$ export PATH=$PATH:/path/to/sqlsh
</span></code></pre></div></td></tr></table></div>
<p>2.启动 AiSQL
按照手动部署中的步骤启动 AiSQL 集群。</p>
<p>提示：下一步您将需要集群中节点的 IP 地址。</p>
<p>运行sysbench
运行 run_sysbench.sh shell 脚本来加载数据并运行各种工作负载：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>./run_sysbench.sh --ip &lt;ip&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>该脚本使用 64 个线程运行所有 8 个工作负载，表数量为 10，表大小为 100k。</p>
<p>如果您想使用不同的表数量和表大小运行基准测试，请执行以下操作：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>./run_sysbench.sh --ip &lt;ip&gt; --numtables &lt;number of tables&gt; --tablesize &lt;number of rows in each table&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>3.运行单独的工作负载（可选）
您可以选择单独运行以下工作负载：
* oltp_insert
* oltp_point_select
* oltp_write_only
* oltp_read_only
* oltp_read_write
* oltp_update_index
* oltp_update_non_index
* oltp_delete</p>
<p>在启动工作负载之前，请按如下方式加载数据：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a>$ sysbench &lt;workload&gt;               \
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a>      --tables=10                   \
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a>      --table-size=100000           \
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a>      --range_key_partitioning=true \
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a>      --db-driver=pgsql             \
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a>      --pgsql-host=127.0.0.1        \
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7"></a>      --pgsql-port=2521             \
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8"></a>      --pgsql-user=bigmath         \
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9"></a>      --pgsql-db=bigmath           \
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10"></a>      Prepare
</span></code></pre></div></td></tr></table></div></p>
<p>按如下方式运行工作负载：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a>$ sysbench &lt;workload&gt;               \
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>      --tables=10                   \
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a>      --table-size=100000           \
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>      --range_key_partitioning=true \
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>      --db-driver=pgsql             \
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a>      --pgsql-host=127.0.0.1        \
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a>      --pgsql-port=2521             \
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a>      --pgsql-user=bigmath         \
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a>      --pgsql-db=bigmath           \
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a>      --threads=64                  \
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a>      --time=120                    \
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12"></a>      --warmup-time=120             \
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13"></a>      run
</span></code></pre></div></td></tr></table></div></p>
<h3 id="_2"><strong>预期成绩</strong><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>以下结果适用于 3 节点集群，其中每个节点都位于 c5.4xlarge AWS 实例（16 个核心、32 GB RAM 和 2 个 EBS 卷）上，所有节点均位于同一可用区，并且客户端虚拟机在同一可用区中运行。</p>
<p>10 个表，每个表有 100k 行
| WORKLOAD | THROUGHPUT (TXNS/SEC) | LATENCY (MS) |
| --- | --- | --- |
| OLTP_READ_ONLY | 3276 | 39 |
| OLTP_READ_WRITE | 487 | 265 |
| OLTP_WRITE_ONLY | 1818 | 70 |
| OLTP_POINT_SELECT | 95695 | 1.3 |
| OLTP_INSERT | 6348 | 20.1 |
| OLTP_UPDATE_INDEX | 4052 | 31 |
| OLTP_UPDATE_NON_INDEX | 11496 | 11 |
| OLTP_DELETE | 67499 | 1.9 |</p>
<h2 id="ycsb"><strong>YCSB</strong><a class="headerlink" href="#ycsb" title="Permanent link">&para;</a></h2>
<p>使用 YCSB 和标准 JDBC 绑定对 BSQL 性能进行基准测试</p>
<h3 id="jdbc-binding"><strong>JDBC Binding</strong><a class="headerlink" href="#jdbc-binding" title="Permanent link">&para;</a></h3>
<p>本文档描述如何使用标准 JDBC 绑定来运行 YCSB 基准测试。</p>
<h4 id="_3"><strong>运行基准测试</strong><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>要运行基准测试，请确保满足先决条件并完成启动 AiSQL 和配置其属性等步骤。</p>
<p>1.先决条件
这些二进制文件是使用 Java 13 编译的，建议使用该版本运行这些二进制文件。</p>
<p>运行以下命令下载 YCSB 二进制文件：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a>$ cd $HOME
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a>$ wget https://github.com/bigmath/YCSB/releases/download/1.0/ycsb.tar.gz
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a>$ tar -xzf ycsb.tar.gz
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a>$ cd YCSB
</span></code></pre></div></td></tr></table></div>
确保您拥有 BCQL shell cqlsh 并且其位置包含在 PATH 变量中，如下所示：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a>$ export PATH=$PATH:/path/to/cqlsh
</span></code></pre></div></td></tr></table></div></p>
<p>您可以在 AiSQL 安装的 bin 目录中找到 sqlsh。 例如：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a>$ export PATH=$PATH:/Users/bigmath/code/bin
</span></code></pre></div></td></tr></table></div></p>
<p>2.启动 AiSQL
按照手动部署中描述的过程启动 AiSQL 集群。 记下集群中节点的 IP 地址，因为配置属性文件时需要这些地址。</p>
<p>3.配置属性文件
使用以下内容更新 YCSB 目录中的 db.properties 文件，将 db.url 字段中的 IP 地址值替换为集群中所有节点的正确值：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a>db.driver=org.postgresql.Driver
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>db.url=jdbc:postgresql://&lt;ip1&gt;:2521/ycsb;jdbc:postgresql://&lt;ip2&gt;:2521/ycsb;jdbc:postgresql://&lt;ip3&gt;:2521/ycsb;
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a>db.user=bigmath
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>db.passwd=
</span></code></pre></div></td></tr></table></div></p>
<p>其他配置参数在核心属性中进行了描述。</p>
<p>4.运行基准测试
使用以下脚本 run_jdbc.sh 加载并运行所有工作负载：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a>$ ./run_jdbc.sh --ip &lt;ip&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>前面的命令在包含一百万行的表上运行工作负载。 要在具有不同行数的表上运行基准测试，请使用以下命令：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a>$ ./run_jdbc.sh --ip &lt;ip&gt; --recordcount &lt;number of rows&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>为了获得系统的最大性能，您可以调整脚本中的 threadcount 参数。 作为参考，对于具有 16 个核心和 32GB RAM 的 c5.4xlarge 实例，您在加载阶段使用 32 个线程数，在执行阶段使用 256 个线程数。</p>
<p>5.验证结果
run_jdbc.sh 脚本为每个工作负载创建两个结果文件：一个用于加载，另一个用于执行阶段，其中包含吞吐量和延迟的详细信息。</p>
<p>例如，对于它创建的工作负载，检查workloada-bsql-load.dat 和workloada-bsql-transaction.dat 文件。</p>
<p>6.运行单独的工作负载（可选）
或者，您可以使用以下步骤单独运行工作负载：
（1）使用以下命令启动 BSQL shell：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a>$ ./bin/sqlsh -h &lt;ip&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>（2）创建ycsb数据库如下：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>bigmath=# CREATE DATABASE ycsb;
</span></code></pre></div></td></tr></table></div></p>
<p>（3）连接数据库如下：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a>bigmath=# \c ycsb
</span></code></pre></div></td></tr></table></div></p>
<p>（4）创建表如下：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a>ycsb=# CREATE TABLE usertable (
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a>            YCSB_KEY TEXT,
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a>            FIELD0 TEXT, FIELD1 TEXT, FIELD2 TEXT, FIELD3 TEXT,
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a>            FIELD4 TEXT, FIELD5 TEXT, FIELD6 TEXT, FIELD7 TEXT,
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a>            FIELD8 TEXT, FIELD9 TEXT,
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a>            PRIMARY KEY (YCSB_KEY ASC))
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a>            SPLIT AT VALUES ((&#39;user10&#39;),(&#39;user14&#39;),(&#39;user18&#39;),
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a>            (&#39;user22&#39;),(&#39;user26&#39;),(&#39;user30&#39;),(&#39;user34&#39;),(&#39;user38&#39;),
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a>            (&#39;user42&#39;),(&#39;user46&#39;),(&#39;user50&#39;),(&#39;user54&#39;),(&#39;user58&#39;),
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10"></a>            (&#39;user62&#39;),(&#39;user66&#39;),(&#39;user70&#39;),(&#39;user74&#39;),(&#39;user78&#39;),
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11"></a>            (&#39;user82&#39;),(&#39;user86&#39;),(&#39;user90&#39;),(&#39;user94&#39;),(&#39;user98&#39;));
</span></code></pre></div></td></tr></table></div></p>
<p>（5）在启动 jdbc 工作负载之前加载数据：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a>$ ./bin/ycsb load jdbc -s        \
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a>      -P db.properties           \
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a>      -P workloads/workloada     \
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4"></a>      -p recordcount=1000000     \
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5"></a>      -p operationcount=10000000 \
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6"></a>      -p threadcount=32
</span></code></pre></div></td></tr></table></div></p>
<p>（6）按如下方式运行工作负载：</p>
<p>注：以下 ycsb 命令中的 recordcount 参数应与表中的行数匹配。</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span>
<span class="normal"><a href="#__codelineno-31-5">5</a></span>
<span class="normal"><a href="#__codelineno-31-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a>$ ./bin/ycsb run jdbc -s         \
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a>      -P db.properties           \
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a>      -P workloads/workloada     \
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4"></a>      -p recordcount=1000000     \
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5"></a>      -p operationcount=10000000 \
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6"></a>      -p threadcount=256
</span></code></pre></div></td></tr></table></div>
<p>（7）通过更改上述命令中的相应参数来运行其他工作负载（例如workloadb），如下所示：
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a>$ ./bin/ycsb run jdbc -s         \
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a>      -P db.properties           \
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a>      -P workloads/workloadb     \
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a>      -p recordcount=1000000     \
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a>      -p operationcount=10000000 \
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a>      -p threadcount=256
</span></code></pre></div></td></tr></table></div></p>
<h4 id="_4"><strong>预期成绩</strong><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>当在 c5.4xlarge AWS 实例（16 个核心、32GB RAM 和 2 个 EBS 卷）的 3 节点集群上运行时，所有实例都属于同一可用区，并且客户端 VM 在同一可用区中运行，预计会出现以下结果 100 万行：</p>
<p><img alt="" src="../assets/chapter4/9.png" /></p>
<h3 id="bsql-binding"><strong>BSQL Binding</strong><a class="headerlink" href="#bsql-binding" title="Permanent link">&para;</a></h3>
<p>使用 YCSB 对 BSQL 性能进行基准测试
本文档介绍了如何使用 BSQL 特定的绑定来使用 YCSB 基准测试 BSQL API。</p>
<h4 id="_5"><strong>运行基准测试</strong><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>要运行基准测试，请确保满足先决条件并完成启动 AiSQL 和配置其属性等步骤。</p>
<p>1.先决条件
这些二进制文件是使用 Java 13 编译的，建议使用该版本运行这些二进制文件。</p>
<p>运行以下命令下载 YCSB 二进制文件：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span>
<span class="normal"><a href="#__codelineno-33-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a>$ cd $HOME
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a>$ wget https://github.com/bigmath/YCSB/releases/download/1.0/ycsb.tar.gz
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a>$ tar -zxvf ycsb.tar.gz
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a>$ cd YCSB
</span></code></pre></div></td></tr></table></div>
<p>确保您拥有 BSQL shell sqlsh 并且其位置包含在 PATH 变量中，如下所示：</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a>$ export PATH=$PATH:/path/to/sqlsh
</span></code></pre></div></td></tr></table></div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="%E5%A4%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E9%83%A8%E7%BD%B2.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: 多数据中心部署">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                多数据中心部署
              </div>
            </div>
          </a>
        
        
          
          <a href="../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB.html" class="md-footer__link md-footer__link--next" aria-label="下一页: 数据迁移">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                数据迁移
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023 - 2024 贝格迈思（深圳）技术有限公司 粤ICP备17054434号-1
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/as599397086/BMDOC" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>